
co:{
	accounting:{
		流水账xx年xx月xx日 当天我有1000块钱。                                                           
		交易        余额前一天余额                                                         
		1000 餐费：买早饭                                -10               990
		交通费：地铁                                     -4                986
		餐费：买午饭                                     -30               956
		再学着把流水账分复式账，把备注的用途拆出来错开写，分借贷科目，借正贷负。
		借：餐费  10       贷：钱   10
		借：交通费 4       贷：钱   4
		借：餐费  39       贷：钱  30
		钱余额  1000-10-4-30=956 做着渐渐就明白了。
		资产增加就是借记，负债就是贷记

		作者：知乎用户
		链接：https://www.zhihu.com/question/21222111/answer/267099795
		来源：知乎
		著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
	},
	"借记"-'debit' & "贷记"-'credit':{
		self:{
			借 -> in , 贷 -> out ×;  "贷记",'明明少了,结果却+,同负增长';
			"账户" ->	"账簿"'(双方)'
			'客户存款账户',"负债",'我欠客户多少钱':{
				客户存钱, '现金账户'"资产",+100,借记, '客户账户'"负债"+100,贷记,;
				A转账给B, 'A客户账户'"负债"-100,借记,'B客户账户'"负债"+100,贷记,;
			};
			
		},
		zhihu:{	'https://www.zhihu.com/question/21222111'
			'入门':{
				'借贷'是"符号":{
					"资产"、"费用"				-'越借越多',"借方+","贷方-";
					"负债"、"权益"、"收入"		-'越借越少',"借方-","贷方+";
				},
			},
			'提高':{
				
			}
		},
		zhihui-2:{	'https://www.zhihu.com/question/20718557'
			01:{
				"资产"+"费用"="负债"+"所有者权益"+"收入",
				"资产"-'Asset'"+" "费用"-'Expense' "=" "负债"-'Liability' "+" "所有者权益"-'Equity' "+" "收入"-'Income',
				'仔细观察一下这个公式，会发现等式'
				左边'表示钱/东西到哪里去了（要么还在公司手上，要么被公司花了）'；'而'
				右边'表示钱/东西从哪里来的。'
				'当'左侧'增加，则记为'Debit，'减少的话记为'Credit；
					右侧'增加的话记为'Credit',减少则记为'Debit。'相反'
				'公司的任何一笔涉及钱物的交易，分解到最基本的单元，都会记录为对两个Entry（会计科目）的影响'
				'（注意，譬如现金和固定资产虽然都是Asset类型，但是是两个不同的科目），'
				'其中一个必定是Debit ，另一个是 Credit，因此这样的记账方法叫做Double Entry Bookkeeping，也就是复式记账法。'
				'我用扇贝网的经营活动来举几个例子（当然，以下数字都是虚构的）：'
				1. '创始人共同投资了100万人民币，创建扇贝网影响了Asset 和 Equity，'	公司现金资产增加100万，Debit	所有者权益增加100万，Credit
				2. '扇贝网购买了5万元的服务器'										Asset中的现金减少，Credit 		Asset中的固定资产增加, Debit
				3. '扇贝网给员工发了1万元工资' 										Asset中的现金减少，Credit		Expense 增加，Debit
				4. '用户给扇贝网充值1000元' 										Asset中现金增加，  Debit		Income 增加，Credit
			},
			03:{
				'上面大家的解释已经很形象很具体了，我就只补充一下当年学财务的体会。'
				'我觉得，要想理解复式记账法，就必须建立一个'“主体观”，'要明白记账的'“主体”'是什么？'
				'记账的主体是'“公司”，'不是股东，也不是债权人（这就是公司的法人独立性）'。
				'所以资源流入的时候，公司资产增加。'
				'但是'“公司” '是属于股东的，公司有一部分资产也是属于债权人的，所以每一笔资源流入，必然对应'"股东权益"'增加，或者'"债权人债权"'增加（不考虑资产内部互转等情况）；流出亦然。'
				'也就是说，公司每一笔业务导致的资源（财、物）流动，复式记账法不仅给'“主体”'做了登记，还给资源的'归属'做了登记。为什么要这么复杂？'
				'因为公司法人独立，公司资产与股东财产分离，才能做到公司债务与股东责任分离。'
				'公司可以破产，因为经营的主体是'“公司”'而非股东个人，所以股东不必“卖房卖车卖儿卖女”的去还债；所以股东虽然是公司所有者，但是非法挪用公司财产照样是犯罪。'
				'这个'“主体观”'，不仅可以帮助理解复式记账法，还是以后学习更复杂的'企业合并、报表合并、股权投资核算'的有力工具。以前我考CPA的时候，就因为能把握住合并“主体”，才能攻下股权投资企业合并等难题，题主不妨体会一下。'
			}
		},
		iask.sina:{	'https://iask.sina.com.cn/b/5362603.html'
			01:{
				借记,在账簿的借方登记;
				贷记,在账簿的贷方登记;
				"资产"、"成本"、"损益类的支出"		-'越借越多',"借方+","贷方-";
				"负债"、"所有者权益"、"损益类的收入"-'越借越少',"借方-","贷方+";
				'借贷记账法,'"借"'和'"贷"'作为记账符号,以有借必有贷,借贷必相等为记账原则的一种复式记账方法'
			},
			02:{
				1. '复式记账法的'"记账符号",
				2・ 	"借":'一般指'"资产"'类账户发生额增加'，"负债"'类账户发生额减少'，
					"所有者权益"'类账户发生额减少（其中：费用成本类账户发生额增加记借方，减少记借方负数）'。 
				3・	"贷":'一般指'"资产"'类账户发生额减少'，"负债"'类帐户发生额增加'，
					"所有者权益"'类账户发生额增加，收入类账户发生额增加。'
				4・	'每一笔分录，都是有借必有贷，借贷必相等（借方金额合计和贷方金额合计必然相等）。'
			},
			03:{
				'会计中'"借","贷"'两字来记录货币资金的借贷，财产物资、经营损益和经营资本等的增减变化。或增减变动情况。'
				'这样，“借”、“贷”两字逐渐失去了原来的含义，只作为纯粹的'"记账符号"'使用，用以标明'"记账方向"
				'在账户的借、贷两方中，究竟用哪一方来记录金额的增加，用哪一方来记录金额的减少，是由每个账户所反映的'"会计要素"'的性质决定的 。 '
				1。 "资产"'类账户 资产类账户借方记录企业各项资产的增加额，贷方记录各项资产的减少额，余额一般出现在记录增加额的借方，表示期末某一时点企业实际拥有的资产数额。'
					'资产类账户期末余额的计算公式如下'： 资产类账户期末余额 = 借方期初余额   借方本期发生额 C 贷方本期发生额 
				2。"负债"'及'"所有者权益"'类账户' '负债及所有者权益类账户的具体结构完全一致，这两类账户借方记录相关会计要素项目的减少额，贷方记录其增加额，余额一般出现在贷方，反映企业所承担的债务及所有者拥有企业净资产的实际数额。'
					'负债及所有者权益类账户期末余额的计算公式如下：' 负债及所有者权益贷方期末余额 = 贷方期初余额   贷方本期发生额 - 借方本期发生额 
				3。 "成本"'类账户 成本类账户的基本结构与资产类账户的基本结构大体一致。' 
				4。 "损益类"'账户' '损益类账户按照性质的不同可以分为收入类账户和费用类账户。'
					'收入类账户 收入类账户的账户结构与负债及所有者权益类账户结构大体一致。'
					'实际上“借”和“贷”两个字没有实际的意义，与我们日常理解的借、贷意思是不同的。'
					'它是由意大利人卢卡・巴其阿勒最早阐述出来的，即现代会计使用的“复式记账法”，即有借必有贷，借贷必相等。'
					'也就是说，复式记账法是可以同时反映资产的流进或流出的，也就是双向反映。'
			},
			04:{
				"借"'和'"贷"'作为记帐符号，用'"借"'表示资金占用的增加和资金来源的减少，用'"贷"'表示资金来源的增加和资金占用的减少。'
				'会计学中'"借记"'和'"贷记"'没有实际意义，仅作为记账的符号；'
				'一般情况下，'"借"'在账户的左边；'"贷"'在账户的右边。  借贷记账法是复式记账法的一种。'
				'它是以“借”、“贷”为记账符号，以'"资产"＝"负债" "所有者权益"'的会计等式为理论依据，以“有借必有贷，借贷必相等”为记账规则的一种科学复式记账法。'  
				'借方表示资产的增加,资产的期初、期末余额,负债的减少,所有者权益的减少,费用的增加,收入的减少.'
				'贷方表示负债的增加，负债的期初、期末余额,所有者权益的增加，所有者权益的期初、期末余额,资产的减少，费用的减少，收入的增加。'
			}
		},
		360doc:{	'http://www.360doc.com/content/17/0908/23/835753_685634739.shtml'
			企业账:{
				借记 银行存款, 贷记 应收账款	(资产)
				增加 银行存款, 减少 应收账款	:公司把一笔应收账款的钱收回来了.
			}
		}
	}
	SUS-'外币折美元',
	SCY-'外币折本币'
},
process-table-value:{
	ap-file:{
		app_batch-文件批量业务定义:{
			values:{
									 A,one to one transfer
									 B,frozen
									'C,accounting event write file'
									"D,accounting event stored"		'会计事件'
									 E,accrued data write file		'应计数据存储'
									"F,accrued data stored"
									 G,ledger balance write file
									"H,ledger balance stored"		'已存储分类帐余额'
									 I,reconciliation file write
									"J,reconciliation file stored"	'已存储对帐文件'
									 K,CB File TwoGoTrade
									 L,CB File TwoGoTrade Too
									 M,CB Send File TwoGoTrade
									 N,original system occurrence
									 O,original system balance
									 P,excahnge rate file
									"Q,excahnge rate stored file"	'已存储汇率文件'			
					BaseType.U_SHORTDESC	"1,online interface2,aggrement directory"
			BaseType.U_BYTE10	"A,request acceptanceB,send data"	BaseType.U_BYTE32			BaseType.U_BYTE32
		busi_batch_id				busi_batch_type		file_recv_way							remote_dir_code
						busi_batch_desc			file_proc_type	local_dir_code										'busi_org_id'
		'batch business id'		'batch business type'	'file receive way'					'remote directory code'			'trxn_date'
				'batch business describe'	'file process type'	'local directory code'		'${HOME}/temp/${ltts.app.name}/'cbs/99/20210601/
				tab7	の募同步			J	A	2	CORE_CHECK_RECORD_LOCAL			CORE_CHECK_RECORD_REMOTE		'CHECK'			S####	20991231	S####	20991231	1
				taf01	事件同步			D	A	2	TA_ACCOUNTING_LOCAL				TA_ACCOUNTING_REMOTE			'ACCOUNTING'	S####	20991231	S####	20991231	1
				taf02	提文件同步			F	A	2	TA_ACCURE_LOCAL					TA_ACCURE_REMOTE				'ACCURE'		S####	20991231	S####	20991231	1
				taf03	核心分oび囝~文件同步	H	A	2	CORE_LEDGER_BAL_LOCAL			CORE_LEDGER_BAL_REMOTE			'LEDGERBAL'		S####	20991231	S####	20991231	1
				taf04	汇率文件同步			Q	A	2	TA_EXCHANGE_RATE_RECORD_LOCAL	TA_EXCHANGE_RATE_RECORD_REMOTE	'EXCHANGE_RATE'	S####	20991231	S####	20991231	1
			}
		}
	},
	gl_code:{	'which defined in gl'
		fap_accounting_subject:{	'select * from fap_accounting_subject where gl_code='AS1131001''
			values:{
				LI20102:{
					99	LI2010201	Current Account - Resident					LI20102	2	3	Y	LI201020100	2	Y	Y	N	N	N			Y	N			20991231	S####	0	S####	0	0
				},		
				OE40403:{		
					99	OE40403		Retained Earning - Other					OE404	4	2	Y	OE404030000	2	Y	Y	N	Y	Y			Y	N			20991231	S####	0	S####	0	0
				},		
				AS1070801:{		
					99	AS1070801	Staff Loan									AS10708	1	3	Y	AS107080100	1	Y	Y	N	N	N			Y	N			20991231	S####	0	S####	0	0
				},		
				AS1130701:{		
					99	AS1130701	Interest Receivable - Staff Loan			AS11307	1	3	Y	AS113070100	1	Y	Y	N	N	N			Y	N			20991231	S####	0	S####	0	0
				},
				AS1131001:{
					99	AS1131001	Interest Receivable - Overdraft - Resident	AS11310	1	3	Y	AS113100100	1	Y	Y	N	N	N			Y	N			20991231	S####	0	S####	0	0
																	n.居民,住户
				},
				IN6030401-'Other Income - Exchange - Exchange Revaluation':{
					99	IN6030401	Other Income - Exchange - Exchange Revaluation	
																				IN60304	6	3	Y	IN603040100	2	Y	Y	N	Y	Y			Y	N			20991231	S####	0	S####	0	0
				},
			}
		},
		faa_account:{	'select * from faa_account where gl_code='AS1131001''
			values:{
																							acct_branch									acct_bal		previous_acct_bal bal_actt_update
				LI2010201:{
					99	800	840LI20102010020000001	Current Account - Resident					200	LI2010201	USD	00001	1	C	2	80994.55		C	80997.15		20210601	N	Y	N	N	1		200	S####	20181127	20181127999990000011275					S####	20181127 09:57:00 361	S####	20210531 18:02:00 354	2441
					99	800	834LI20102010020000001	Current Account - Resident					200	LI2010201	TZS	00001	1	C	2	782438885.44	C	782444197.44	20210601	N	Y	N	N	1		200	S####	20181127	20181127999990000011708					S####	20181127 10:27:00 321	S####	20210531 18:02:00 401	8426
					99	800	156LI20102010020000001	Current Account - Resident					200	LI2010201	CNY	00001	1	C	2	11820.92		C	11856.96		20210531	N	Y	N	N	1		200	S####	20210421	20210421999990000015818					S####	20210421 14:38:00 370	2101	20210531 17:59:34 853	48
				},		
				AS1070301:{
					99	800	840AS10703010020000001	Term Loan - Resident						200	AS1070301	USD	00001	1	D	1	6585279.19		D	6585279.19		20210531	N	Y	N	N	1		200		S####	20181227	20181227999990000003079					S####	20181227 13:08:00 344	2101	20210531 17:59:35 490	931
					99	800	834AS10703010020000001	Term Loan - Resident						200	AS1070301	TZS	00001	1	D	1	4457933407.84	D	4457933407.84	20210531	N	Y	N	N	1		200		S####	20190115	20190115999990000019847					S####	20190115 17:33:00 421	2101	20210531 17:59:34 945	947
				},
				AS1130701:{		
					99	800	834AS11307010020000001	Interest Receivable - Staff Loan			200	AS1130701	TZS	00001	1	D	1	5713065.57		D	5527788.76		20210531	N	Y	N	N	1		2101	2101	20190307	20190307999990000021953					2101	20190307 19:44:04 613	2101	20210531 17:59:35 012	2653
				},
				AS1131001-'本地逾期应收利息'-'Interest Receivable - Overdraft - Resident':{
					99	800	840AS11310010020000001	Interest Receivable - Overdraft - Resident	200	AS1131001	USD	00001	1	D	1		    6601.74	D		    6601.74	20210207	N	Y	N	N	1		2101	2101	20181231	20181231999990000020545					2101	20190101 23:28:37 905	2101	20210629 14:20:23 486	1557
					99	800	840AS11310010010100001	Interest Receivable - Overdraft - Resident	101	AS1131001	USD	00001	1	D	1		   -6601.74	D		   -6601.74	20210207	N	Y	N	N	1		200		S####	20200507	20200507999990000026906					S####	20200507 13:38:00 319	2101	20210629 14:20:22 390	282
					99	800	834AS11310010020000001	Interest Receivable - Overdraft - Resident	200	AS1131001	TZS	00001	1	D	1		40139489.2	D		38453388.31	20210207	N	Y	N	N	1		2101	2101	20191101	20191101999990000042169					2101	20191101 17:32:32 797	2101	20210629 14:20:22 805	945
				},
				OE40403:{
					99	810	834OE40403000010100001	Retained Earning - Other					101	OE40403		TZS	00001	1	C	2	-3430504669.18	C	-3461540676.55	20210528	N	Y	Y	Y	1		2101	2101	20181126	20181126999990000050662					2101	20181126 20:52:03 067	2101	20210528 22:21:17 893	641
					99	810	834OE40403000020000001	Retained Earning - Other					200	OE40403		TZS	00001	1	C	2	21195465097.84	C	21226501105.21	20210528	N	Y	Y	Y	1		2101	2101	20181126	20181126999990000050662					2101	20181126 20:52:03 095	2101	20210528 22:21:17 914	666
					99	810	840OE40403000010100001	Retained Earning - Other					101	OE40403		USD	00001	1	C	2	-8566045.96		C	-8566185.96		20210528	N	Y	Y	Y	1		2101	2101	20181126	20181126999990000050662					2101	20181126 20:52:03 105	2101	20210528 22:21:17 924	381
					99	810	840OE40403000020000001	Retained Earning - Other					200	OE40403		USD	00001	1	C	2	9499879.25		C	9500019.25		20210528	N	Y	Y	Y	1		2101	2101	20181126	20181126999990000050662					2101	20181126 20:52:03 115	2101	20210528 22:21:17 933	430
					99	810	834OE40403000000000001	Retained Earning - Other					000	OE40403		TZS	00001	1	C	2	-17765738758.16	C	-15800170983.81	20201231	N	Y	Y	Y	1		2101	2101	20181231	20181231999990000020714					2101	20190101 23:35:20 991	2101	20210101 12:30:55 813	4
					99	810	840OE40403000000000001	Retained Earning - Other					000	OE40403		USD	00001	1	C	2	-934879.93		C	-540917.95		20201231	N	Y	Y	Y	1		2101	2101	20181231	20181231999990000020714					2101	20190101 23:35:21 011	2101	20210101 12:30:55 827	4
					99	810	834OE40403000010300001	Retained Earning - Other					103	OE40403		TZS	00001	1	C	2	0				C	20000000		20210504	N	Y	Y	Y	1		2101	2101	20190619	20190619999990000019980					2101	20190619 17:28:06 871	2101	20210504 18:05:21 024	64
					99	810	840OE40403000010300001	Retained Earning - Other					103	OE40403		USD	00001	1	C	2	1000			C	0				20210527	N	Y	Y	Y	1		2101	2101	20190619	20190619999990000019980					2101	20190619 17:28:06 888	2101	20210527 18:34:47 459	58
					99	810	978OE40403000010100001	Retained Earning - Other					101	OE40403		EUR	00001	1	C	2	43651.36		C	43636.36		20201022	N	Y	Y	Y	1		2101	2101	20190318	20190318999990000016277					2101	20190318 18:02:34 476	2101	20201022 16:29:19 563	117
					99	810	978OE40403000020000001	Retained Earning - Other					200	OE40403		EUR	00001	1	C	2	-43651.36		C	-43636.36		20201022	N	Y	Y	Y	1		2101	2101	20190318	20190318999990000016277					2101	20190318 18:02:34 490	2101	20201022 16:29:19 571	117
				}
			}
		},
		fap_accounting_event_parm:{		'select * from fap_accounting_event_parm where gl_code='AS1131001''
			value:{
								accounting_alias																			bal_attributes
				AS1070801{
					99	800	2	NL_STAFF_RES						Staff Loan(Principle)										LNPR01	AS1070801				S####	0						S####	0	1
				},
				AS1130701:{
					99	800	2	NL_STAFF_RES						Staff Loan(Interest Receivable Accrued)						LNIA01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Interest Receivable)								LNID01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Overdue Interest Receivable Accrued)				LNOA01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Overdue Interest Receivable)						LNOD01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Compound Interest Receivable Accrued)			LNCA01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Compound Interest Receivable)					LNCD01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Subsidy Interest Receivable Accrued)				LNRA01	AS1130701	IN6010801	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Subsidy Interest Receivable)						LNRD01	AS1130701	IN6010801	S####	0						S####	0	1
				},
				AS1131001-'本地逾期应收利息'-'Interest Receivable - Overdraft - Resident':{
					99	800	1	PERSONALCURRENTACCT					Individual Current Deposit(Interest Receivable)				DP12	AS1131001	IN6011001	S####	0						S####	0	1
					99	800	1	CORPORATECURRENTACCT				Corporate Current Deposit(Interest Receivable)				DP12	AS1131001	IN6011001	S####	0						S####	0	1
					99	800	1	PUBLICSAVINGACCT					Public Institution Deposits(Interest Receivable)			DP12	AS1131001	IN6011001	S####	0						S####	0	1
					99	800	6	Interest Receivable - Overdraft		Interest Receivable - Overdraft - Resident					TA01	AS1131001				300006	20190225 12:52:09 139				1
				},
				LI20102:{
				
				},
				OE:{
					99	800	2	NL_SYDICATION_NONRES				Sydication Loan of non-Resident(Provision on Normal Loan)	LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_STUDY_RES						Study Loan of Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_STUDY_NONRES						Study Loan of non-Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_TERM_NONRES						Term Loan of non-Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_SYDICATION_RES					Sydication Loan of Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	PROVISIONACCRUAL					Provision Accrued On Loans(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	PROVISIONACCRUAL					Provision Accrued On Loans(Loss on Normal Loan)				LNLS01	OE4020202				S####	0						S####	0	1
					99	800	2	NL_MORTGAGE_RES						Mortgage Loan of Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_MORTGAGE_NONRES					Mortgage Loan of non-Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_PERSONAL_RES						Personal Loan of Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_PERSONAL_NONRES					Personal Loan of non-Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_TERM_RES							Term Loan of Resident(Provision on Normal Loan)				LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_CAR_RES							Car Loan of Resident(Provision on Normal Loan)				LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_CAR_NONRES						Car Loan of non-Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_BUILDING_RES						Building Loan of Resident(Provision on Normal Loan)			LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_BUILDING_NONRES					Building Loan of non-Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	2	NL_STAFF_RES						Staff Loan(Provision on Normal Loan)						LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	6	Current Year Profit/Loss			Year end													TA01	OE403					300006	20190116 17:25:36 669			1
					99	800	2	NL_STAFF_NONRES						Staff Loan of non-Resident (Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	6	Capital Reserves - General Reser	Capital Reserves - General Reserves							TA01	OE4020202				300006	20190620 16:10:10 135			1
					99	800	6	Retained Earning - Normal Loan		Retained Earning - Normal Loan								TA01	OE40401					300006	20190620 16:10:57 234			1
					99	800	2	NL_ASSET_FINANCE_RES				Asset Finance(Provision on Normal Loan)						LNPV01	OE40401		OE4020202	S####	0						S####	0	1
					99	800	6	Paid Up Capital - Ordinary Share	Ordinary Share Capital										TA01	OE40101					300006	20181203 17:00:00 127			1
					99	800	6	R_E- Accumulated profit&loss		RE ACC PROFIT& LOSS											TA01	OE40402					300006	20181203 17:01:34 475			1
					99	800	2	NL_ASSET_FINANCE_NONRES				Asset Finance of non-Resident(Provision on Normal Loan)		LNPV01	OE40401		OE4020202	S####	0						S####	0	1
				}
			}
		},
		tap_accountingevent_ctrl:{
			values:{
				NL_STAFF_RES-'员工贷款':{
					99	NL_STAFF_RES		LNCA01	员工贷款（应计复利）					N	S####	0	S####	0	0            interest	*
					99	NL_STAFF_RES		LNCC01	员工贷款（复利收入）					N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNCD01	员工贷款（应收复利）					N	S####	0	S####	0	0            interest
					99	NL_STAFF_RES		LNIA01	员工贷款（应计利息）					N	S####	0	S####	0	0			 interest	*
					99	NL_STAFF_RES		LNIC01	员工贷款（利息收入）					N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNID01	员工贷款（应收利息）					N	S####	0	S####	0	0			 interest
					99	NL_STAFF_RES		LNIU01	员工贷款（待摊利息）					Y	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNLI01	员工贷款（贷款减值损失核销应收利息）	N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNLP01	员工贷款（贷款减值损失核销本金）		N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNLS01	员工贷款（贷款减值损失）				N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNLS02	员工贷款（贷款减值损失）				N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNOA01	员工贷款（应计罚息）					N	S####	0	S####	0	0  			 interest   *	       
					99	NL_STAFF_RES		LNOC01	员工贷款（罚息收入）					N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNOD01	员工贷款（应收罚息）					N	S####	0	S####	0	0            interest
					99	NL_STAFF_RES		LNPR01	员工贷款（本金）						Y	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNPV01	员工贷款（一般减值准备金）				N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNPV02	员工贷款（特殊减值准备金）				N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNRA01	员工贷款（应计贴息）					N	S####	0	S####	0	0            interest
					99	NL_STAFF_RES		LNRC01	员工贷款（贴息收入）					N	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNRD01	员工贷款（应收贴息）					N	S####	0	S####	0	0            interest
					99	NL_STAFF_RES		LNWI01	员工贷款（核销利息）					Y	S####	0	S####	0	0            
					99	NL_STAFF_RES		LNWP01	员工贷款（核销本金）					Y	S####	0	S####	0	0            
				},
				PERSONALCURRENTACCT-'个人活期存款':{
					99	PERSONALCURRENTACCT	DP01	个人活期存款-负债本金					Y	S####	0	S####	0	0
					99	PERSONALCURRENTACCT	DP11	个人活期存款-资产本金					N	S####	0	S####	0	0
					99	PERSONALCURRENTACCT	DP12	个人活期存款-应收利息					N	S####	0	S####	0	0
				}
			}
		},
		tap_bussiness:{	'select * from TAP_BUSINESS where IDENTIFIER_CODE IN ('AS1131001','')'
			col:{gl_ref_code,gl_ref_desc,identifier_code-'gl_code'},
			values:{																					double_entry_ind	bal_type		year_end_clean_ind
						gl_ref_code							gl_ref_desc							identifier_code	multi_instance_ind	bal_upddate_mode	cash_allow_ind																	AC1																												
																											internal_acct_type		bal_check_ind
				OE:{
					Paid Up Capital - Ordinary Share	Ordinary Share Capital						OE40101		Y	A	Y		C		1	N	N			4	300024	20181203 18:27:59 980			1
					R_E- Accumulated profit&loss		RE ACC PROFIT& LOSS							OE40402		Y	A	Y		C		1	N	N			4	300024	20181203 18:28:12 608			1
					Current Year Profit/Loss			Year end									OE403		Y	A	Y		C		1	N	N			4	300024	20190116 18:42:19 883			1
					Capital Reserves - General Reser	Capital Reserves - General Reserves			OE4020202	Y	A	Y		C		1	N	N			4	300024	20190621 14:59:28 159			1
					Retained Earning - Normal Loan		Retained Earning - Normal Loan				OE40401		Y	A	Y		C		1	N	N			4	300024	20190621 14:59:36 178			1
				}				
				AS1131001:{				
					Interest Receivable - Overdraft		Interest Receivable - Overdraft - Resident	AS1131001	Y	A	Y		D		1	N	N			4	300024	20190225 15:54:15 363			1
				}
			}
		},
		taa_account:{
			values:{
							acct_no					acct_name						gl_ref_code				double_entry_ind	internal_acct_type	bal_type	bal_upddate_mode	default_ind	bal_check_ind	year_end_clean_ind	acct_branch	ccy_code	acct_bal	prev_date_bal	bal_update_date	acct_status	acct_name_check_ind	internal_acct_stop_ind	open_acct_channel	remark								open_acct_date	open_acct_branch	open_acct_user	open_acct_seq	close_acct_branch	close_acct_user	close_acct_date	close_acct_seq	cash_allow_ind
				OE:{}
				AS1131001-'Interest Receivable - Overdraft':{
					99	10184005041	Interest Receivable - Overdraft - Resident	Interest Receivable - Overdraft		Y					A				D				1				Y			N				N					101			USD		-6601.74		-4246.52		20200519		1				N					N						101		Interest Receivable - Overdraft - Resident	20190225		101					300006		1902251010001790																		4	300006	20190225 16:46:36 717	300006	20200519 14:59:59 775	5
				}
			}
		},
	}
	trans:{
		fab_teller_seq:{
		
		},
	}
},
process-file:{
	common:{
		key:{
			No.	BUSI_BATCH_TYPE		PARESE_BATCH_ID	BUSI_BATCH_ID	'BUSI_BATCH_TYPE'	'FILE_PATH_KEY		FILE_NAME_KEY					DATA_TABLE																		BODY_KEY
				批量业务类型		解析文件跑批	生成文件跑批	'批量业务类型'		
				EnumType.E_BATCHTYPE							'EnumType.E_BATCHTYPE'		
			0	"N-原始系统发生额"		glt00			fin01			N			"FINANCEAMT-金融金额"	Gli_Item_Sm.txt		"fab_org_sys_occurr-原始系统发生登记表"										
			1	"O-原始系统余额"		glt01			fin02			O			"FINANCEBAL-金融余额"	Gli_Item_Re.txt		"fab_org_sys_bal-原始系统资产负债登记表"									
			2	"F-应计数据存储"		glt02			taf02			F			"ACCURE-精确"			ACCURE_.txt					"fab_accrue-计提登记表"				{"trxn_date","accrue_type","acct_branch","accounting_alias","ccy_code","bal_attributes","budget_inst_amt"}	{"trxn_date":"20201222","accrue_type":"A","acct_branch":"0100105","accounting_alias":"FITIMESAVINGACCT_NRA","ccy_code":"HKD","bal_attributes":"DP02","budget_inst_amt":0.00}										
			3	"H-已存储分类帐余额"	glt03			taf03			H			"LEDGERBAL-领导余额"	LEDGERBAL_.txt		"fab_ledger_check_seq-工厂分类帐检查"										
			4	"J-已存储对帐文件"		glt06			tab7			J			"CHECK-核对"			CHECKRECORD_.txt												
			5	"D-会计事件"			fat1			taf01			D			"ACCOUNTING-记账"		ACCOUNTING_.txt		
		},
		file:{
			temp/99/20201222/
			"ACCOUNTING"-'记账':{},
			"ACCURE"-'精确':{},
			"CHECK"-'核对':{},
			"FINANCEAMT"-'金融金额':{},
			"FINANCEBAL"-'金融余额':{},
			"LEDGERBAL"-'分算余额':{},
			tz-pro:{		
				cbs:{	210621a		'/sunline/v7base/cbs-ltts-bat/cbs/99'
					210621 	210621-1916:{
						ACCOUNTING 				210621-1905:{210621,0930-1905}.ok
						ACCURE 					210621-1855:{210621-1855}.ok
						CHECK 					210621-1916:{210621-1916}.ok
						CORE_LOAN_XML_LOCAL		210621-1916:{210621-1916}
						EXCHANGE_RATE 			210621-1855:{210621-1855}.ok
						LEDGERABL				210621-1855:{210621-1855}.ok
						SWIFT					210621-1105:{
							IN 					210620-1520:{null}
							OUT					210621-1200:{null}
							OUTBAK				210621-1200:{210621,1105-1200}.fin
						}
					},
					210622	210621-1905:{
						ACCOUNTING 				210621-1905:{210621,1905}
						SWIFT					210621-1105:{
							IN 					210621-1900:{null}
						}
					}
				},		
				ftp:{	210621a		'/sunline/ftp/uat/cbs/99'
					210621 	210621-1916:{
						ACCOUNTING 				210621-1905:{210621,0930-1905}.ok
						ACCURE 					210621-1855:{210621-1855}.ok
						CHECK 					210621-1916:{210621-1916}.ok
						CORE_LOAN_XML_LOCAL		210621-1916:{210621-1916}
						EXCHANGE_RATE 			210621-1855:{210621-1855}.ok
						LEDGERABL				210621-1855:{210621-1855}.ok
						LTBILL					210621-1233:{210620,1538-210621,1233}.pdf
					},
					210622	210621-1936:{
						ACCOUNTING 				210621-1905:{210621,1905}.ok
						ACCURE 					210621-1936:{null}
						CHECK 					210621-1936:{null}
						EXCHANGE_RATE 			210621-1936:{null}
						LEDGERABL				210621-1936:{null}
					}
				},	
				gl:{	210621a		'/sunline/glbase/temp/gl/cbs/99'
					210621 	210621-1916:{
						ACCOUNTING 				210621-1906:{210621,0931-1906}.txt
						ACCURE 					210621-1856:{210621-1856}.txt
						CHECK 					210621-1917:{210621-1917}.txt
						EXCHANGE_RATE 			210621-1856:{210621-1856}.txt
						LEDGERABL				210621-1856:{210621-1856}.txt
					},
					210622	210621-1936:{
						ACCOUNTING 				210621-1935:{210621,1935}.txt
						ACCURE 					210621-1936:{null}
						CHECK 					210621-1936:{null}
						EXCHANGE_RATE 			210621-1936:{null}
						LEDGERABL				210621-1936:{null}
					}
				},
				
			}
		},
		faa_account	-- "总账账户表"	glt01
			"org_id":"99",sys_no,acct_branch,ccy_code,acct_type
	},
	1:{
		init:{
			apb_batch_request a,apb_batch_receive c	-- "文件批量请求薄"
				a.busi_batch_type	-- "批量业务类型-batch business type"
			glt00-"财务系统发生额导入":{"N--原始系统发生额",fab_org_sys_occurr"原始系统发生登记表"},
			glt01-"财务系统余额导入":{"O-original system balance-原始系统余额",faa_account"总账账户表",fab_org_sys_bal"原始系统资产负债登记表-original system balance registration sheet"},
			glt02-"提n入":{"F-ACCRUE_DOWN-accrued data stored-应计数据存储",fab_accrue"accrue registration sheet-计提登记表",fab_original_voch"外部原始会计人员-external original accounting vocher"},
			glt03-"核心分户账余额数据文件导入":{"H-ledger balance stored-已存储分类帐余额",fab_ledger_check_seq"工厂分类帐检查"},
			glt06-"对账文件导入及检查":{"J-reconciliation file stored-已存储对帐文件",update apb_batch_request.file_handling_status"文件批量请求薄"."文件处理状态"="C - success"}	
		},
		do:{
			nsql-GlRegBook.selAccureBookGroup
				fab_accrue a	-- "计提登记表-accrue registration sheet"
					a.analysis_state='A' 	-- "分析状态-analysis state"	"2-AYNASIED-已解析"
					a.accrue_type = 'B' 	--	"计提种类-accrue type"	
			insert into fab_accounting_voch b; 	-- "会计凭证-accounting voucher"
				b.total_count
			glt16-"J款差~提":{"B-贷款应收利息计提",remark-"loanAccure",total_count-"1l"}
			glt17-"J款p失洳铑~提":{"C - 贷款损失准备计提",remark-"loanAccure",total_count-"2l"}
		},
		parse:{
			fat1-"读取及处理会计事件流水文件":{}
		}
	}
	enum:{
		EnumType.E_FILEPROCTYPE:{
			<restrictionType id="E_FILEPROCTYPE" longname="file process type" base="string" maxLength="1">
				<enumeration id="RECV_REQUEST" value="A" longname="request acceptance"/>
				<enumeration id="SEND_DATA" value="B" longname="send data"/>
			</restrictionType>
		},
		EnumType.E_FILERECVWAY:{
			<restrictionType id="E_FILERECVWAY" longname="file receive method" base="string" maxLength="1">
				<enumeration id="ONLINE_INTERFACE" value="1" longname="online interface"/>
				<enumeration id="APPOINT_DIURECTORY" value="2" longname="aggrement directory"/>
			</restrictionType>
		},
		EnumType.E_BATCHTYPE:{
			<restrictionType id="E_BATCHTYPE" longname="file bacth type" base="string" maxLength="1">
				<enumeration id="TRANBYONE" value="A" longname="one to one transfer"/>
				<enumeration id="FROZETYPE" value="B" longname="frozen"/>
				<enumeration id="ACCOUNTINGEVENT_WRITE" value="C" longname="accounting event write file"/>
				<enumeration id="ACCOUNTINGEVENT_DOWN" value="D" longname="accounting event stored"/>
				<enumeration id="ACCRUE_WRITE" value="E" longname="accrued data write file"/>
				<enumeration id="ACCRUE_DOWN" value="F" longname="accrued data stored"/>
				<enumeration id="LEDGER_WRITE" value="G" longname="ledger balance write file"/>
				<enumeration id="LEDGER_DOWN" value="H" longname="ledger balance stored"/>
				<enumeration id="CHECK_WRITE" value="I" longname="reconciliation file write"/>
				<enumeration id="CHECK_DOWN" value="J" longname="reconciliation file stored"/>
				<enumeration id="CBTwoGoTrade" value="K" longname="CB File TwoGoTrade"/>
				<enumeration id="CBTwoGoTrades" value="L" longname="CB File TwoGoTrade Too"/>
				<enumeration id="CBTwoGoTradeSend" value="M" longname="CB Send File TwoGoTrade"/>
				<enumeration id="OrgSysOccurr" value="N" longname="original system occurrence"/>
				<enumeration id="OrgSysBalance" value="O" longname="original system balance"/>
				<enumeration id="EXCHANGE_RATE" value="P" longname="excahnge rate file"/>
				<enumeration id="EXCHANGE_RATE_DOWN" value="Q" longname="excahnge rate stored file"/>
			</restrictionType>
		},
		EnumType.E_FILEDEALSTATUS:{
			<restrictionType id="E_FILEDEALSTATUS" longname="file handling status" base="string" maxLength="1" minLength="0">
				<enumeration id="UNCHECK" value="A" longname="pending to check"/>
				<enumeration id="CHECKED" value="B" longname="checked"/>
				<enumeration id="SUCCESS" value="C" longname="success"/>
				<enumeration id="FAILCHECK_OTHER" value="Q" longname="check fail - others"/>
				<enumeration id="FAILCHECK_INSERT" value="X" longname="check fail - schedule imported abnormal"/>
				<enumeration id="FAILCHECK_FORMAT" value="Y" longname="check fail - format error"/>
				<enumeration id="FAILCHECK_UNEQUAL" value="Z" longname="check fail - unmatch"/>
			</restrictionType>
		}
	},
	LEDGERBAL-taf03:{
		TaFile.writeLedgerBalDataMain()	<-	taf03.process	<-	tas_ledger_bal
	},
	ACCOUNTING*.txt:{
		create:{
			
		},
		parse-fat1:{
			file_body	->	fab_accounting_seq,fab_original_voch
			fab_accounting_seq{sys_no-'800',accounting_alias,bal_attributes}	->	fap_accounting_event_parm
								{'FCY_EXCHANGE_CUST','TA01'}					->	'FX30101'
		}
	},
	TEMPLATE*.txt:{
		create:{
			
		},
		parse:{
			
		}
	}
	tz-uat-path:{
		210131:{
			ftp:{
				/sunline/ftp/uat/cbs/99/20210131/ACCOUNTING:{
					0 
				},
				/sunline/ftp/uat/cbs/99/20210131/ACCURE:{
					-rw-r--r-- 1 ftpuser sunline 6852 Jun 21 17:36 ACCURE20210131.txt
					-rw-r--r-- 1 ftpuser sunline    0 Jun 21 17:36 ACCURE20210131.txt.ok
				}
			}
		}
	}
},
ta:{
	code:{
		SrvIoTaAccounting.regAccountingEvent:{	'登记会计事件'
			field:{
				acct_no-'现金账号'-Y,
				debit_credit-'记账方向'
				trxn_ccy-'交易币种'
				trxn_amt-'交易金额'
				acct_branch-'账务机构'
				accounting_alias-'核算别名':{
					"CASH",
				},
				accounting_subjet-'会计主体':{
					enum:{
						<restrictionType id="E_ACCOUNTINGSUBJECT" longname="accounting subject" base="string" maxLength="1" minLength="0">
							<enumeration id="DEPOSIT" value="1" longname="deposit"/>
							<enumeration id="LOAN" value="2" longname="loan"/>
							<enumeration id="CASH" value="3" longname="cash"/>
							<enumeration id="VOUCHER" value="4" longname="voucher"/>
							<enumeration id="FEE" value="5" longname="fees"/>
							<enumeration id="INSIDE" value="6" longname="internal account"/>
							<enumeration id="CREDIT" value="7" longname="credit card"/>
						</restrictionType>
					}
				},
				bal_attributes-'余额属性':{
					note:{
						dp:{
							"DP01"-"负债本金"
							"DP02"-"应付利息"
							"DP03"-"利息税"
							"DP04"-"已付利息"
							"DP11"-"资产本金"
							"DP12"-"应收利息"
							"DP13"-"利息收入"
							"DP14"-"超额利息"
							"DP15"-"特殊准备金"
						},
						ta:{					
							"TA01"-"内部户本金"
						},
						ln:{
							"LN01"-"贷款减值损失"
						},
						cs:{
							"CS01"-"现金存量"
							"CS02"-"途中现金库存"
							"CS03"-"现金装置"
							"CS04"-"途中现金装置"
							"CS05"-"一般现金"
							"CS06"-"漂亮现金"
							"CS11"-"现金变动利润"
							"CS12"-"现金变动损失"
						},
						vc:{
							"VC01"-"代金券库存"
						},
						cg:{
							"CG01"-"收费"
							"CG02"-"摊销费用"
						},
						co:{
							"CO01"-"抵押物价值"
						}233,254,275,296,321,434,443,471,505,620,662,682,
					},
					enum:{
						<restrictionType id="E_BALPROPERTY" longname="balance property" base="string" maxLength="4">
							<enumeration id="DEPOSIT" value="DP01" longname="deposit principal"/>								"DP01"-"负债本金"
							<enumeration id="INTEREST_PAYABLE" value="DP02" longname="interest payable"/>                       "DP02"-"应付利息"
							<enumeration id="INTEREST_TAX" value="DP03" longname="interest tax"/>                               "DP03"-"利息税"
							<enumeration id="INTEREST_PAY" value="DP04" longname="interest pay"/>                               "DP04"-"已付利息"
							<enumeration id="CAPITAL" value="DP11" longname="asset principal"/>                                 "DP11"-"资产本金"
							<enumeration id="INTEREST_RECEIVABLE" value="DP12" longname="receivable interest"/>                 "DP12"-"应收利息"
							<enumeration id="INTEREST_INCOME" value="DP13" longname="interest income"/>                         "DP13"-"利息收入"
							<enumeration id="BAD_INTEREST_RECEIVABLE" value="DP14" longname="bad overdraft accrued Interest"/>  "DP14"-"超额利息"
							<enumeration id="SPECIAL_PROVISION_AMT" value="DP15" longname="special provision amtount"/>         "DP15"-"特殊准备金"
							<enumeration id="INAC_PRCP" value="TA01" longname="internal account principal"/>                    "TA01"-"内部户本金"
							<enumeration id="LOAN_IMPAIRMENT_LOSS" value="LN01" longname="loan impairment loss"/>               "LN01"-"贷款减值损失"
							<enumeration id="CASH_STOCK" value="CS01" longname="cash stock"/>                                   "CS01"-"现金存量"
							<enumeration id="CASH_STOCK_WAY" value="CS02" longname="on the way cash stock"/>                    "CS02"-"途中现金库存"
							<enumeration id="CASH_DEVICE" value="CS03" longname="cash device"/>                                 "CS03"-"现金装置"
							<enumeration id="CASH_DEVICE_WAY" value="CS04" longname="on the way cash device"/>                  "CS04"-"途中现金装置"
							<enumeration id="CASH_GENERAL" value="CS05" longname="cash general"/>                               "CS05"-"一般现金"
							<enumeration id="CASH_PRETTY" value="CS06" longname="cash pretty"/>                                 "CS06"-"漂亮现金"
							<enumeration id="CASH_CHANGE_PROFIT" value="CS11" longname="cash change profit"/>                   "CS11"-"现金变动利润"
							<enumeration id="CASH_CHANGE_LOSS" value="CS12" longname="cash change loss"/>                       "CS12"-"现金变动损失"
							<enumeration id="VOCH_STOCK" value="VC01" longname="voucher stcok"/>                                "VC01"-"代金券库存"
							<enumeration id="CHRG" value="CG01" longname="charge"/>                                             "CG01"-"收费"
							<enumeration id="CHRG_AMORT" value="CG02" longname="amortization charge"/>                          "CG02"-"摊销费用"
							<enumeration id="COLLATERAL_VALUE" value="CO01" longname="collateral value"/>                       "CO01"-"抵押物价值"
							<subenums>
								<subenum id="E_TA" enums="INAC_PRCP" longname="internal account balance property"/>
								<subenum id="E_DP" enums="DEPOSIT,INTEREST_PAYABLE,INTEREST_TAX,INTEREST_PAY,CAPITAL,INTEREST_RECEIVABLE,INTEREST_INCOME" longname="loan balance property"/>
								<subenum id="E_CS" enums="CASH_STOCK,CASH_STOCK_WAY,CASH_DEVICE,CASH_DEVICE_WAY" longname="cash balance property"/>
								<subenum id="E_VC" enums="VOCH_STOCK" longname="voucher stock balance property"/>
								<subenum id="E_CG" enums="CHRG,CHRG_AMORT" longname="charge balance property"/>
							</subenums>
						</restrictionType>
					}
				},
				double_entry_ind-'复试记账标志':{
					baidu:{
						'复式记账法是以资产与权益平衡关系作为记账基础，对于每一笔经济业务，都要以相等的金额在两个或两个以上相互联系的账户中进行登记，系统地反映资金运动变化结果的一种记账方法。'
						'复式记账是对每一项经济业务通过两个或两个以上有关账户相互联系起来进行登记的一种专门方法。任何一项经济活动都会引起资金的增减变动或财务收支的变动。'
					}
				}
			},
			caogao:{
				taAccountingEvnetIn.setAcct_no(regACSerailIn.getAcct_no()); 			// 现金账号
				taAccountingEvnetIn.setDebit_credit(regACSerailIn.getDebit_credit());	// 记账方向
				taAccountingEvnetIn.setTrxn_ccy(regACSerailIn.getCcy_code()); 			// 交易币种
				taAccountingEvnetIn.setTrxn_amt(regACSerailIn.getTrxn_amt()); 			// 交易金额
				taAccountingEvnetIn.setAcct_branch(regACSerailIn.getAcct_branch()); 	// 账务机构
				taAccountingEvnetIn.setAccounting_alias(CmConst.CASH_ACCOUNTING_ALIAS); // 核算别名
				taAccountingEvnetIn.setAccounting_subject(E_ACCOUNTINGSUBJECT.CASH); 	// 会计主体
				taAccountingEvnetIn.setBal_attributes(balProperty.toString()); 			// 余额属性
				taAccountingEvnetIn.setDouble_entry_ind(E_YESORNO.YES);					// 复试记账标志
			}
			logic:{
				TaAccounting.regAccountingEvent(IoTaAccountingEventIn);:{
					tables-tap_accountingevent_ctrl-'会计事件控制'-select:{
						where accounting_alias='' and bal_attributes=''
					},
					tables-tas_accounting_event-'会计事件表'-insert:{
						
					},
				}
			}
		},
		SrvIoTaAccounting.checkBalance();-'账务平衡检查':{	'账务检查'
			method-BizUtil.getTrxRunEnvs-'null',
			method-ApOrg.getReferenceOrgId-'null':{
				method-BizUtil.getTrxRunEnvs-'null',
				method-BizUtil.isOrgRelated-'null',
				table-app_parameter_reference-select-'parameter reference define',
				table-app_parameter_reference-select-'parameter reference define',
				method-BizUtil.isParmTable-'null',
				method-ApOrg.getOrgInfo-'null':{
					table-app_organization-select-'organization infomation'
				},
				method-ApOrg.getOrgInfo-'null':{
					table-app_organization-select-'organization infomation'
				}
			},
			nsql-TaAccounting.selTrxnNoBalancedData-S-tas_accounting_event-select
				-'getting the unbalanced records by transaction sequence ':{
				select
						a.trxn_ccy, sum(case a.debit_credit when 'D' then a.trxn_amt else - a.trxn_amt end) as trxn_amt 
				from
						tas_accounting_event a 
				where
						a.trxn_seq = #trxn_seq# 
					and a.org_id = #org_id# 
					and a.double_entry_ind = 'Y' 
				group by
						a.trxn_ccy
				having
						sum(case a.debit_credit when 'D' then a.trxn_amt else - a.trxn_amt end) !=0 
			},
			table-tas_accounting_event-select-'accounting event'
		}
	},
	tables:{
		tap_business-TAP_BUSINESS:{
			insert-1:{
				TaBusinessMnt.addBusiness(TaBusiInfo, Options);-1:{
					SrvTaBusiness.addBusiness-1,	<-		ta7101-'新增业务编码'
				}
			}
		},
		taa_account-'内部户':{
			insert-1:{
				TaAccountMnt.openAcct(TaAcctInfo);-3:{
					TaAccounting.noExistAccount(IoTaBookAccountingIn)-0;
					SrvTaAccount.openAcct(TaAcctInfo);-'内部户开户'-1 						<-	ta7201/70006	<-6101
					TaSuspenseMnt.openSuspense(TaSuspenOpenInfo);-2:{
						TaAccounting.openSuspenseNo(IoTaBookSuspenseIn)-0;
						SrvTaSuspens.openSuspense(TaSuspenOpenInfo);-'待销账手工开立'-1 	<-	ta7301
					}
				}
			},
			1-insert:{
				TaAccountMnt.openAcct(TaAcctInfo):{
					openInterAccounts(IoTaOpenAccountIn);-1:{
						SrvIoTaAccountingImpl.openInterAccounts(IoTaOpenAccountIn);:{
							AgUntil.openInterAccountInfo(IoTaOpenAccountIn);-1:{
								AgBatchMnt.AddBatchContract(AgBatchContractInfo);-1:{
									SrvAgBatchBusinessImpl.AddBatchContract(AgBatchContractInfo);-1:{
										ag2192
									}
								}
							}
						}
					}
				}
			},
			10-update:{
				1-TaAccountMnt.modifyAcct(TaAcctInfo, Options, Options);
				1-TaAccountMnt.closeAcct(String, Long);
				1-TaAccountMnt.stopOrStartAccount(String, E_YESORNO, Long)
				2-TaAccounting.updAccBal(TaAcctBalUpadatingIn, taa_account);-2:{
					TaAccounting.onlineAccounting(IoTaBookAccountingIn, taa_account);:{
						bookAccounting(IoTaBookAccountingIn, boolean);-2:{
							bookAccountingWithNoCheck(IoTaBookAccountingIn);
							bookAccountingWithCheck(IoTaBookAccountingIn);		-7:{
			*					1-TaSetAccounting.busiCodeAccounting(IoTaAccountListIn);
								1-TaSetAccounting.insideAccounting(IoTaAccountListIn);
								2-SrvIoTaAccountingImpl.bookAccountingWith..;:{
									1-at-IoClient4Gl.ioBookAccounting(BusiCodeIn);
									1-cb-CbCashOutInStock.regAccounting(CbCashPrettyIn);
									1-cb-CbCashOverShort.bookInsideAcct(CbCashOverShortDoneIn, RunEnvs, E_DEBITCREDIT, String);
									4-cb-note;
									1-cb-IoClient4Inside.bookAccountingWithCheck(CbBookAccountingIn);
									1-cm-CmChrgAccounting.chrgDebit(CmChrgDeAccounting, BigDecimal, Boolean);:{
										chrgDebitAccounting(CmChrgDeAccounting)-2:{
											prcChrgAccounting(CmChrgInfo)-2:{
												CmChrgMain.prcAutoChrgAccounting(AutoChrgInfo)-1:{
													SrvIoCmChrgImpl.prcAutoChrgAccounting(AutoChrgInfo);-5
												}
												CmChrgMain.prcManualChrgAccounting(IoCmChrgManualIn)
											}
											prcChrgOwe(IoCmTakeChrgOweIn)
										}
									}
									1-cm-CmChrgAccounting.prcChrgReturn(CmChrgReimburse);
									1-cm-CmReveralAccounting.chrgDebit(CmChrgDeAccounting, BigDecimal, Boolean);
									1-cm-CmReveralAccounting.prcChrgReturn(CmChrgReimburse);
									lt-10,
									lttran-2,
									py-1,
									st-1,
									ts-2,
								}
								2-TaSuspenseMnt.closeSuspense(String, String, String);
								1-AgUntil.insideAccounting(agb_batch_request, E_DEBITCREDIT, String, BigDecimal);
							}
						}
					}
					ta01.process
				}
				2-TaAccounting.reverslUpdAccBal(TaAcctBalUpadatingIn, taa_account);
				1-TaReversal.openInsiAcctReversal(TaOpenInsiAcctReversalIn);
				1-TaReversal.closeAcctReversal(TaCloseInsiAcctReversal);
				1-taa3.process(String, int, String, Input, Property);
			}
		},
		tas_accounting_event:{
			insert-1:{
				TaAccounting.regAccountingEvent(IoTaAccountingEventIn);-'登记会计事件'
			}
		},
		tas_ledger_bal-'分户账余额':{
			insert-1:{
				TaAccounting.regLedgerBal(IoTaRegLedgerBal);-2:{
					SrvIoTaAccounting.regLedgerBal-3:{
						cm03.process,
						cm05.process,
						at-IoClient4Gl
					},
					taa9.process
				}
			},
			1-insert:{
				TaAccounting.regLedgerBal(IoTaRegLedgerBal);-2:{
					SrvIoTaAccountingImpl.regLedgerBal();-5:{
						at-IoClient4Gl.regLedgerBal(AccountBalance);
						co-IoClient4Gl.regLedgerBal(AccountBalance);
						cm-cm03.process:{accounting_alias:"VOUCHER"};
						cm-cm05.process:{accounting_alias:"CASH"};
						lt-DpAcctVerifyData.regLedgerBalance();-1:{
							dp05-'Dept account balance of the previous day collect':{
								process:{
										method-DpAcctVerifyData.regLedgerBalance-'null':{
											List listAcctBal = nsql-DpDayEnd.selLastBalanceExtractRecord-S-dpa_sub_account-select-'Statistical dept balance data for the previous day':{
												
											},
											for(listAcctBal){
												localSer-SrvIoTaAccounting.regLedgerBal-'null':{
													method-TaAccounting.regLedgerBal-'null':{
														method-ApBusinessParm.getValue-'null':{
															table-app_business_parameter-select-'system parameter'
														},
														table-tap_accountingevent_ctrl-select-'contrl accounting event',
														method-BizUtil.getTrxRunEnvs-'null',
														table-tas_ledger_bal-insert-' the balance of ledger account'
													}
												}
											}
										}
								},
							},
						}
					},
					taa9-'内部账入分户账余额流水'	<-	taa_account:{
						getBatchDataWalker:{
								method-ApOrg.getReferenceOrgId-'null':{
									method-BizUtil.getTrxRunEnvs-'null',
									method-BizUtil.isOrgRelated-'null',
									table-app_parameter_reference-select-'parameter reference define',
									table-app_parameter_reference-select-'parameter reference define',
									method-BizUtil.isParmTable-'null',
									method-ApOrg.getOrgInfo-'null':{
										table-app_organization-select-'organization infomation'
									},
									method-ApOrg.getOrgInfo-'null':{
										table-app_organization-select-'organization infomation'
									}
								},
								nsql-ApBranch.selBranchList-S-apb_branch-select-'branch infomation list inquire':{
									SELECT * from apb_branch where real_branch_ind = Y
								}
						},
						process:{
								method-BizUtil.getTrxRunEnvs-'null',
								method-ApOrg.getReferenceOrgId-'null':{},
								List acctBalList = nsql-TaAccounting.selAccountBal-S-taa_account-select-'inquering internal account balance':{
									a.gl_ref_code
								},
								method-ApOrg.getReferenceOrgId-'null':{},
								nsql-TaAccounting.selSuspensBal-S-(select-select-'the ledger  balance of suspense accounts',
								for(acctBal:acctBalList){
									regBal.setAccounting_alias(acctBal.getGl_ref_code());
									method-TaAccounting.regLedgerBal-'null':{
										method-BizUtil.fieldNotNull-'null',
										method-ApBusinessParm.getValue-'null':{
											table-app_business_parameter-select-'system parameter'
										},
										table-tap_accountingevent_ctrl-select-'contrl accounting event',
										method-BizUtil.getTrxRunEnvs-'null',
										table-tas_ledger_bal-insert-' the balance of ledger account'
									}
								}
						},
					},
				}	
			}
		},
		tas_accrue_record:{
			insert-1:{
				TaAccounting.regAccure(IoTaRecordAccure)-1:{	'登记计提'
					SrvIoTaAccounting.regAccure(IoTaRecordAccure)-3:{
						DpOverDraftDayEnd.regAccrualExtract(String),
						DpDayEndInterest.regAccrualExtract(String),
						IoClient4Gl.regAccure(AccountGl)-2:{
							
						}
					}
				}
			}
		}
	},
},
gl:{
	tables:{
		apb_batch_request:{
			isnert-1:{
				ApBatch.fileBatchApply(ApFileIn);-2:{
					ApFile.syncRemoteFile2Local(String);-1:{
						ap04.process
					},
					SrvApBatchFile.fileBatchApply(ApFileIn);-0
				}
			}
		},
		fap_accounting_event_parm-:{
			insert-1:{
				FaAccountingEventMnt.addAccountingEvent(FaAccountingEventInfo);	-1:{
					FaAccountingEventMnt.mntAccountingEvent(Options);-1:{
						SrvFaAccountingEvent.mntAccountingEvent(Options);-0
					}
				}
			}
		},
		faa_account:{
			update-5:{
				FaCloseAccount.closeAccount(String, String, Long),
				FaModifyAccount.modifyAcct(FaAcctInfo),
				FaAccounting.updateBalance(FaUpdateBalanceIn)-1:{
					FaAccounting.singleAccountingDo(FaSingleAccountingDoIn, String, long)-2:{
						FaAccounting.singleAccounting(FaSingleAccountingCheckIn, String, Long)-4:{
							1-FaAccounting.bookMultiAccounting(List, String, Long, String, String, boolean)-14,
							1-GlSettle.prcKeep(String, String, BigDecimal, String, String, String, String, String);
							2-GlSettleFlat.prcSettleFlatAccounting(String, BigDecimal, BigDecimal, String, String);	
						},
						FaAccounting.bookOffBalanceAccounting(FaOffBanlceAccountingIn)
					}
				},
				FaAccountingSubjectMnt.modifySubject(FaSubjectInfo)-2:{
					FaAccountingSubjectMnt.modifySubjectList(List)-0,
					SrvFaAccoutingSubject.modifySubjectInfo		<-		fa8104
				}
				gl65-'posting the gl accounts'-previous_acct_bal,
			}
		},
		fab_teller_seq:{
			insert-4:{
				FaAccounting.regTellerSeq(FaRegTellerSeq)-23,
				FaAccountingEventMnt.regTellerSeq(FaRegTellerSeq)-1:{
					FaAccountingEventMnt.RegTeller(FaAccountingEventInfo)
				},
				FaAccountingSubjectMnt.regTellerSeq(FaRegTellerSeq)-1:{
					FaAccountingSubjectMnt.RegTeller(FaSubjectInfo)
				},
				ExchangeRate.regTellerSeq(FaRegTellerSeq)-1:{
					ExchangeRate.RegTeller(GlExchangeRate)
				},
			}
		},
		fab_accounting_voch:{
			insert-1:{
				FaAccounting.regAccountingVoch(FaRegAccountingVoch-1:{
					FaAccounting.singleAccountingDo(FaSingleAccountingDoIn, String, long)-2:{
						FaAccounting.singleAccounting(FaSingleAccountingCheckIn, String, Long)-4:{
							1-FaAccounting.bookMultiAccounting(List, String, Long, String, String, boolean)-14,
							1-GlSettle.prcKeep(String, String, BigDecimal, String, String, String, String, String);
							2-GlSettleFlat.prcSettleFlatAccounting(String, BigDecimal, BigDecimal, String, String);	
						},
						FaAccounting.bookOffBalanceAccounting(FaOffBanlceAccountingIn)
					}
				}
			},
			from:{
				gl16,from ACCURE/ACCURE20210207.txt,
				from tas_accrue_record taf02,
				dp04:{
					insert into tas_accrue_record(trxn_date, accrue_type, acct_branch, accounting_alias, ccy_code, bal_attributes, budget_inst_amt, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('20210207', 'B', '200', 'CORPORATECURRENTACCT', 'TZS', 'DP12', 40139489.2000000, '99', 'S####', '20210629 14:18:50 679', NULL, NULL, 1);
				}
			}
			search:{
				gl16:{
					insert into fab_accounting_voch(trxn_date, trxn_seq, data_sort, sys_no, acct_branch, trxn_ccy, gl_code, acct_seq, acct_no, debit_credit, accounting_amt, total_count, exchg_method, exchg_org_ccy_amt, exchg_dol_ccy_amt, on_bal_sheet_ind, bal_direction, acct_bal, summary_code, summary_desc, host_date, trxn_time, remark, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('20210207', '202102079999900000000014', 13, '800', '200', 'TZS', 'AS1131001', '00001', '834AS11310010020000001', 'D',1686100.89, 1, '1', 0, 0, 'Y', 'D', 40139489.20, NULL, NULL, '20210629', '14:19:50 092', 'loanAccure', '99', '2101', '20210629 14:19:50 282', NULL, NULL, 1)
					insert into fab_accounting_voch(trxn_date, trxn_seq, data_sort, sys_no, acct_branch, trxn_ccy, gl_code, acct_seq, acct_no, debit_credit, accounting_amt, total_count, exchg_method, exchg_org_ccy_amt, exchg_dol_ccy_amt, on_bal_sheet_ind, bal_direction, acct_bal, summary_code, summary_desc, host_date, trxn_time, remark, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('20210207', '202102079999900000000014', 14, '800', '200', 'TZS', 'IN6011001', '00001', '834IN60110010020000001', 'C',1686100.89, 1, '1', 0, 0, 'Y', 'C', 92368975.18, NULL, NULL, '20210629', '14:19:50 092', 'loanAccure', '99', '2101', '20210629 14:19:50 286', NULL, NULL, 1)
					insert into fab_accrue_accounting(sys_no, accrue_date, accrue_branch, ccy_code, accrue_type, accrue_gl_code, accrue_offset_gl_code, accrue_inst_total_amt, accrued_amt, current_accrue_amt, accounting_date, accounting_seq, accrue_acct_no, accrue_opp_acct_no, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('800', '20210207', '200', 'TZS', 'B', 'AS1131001', 'IN6011001', 40139489.20, 38453388.31, 1686100.89, '20210207', '202102079999900000000014', '834AS11310010020000001', '834IN60110010020000001', '99', '2101', '20210629 14:19:50 287', NULL, NULL, 1)
				},
				gl35:{
					gla_branch_gl.selectByIndexWithLock_odb1,
					gla_branch_gl.updateByIndex_odb1,
						current_debit_amt=1686100.89
						update gla_branch_gl where report_type='1' and trxn_date='20210207' and branch_id='200' and ccy_code='TZS' and gl_code='AS1131001' and org_id='99'
						current_credit_amt=1686100.89					 
											 where report_type='1' and trxn_date='20210207' and branch_id='200' and ccy_code='TZS' and gl_code='IN6011001' and org_id='99'
				},
				gl40:{
					glb_exchange_process.selectByIndexWithLock_odb1,
					glb_exchange_process.updateByIndex_odb1,
						current_debit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SCY' and gl_code='AS1131001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SUS' and gl_code='AS1131001' and org_id='99'
						current_credit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SCY' and gl_code='IN6011001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SUS' and gl_code='IN6011001' and org_id='99'
				},
				gl45:{
					gla_exchange_gl.selectByIndexWithLock_odb1,
					gla_exchange_gl.updateByIndex_odb1
						current_debit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SUS' and gl_code='AS1131001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SCY' and gl_code='AS1131001' and org_id='99'
						current_credit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SCY' and gl_code='IN6011001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and exchange_ccy_code='SUS' and gl_code='IN6011001' and org_id='99'
				},
				gl51:{
					glb_gl_report.selectByIndexWithLock_odb1,
					glb_gl_report.updateByIndex_odb1
						current_debit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='TZS' and gl_code='AS1131001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='SCY' and gl_code='AS1131001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='SUS' and gl_code='AS1131001' and org_id='99'
						current_credit_amt=1686100.89
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='TZS' and gl_code='IN6011001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='SCY' and gl_code='IN6011001' and org_id='99'
						where report_type='1' and trxn_date='20210207' and branch_id='200' and gl_date_interval='1' and ccy_code='SUS' and gl_code='IN6011001' and org_id='99'
					glb_gl_report.insert
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'SCY', 'AS11310', 'Y', 2, 'Interest Receivable - Overdraft', 'N', 'Y', 53835442.51, 0, 1686100.89, 0.00, 55521543.40, 0, '99', '2101', '20210629 14:19:54 991', NULL, NULL, 1);
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'SUS', 'AS11310', 'Y', 2, 'Interest Receivable - Overdraft', 'N', 'Y', 38459990.05, 0, 1686100.89, 0.00, 40146090.94, 0, '99', '2101', '20210629 14:19:54 995', NULL, NULL, 1);
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'TZS', 'AS11310', 'Y', 2, 'Interest Receivable - Overdraft', 'N', 'Y', 38453388.31, 0, 1686100.89, 0.00, 40139489.20, 0, '99', '2101', '20210629 14:19:55 028', NULL, NULL, 1)
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'SUS', 'IN60110', 'Y', 2, 'Interest Income - Overdraft', 'N', 'Y', 0, 90454174.29, 0.00, 1686100.89, 0, 92140275.18, '99', '2101', '20210629 14:19:55 013', NULL, NULL, 1)
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'TZS', 'IN60110', 'Y', 2, 'Interest Income - Overdraft', 'N', 'Y', 0, 90682874.29, 0.00, 1686100.89, 0, 92368975.18, '99', '2101', '20210629 14:19:55 016', NULL, NULL, 1)
						insert into glb_gl_report(report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, end_gl_code_ind, simple_list_display_ind, prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, org_id, data_create_user, data_create_time, data_update_user, data_update_time, data_version) values ('1', '20210207', '200', '1', 'SCY', 'IN60110', 'Y', 2, 'Interest Income - Overdraft', 'N', 'Y', 0, 88125174.29, 0.00, 1686100.89, 0, 89811275.18, '99', '2101', '20210629 14:19:55 032', NULL, NULL, 1);
				}
			}
		},
		glb_exchange_rate-'折算汇率':{
			insert-2{
				1-ExchangeRate.addExchangeRateInfo(GlExchangeRate)-2:{
					ExchangeRate.getExchangeRateList(Options<GlExchangeRate>)-1:{
						SrvGlExchangeRate.modifyExchangeRateList(Options)-1:{
							gl8601
						}
					},
					SrvGlExchangeRate.addGlExchangeRate(GlExchangeRate)-'添加一条折算汇率信息';-1:{
						gl8603
					}
				},
				1-insertBatch-GlFile.doCoreExchangeRateFile()-2:{		'折算汇率文件导入'
					gl04,
					glt04
				}
			},
			nsql:{
				
			}
		},
		glb_exchange_voch:{
			insert-7:{
				2-prcExchangeIncomeToZeroByBranch(String, E_REPORTTYPE, String, String);-1:{
					prcExchangeIncomeToZero(String, E_REPORTTYPE, String)-1:{
						gl46-'年终决算折算损益科目结转上划'
					}
				},
				2-prcExchangeProfitUpSettle(String, E_REPORTTYPE, String, String, String, String, E_DEBITCREDIT, String, BigDecimal, long);-1:{
					prcExchangeProfitUpByBranch(String, E_REPORTTYPE, String, String, String, String)-0-down
				},
				2-prcExchangeProfitUpByBranch(String, E_REPORTTYPE, String, String, String, String);-1:{
					prcExchangeProfitUp(String, E_REPORTTYPE, String)-1:{
						gl46-'年终决算折算损益科目结转上划'
					}
				}
			}
			
		},
		gla_exchange_gl:{
			insert-5:{
				1-genExchangeGl(String, String, String, E_REPORTTYPE);-2:{
					gl45,
					glt45
				},
				1-prcExchangeIncomeToZeroByBranch(String, E_REPORTTYPE, String, String);-1:{
					prcExchangeIncomeToZero(String, E_REPORTTYPE, String)-1:{
						gl46-'年终决算折算损益科目结转上划'
					}
				},
				2-prcExchangeProfitUpSettle(String, E_REPORTTYPE, String, String, String, String, E_DEBITCREDIT, String, BigDecimal, long);-1:{
					prcExchangeProfitUpByBranch(String, E_REPORTTYPE, String, String, String, String)-0-down
				},
				1-prcExchangeProfitUpByBranch(String, E_REPORTTYPE, String, String, String, String);-1:{
					prcExchangeProfitUp(String, E_REPORTTYPE, String)-1:{
						gl46-'年终决算折算损益科目结转上划'
					}
				}
			}
		},
		gla_branch_gl:{
			insert-single-1:{
				GlBranch.genBranchGl(String, String, String, E_REPORTTYPE):{
					gl35,from fab_accounting_voch
					glt35
				}
			},
			delete-nsql:{
				GlBranch.delBranchGl:{
					prcBefore(String, String, String)-2:{
						gl35,
						glt35,
					}
				},
				
			}
		},
		glb_gl_report:{
			insert-4:{
				2-GlGeneralLedger.genReport(String, String, String, E_GLDATEINTERVAL, E_REPORTTYPE):{
					4- genInterval(String, String, String, E_REPORTTYPE)-1:{},
					1- genBusiGL(String, E_REPORTTYPE, String, String)-2:{
						gl51-'生成业务总账-账务机构',from gla_branch_gl-'TZS',gla_exchange_gl-'SUS''SCY'
						glt51
					}
				},
				2-gl24.process-0	
			},
			insert-batch-0,
			insert-nsql-2:{
				GlGeneralLedger.insInitReportData-1:{
					code:{
						insert into glb_gl_report from glb_gl_report a
					  JOIN fap_accounting_subject b
						ON a.gl_code = b.gl_code and a.org_id=b.org_id
						current_debit_amt=0.00,
						prev_debit_bal=a.current_debit_bal
						where a.trxn_date = #last_date#
						  AND a.org_id = #org_id#
						  AND a.gl_date_interval = '1'
						  AND a.branch_id = #branch_id#
						  AND a.report_type = '1'
						  AND a.current_debit_bal <> a.current_credit_bal
						  AND b.end_gl_code_ind = 'Y'
						  AND b.valid_ind = 'Y'
					},
					GlGeneralLedger.loadBuisGlInit(String, String, String, E_GLDATEINTERVAL, E_REPORTTYPE)-1
						GlGeneralLedger.genReport(String, String, String, E_GLDATEINTERVAL, E_REPORTTYPE)-same,
				},
				GlGeneralLedger.insReportGlData-1:{
					code:{
						insert into glb_gl_report from glb_gl_report a
						sum(a.current_credit_amt) as current_credit_amt,
    	    	    	and a.trxn_date = #trxn_date# 
					},
					GlGeneralLedger.genReportGL(String, E_REPORTTYPE, String)-2:{
						gl52-'生成业务总账-报表机构',
						glt52
					}
				}
			},
			update-single-1:{
				GlGeneralLedger.genReport(String, String, String, E_GLDATEINTERVAL, E_REPORTTYPE)
			},
			delete-nsql:{
				GlGeneralLedger.delReportGl-1:{
					GlGeneralLedger.prcBusiGlBefore(String, String, E_REPORTTYPE):{
						gl50,
						glt50
					}
				}
			}
		}
	}
},
ln:{	''
	onl:{
		ln6040-"贷款提取"-'loan drawdown':{
			ser-SrvIoLnLoanDrawdown.loanDrawdownAndCheck:{
				LnLoanDrawdownCheck.checkMain(loanDrawdownIn,false);
				return LnLoanDrawdown.loanDrawdown(loanDrawdownIn);:{	"放款处理"
					registerRateChangeStatement(drawdownIn); :{	"登记利率变更初始记录"
					}
					LnAccountingDrawdown.drawdownGl(drawdownIn);:{	"放款记账"	"记贷款账务"
						lna_accrual.advance_interest_method:{
							LnGlApi.addBalance4Drawdown(TabLnCore.lna_loan paramlna_loan, ComLnGL.LnBalanceBoxType paramLnBalanceBoxType, LnBaseEnumType.E_BALCODE paramE_BALCODE, BigDecimal paramBigDecimal)
								a.addBalance4Drawdown(paramlna_loan, paramLnBalanceBoxType, paramE_BALCODE, paramBigDecimal);
						}
					}
				}
			},
			ser-SrvIoLnLoanFund.SrvLnOpenFundEntryDeal,
			ser-SrvIoLnLoanFund.SrvLnOpenFundTransferDeal,
			ser-SrvLnMessSendToDsSimple.sendFundDataToDs,
			ser-SrvLnSendMessage.SendMessage,
			met-prepareTranFiled,
			ser-SrvApTrxn.registerApsTransaction
		}
	},
	enum:{
		LnBaseEnumType.E_BALCODE:{	"余额代码"-41
			"PRCP"/"P"-'本金',"AC"-'应计',"IT"/"I"/"T"-'利息',"IC"/"C"-'利息收入',"DU"-'到期',"O"-'罚',"C"-'复',"WOF"-'核销',"R"-'偿还',""-''
			<restrictionType id="E_BALCODE" longname="balance code" base="string" maxLength="10">	
				"本金"-''-1:{
					"PRCP"-'本金'-'principal'-'[?pr?ns?pl] 普林斯普':{
						#<enumeration id="PRCP" value="PRCP" longname="principal"/>							'本金'
					},
				},
				"还款手续费"-''-9:{
					"PYE"/"PF"-'还款手续费'-'repayment fee'-'':{               ''
						"OPYE"/"OPF"-'逾期还款费'-'overdue repayment fee'-'':{
							#<enumeration id="OPYF" value="OPYF" longname="overdue repayment fee"/>              '逾期还款费'
							#<enumeration id="OOPF" value="OOPF" longname="owe overdue repayment fee"/>          '欠缴滞纳金'
							#<enumeration id="WOPF" value="WOPF" longname="waiver overdue repayment fee"/>       '免除逾期还款费'
						},
						"PFF"-'还款失败费'-'repayment fail fee'-'':{
							#<enumeration id="RPFF" value="RPFF" longname="repayment fail fee"/>                 '还款失败费'
							#<enumeration id="OPFF" value="OPFF" longname="owe repayment fail fee"/>             '欠缴还款失败费'
							#<enumeration id="WPFF" value="OPFF" longname="waiver repayment fail fee"/>          '免除还款失败费'
						},
						"APYF"/"APF"-'提前还款费'-'advance repayment fee'-'':{
							#<enumeration id="APYF" value="APYF" longname="advance repayment fee"/>              '提前还款费'
							#<enumeration id="OAPF" value="OAPF" longname="owe advance repayment fee"/>          '欠缴提前还款费'
							#<enumeration id="WAPF" value="WAPF" longname="waiver advance repayment fee"/>       '免除提前还款费'
						}
					}
				},
				"利息"-'利罚复偿'-16:{
					"AC"-'应计'-'accrual'-'[??kru??l] 俄库鲁尔':{
						#<enumeration id="ACIT" value="ACIT" longname="accrual interest"/>                   '应计利息'
						#<enumeration id="ACIC" value="ACIC" longname="accrual interest income"/>            '应计利息收入'
						#<enumeration id="DUIT" value="DUIT" longname="due interest"/>                       '到期利息'
						#<enumeration id="DUIC" value="DUIC" longname="due interest income"/>                '到期利息收入'
					},
					"O"-'罚'-'penalty'-'[?pen?lti] 潘浓提':{
						#<enumeration id="ACOT" value="ACOT" longname="accrual penalty interest"/>           '应计罚息'
						#<enumeration id="ACOC" value="ACOC" longname="accrual penalty interest income"/>    '应计罚息收入'
						#<enumeration id="DUOT" value="DUOT" longname="due penalty interest"/>               '到期罚息'
						#<enumeration id="DUOC" value="DUOC" longname="due penalty interest income"/>        '到期罚息收入'
					},
					"C"-'复'-'compound'-'[?k?mpa?nd] 康姆庞德':{
						#<enumeration id="ACCT" value="ACCT" longname="accrual compound interest"/>          '应计复利'
						#<enumeration id="ACCC" value="ACCC" longname="accrual compound interest income"/>   '应计复利收入'
						#<enumeration id="DUCT" value="DUCT" longname="due compound interest"/>              '到期复利'
						#<enumeration id="DUCC" value="DUCC" longname="due compound interest income"/>       '到期复利收入'
					},
					"R"-'偿还'-'reimburse'-'[?ri??m?b??rs] 瑞英博思':{
						#<enumeration id="ACRT" value="ACRT" longname="accrual reimburse interest"/>         '计提偿付利息'
						#<enumeration id="ACRC" value="ACRC" longname="accrual reimburse interest income"/>  '计提偿付利息收入'
						#<enumeration id="DURT" value="DURT" longname="due reimburse interest"/>             '到期偿付利息'
						#<enumeration id="DURC" value="DURC" longname="due reimburse interest income"/>      '到期偿付利息收入'
					}
				},
				"核销"-'write-off'-2:{
					"WOF"-'核销'-'write-off'-'[?ra?t ??f] 莱特欧u':{
						#<enumeration id="WOFP" value="WOFP" longname="write-off principal"/>                '核销本金'
						#<enumeration id="WOFI" value="WOFI" longname="write-off interest"/>                 '核销利息'
					},
				},
				"准备金"-'provision'-3:{
					"PRO"-'准备金'-'provision'-'[pr??v??n] 普雷威军':{
						#<enumeration id="PROM" value="PROM" longname="manual loan provision"/>              '手动贷款准备金'
						#<enumeration id="PROA" value="PROA" longname="auto loan provision"/>                '自动贷款准备金'
						#<enumeration id="LOSS" value="LOSS" longname="loan provision loss"/>                '贷款准备金损失'
					},
				},
				"预付息"-'advance interest'-3:{
					"AT"-'预付息'-'advance interest'-'':{
						#<enumeration id="ALAT" value="ALAT" longname="already charge advance interest"/>    ''
						#<enumeration id="DUAT" value="DUAT" longname="due advance interest"/>               ''
						#<enumeration id="DUAC" value="DUAC" longname="due advance interest income"/>        ''
					},
				},
				"其他含义":{
					"DU"-'到期',
				},
				""-''-''-'':{
				},
					#<enumeration id="AMOT" value="AMOT" longname="amortization interest"/>              ''
					#<enumeration id="OPYT" value="OPYT" longname="over payment"/>                       ''
					#<enumeration id="OLDI" value="OLDI" longname="old interest"/>                       ''
				"票据利息费"-'bill interest fee'-3:{
					"BF"-'票据利息费'-'bill interest fee'-'':{
						#<enumeration id="BFRC" value="BFRC" longname="bill interest fee receivable"/>       '应收票据利息费'
						#<enumeration id="BFIC" value="BFIC" longname="bill interest fee income"/>           '票据利息费收入'
						#<enumeration id="BFWV" value="BFWV" longname="bill interest fee waiver"/>           '免收票据利息费'
					},
				},
					#<enumeration id="VAT" value="VAT" longname="Business tax to VAT"/>                  '营业税转增值税'
			</restrictionType>
		}
	}
	tables:{
		lnp_bal_attributes-"贷款余额属性定义表"-'Loan balance attributes define table':{
			values:{
					bal_attributes		bal_attributes_name									  double_entry_ind bal_code				bal_attributes_gl_name
								                                                                      debit_credit  bal_attributes_gl
				ACCC-"应计复利收入"-'accrual compound interest income':{
					99	ACCC1	Compound Interest Income Accrued(Current)								Y	C	ACCC	LNCC01	Compound Interest Income Accrued					1
					99	ACCC2	Compound Interest Income Accrued(Especially Mentioned)					Y	C	ACCC	LNCC01	Compound Interest Income Accrued					1
					99	ACCC3	Compound Interest Income Accrued(Substandard)							Y	C	ACCC	LNCC01	Compound Interest Income Accrued					1
					99	ACCC4	Compound Interest Income Accrued(Doubtful)								Y	C	ACCC	LNCC01	Compound Interest Income Accrued					1
					99	ACCC5	Compound Interest Income Accrued(LOSS)									Y	C	ACCC	LNCC01	Compound Interest Income Accrued					1
				},
				:{
					99	ACCT1	Compound Interest Receivable Accrued(Current)							N	D	ACCT	LNCA01	Compound Interest Receivable Accrued					1
					99	ACCT2	Compound Interest Receivable Accrued(Especially Mentioned)				N	D	ACCT	LNCA01	Compound Interest Receivable Accrued					1
					99	ACCT3	Compound Interest Receivable Accrued(Substandard)						N	D	ACCT	LNCA01	Compound Interest Receivable Accrued					1
					99	ACCT4	Compound Interest Receivable Accrued(Doubtful)							N	D	ACCT	LNCA01	Compound Interest Receivable Accrued					1
					99	ACCT5	Compound Interest Receivable Accrued(LOSS)								N	D	ACCT	LNCA01	Compound Interest Receivable Accrued					1
					99	ACIC1	Interest Income Accrued(Current)										Y	C	ACIC	LNIC01	Interest Income Accrued					1
					99	ACIC2	Interest Income Accrued(Especially Mentioned)							Y	C	ACIC	LNIC01	Interest Income Accrued					1
					99	ACIC3	Interest Income Accrued(Substandard)									Y	C	ACIC	LNIC01	Interest Income Accrued					1
					99	ACIC4	Interest Income Accrued(Doubtful)										Y	C	ACIC	LNIC01	Interest Income Accrued					1
					99	ACIC5	Interest Income Accrued(LOSS)											Y	C	ACIC	LNIC01	Interest Income Accrued					1
					99	ACIT1	Interest Receivable Accrued(Current)									Y	D	ACIT	LNIA01	Interest Receivable Accrued					1
					99	ACIT2	Interest Receivable Accrued(Especially Mentioned)						Y	D	ACIT	LNIA01	Interest Receivable Accrued					1
					99	ACIT3	Interest Receivable Accrued(Substandard)								Y	D	ACIT	LNIA01	Interest Receivable Accrued					1
					99	ACIT4	Interest Receivable Accrued(Doubtful)									Y	D	ACIT	LNIA01	Interest Receivable Accrued					1
					99	ACIT5	Interest Receivable Accrued(LOSS)										Y	D	ACIT	LNIA01	Interest Receivable Accrued					1
					99	ACOC1	Overdue Interest Income Accrued(Current)								Y	C	ACOC	LNOC01	Overdue Interest Income Accrued					1
					99	ACOC2	Overdue Interest Income Accrued(Especially Mentioned)					Y	C	ACOC	LNOC01	Overdue Interest Income Accrued					1
					99	ACOC3	Overdue Interest Income Accrued(Substandard)							Y	C	ACOC	LNOC01	Overdue Interest Income Accrued					1
					99	ACOC4	Overdue Interest Income Accrued(Doubtful)								Y	C	ACOC	LNOC01	Overdue Interest Income Accrued					1
					99	ACOC5	Overdue Interest Income Accrued(LOSS)									Y	C	ACOC	LNOC01	Overdue Interest Income Accrued					1
					99	ACOT1	Overdue Interest Receivable Accrued(Current)							Y	D	ACOT	LNOA01	Overdue Interest Receivable Accrued					1
					99	ACOT2	Overdue Interest Receivable Accrued(Especially Mentioned)				Y	D	ACOT	LNOA01	Overdue Interest Receivable Accrued					1
					99	ACOT3	Overdue Interest Receivable Accrued(Substandard)						Y	D	ACOT	LNOA01	Overdue Interest Receivable Accrued					1
					99	ACOT4	Overdue Interest Receivable Accrued(Doubtful)							Y	D	ACOT	LNOA01	Overdue Interest Receivable Accrued					1
					99	ACOT5	Overdue Interest Receivable Accrued(LOSS)								Y	D	ACOT	LNOA01	Overdue Interest Receivable Accrued					1
					99	ACRC	Subsidy Interest Income Accrued											Y	C	ACRC	LNRC01	(应计)贴息收入					1
					99	ACRT	Subsidy Interest Receivable Accrued										Y	D	ACRT	LNRA01	应计贴息					1
					99	AMOT	Deferred Interest														Y	C	AMOT	LNIU01	待摊利息					1
					99	DUCC1	Compound Interest Income(Current)										Y	C	DUCC	LNCC01	Compound Interest Income					1
					99	DUCC2	Compound Interest Income(Especially Mentioned)							Y	C	DUCC	LNCC01	Compound Interest Income					1
					99	DUCC3	Compound Interest Income(Substandard)									Y	C	DUCC	LNCC01	Compound Interest Income					1
					99	DUCC4	Compound Interest Income(Doubtful)										Y	C	DUCC	LNCC01	Compound Interest Income					1
					99	DUCC5	Compound Interest Income(LOSS)											Y	C	DUCC	LNCC01	Compound Interest Income					1
					99	DUCT1	Compound Interest Receivable(Current)									N	D	DUCT	LNCD01	Compound Interest Receivable					1
					99	DUCT2	Compound Interest Receivable(Especially Mentioned)						N	D	DUCT	LNCD01	Compound Interest Receivable					1
					99	DUCT3	Compound Interest Receivable(Substandard)								N	D	DUCT	LNCD01	Compound Interest Receivable					1
					99	DUCT4	Compound Interest Receivable(Doubtful)									N	D	DUCT	LNCD01	Compound Interest Receivable					1
					99	DUCT5	Compound Interest Receivable(LOSS)										N	D	DUCT	LNCD01	Compound Interest Receivable					1
					99	DUIC1	Interest Income(Current)												Y	C	DUIC	LNIC01	Interest Income					1
					99	DUIC2	Interest Income(Especially Mentioned)									Y	C	DUIC	LNIC01	Interest Income					1
					99	DUIC3	Interest Income(Substandard)											Y	C	DUIC	LNIC01	Interest Income					1
					99	DUIC4	Interest Income(Doubtful)												Y	C	DUIC	LNIC01	Interest Income					1
					99	DUIC5	Interest Income(LOSS)													Y	C	DUIC	LNIC01	Interest Income					1
					99	DUIT1	Interest Receivable(Current)											Y	D	DUIT	LNID01	Interest Receivable					1
					99	DUIT2	Interest Receivable(Especially Mentioned)								Y	D	DUIT	LNID01	Interest Receivable					1
					99	DUIT3	Interest ReceivableSubstandard)											Y	D	DUIT	LNID01	Interest Receivable					1
					99	DUIT4	Interest Receivable(Doubtful)											Y	D	DUIT	LNID01	Interest Receivable					1
					99	DUIT5	Interest Receivable(LOSS)												Y	D	DUIT	LNID01	Interest Receivable					1
					99	DUOC1	Overdue Interest Income(Current)										Y	C	DUOC	LNOC01	Overdue Interest Income					1
					99	DUOC2	Overdue Interest Income(Especially Mentioned)							Y	C	DUOC	LNOC01	Overdue Interest Income					1
					99	DUOC3	Overdue Interest Income(Substandard)									Y	C	DUOC	LNOC01	Overdue Interest Income					1
					99	DUOC4	Overdue Interest Income(Doubtful)										Y	C	DUOC	LNOC01	Overdue Interest Income					1
					99	DUOC5	Overdue Interest Income(LOSS)											Y	C	DUOC	LNOC01	Mortgage Loan of non-Resident					1
					99	DUOT1	Overdue Interest Receivable(Current)									Y	D	DUOT	LNOD01	Overdue Interest Receivable					1
					99	DUOT2	Overdue Interest Receivable(Especially Mentioned)						Y	D	DUOT	LNOD01	Overdue Interest Receivable					1
					99	DUOT3	Overdue Interest Receivable(Substandard)								Y	D	DUOT	LNOD01	Overdue Interest Receivable					1
					99	DUOT4	Overdue Interest Receivable(Doubtful)									Y	D	DUOT	LNOD01	Overdue Interest Receivable					1
					99	DUOT5	Overdue Interest Receivable(LOSS)										Y	D	DUOT	LNOD01	Overdue Interest Receivable					1
					99	DURC	Subsidy Interest Income													Y	C	DURC	LNRC01	(应收)贴息收入					1
					99	DURT	Subsidy Interest Receivable												Y	D	DURT	LNRD01	应收贴息					1
					99	LOSI	Bad Debts Written Off-Interest											Y	D	LOSI	LNLI01	贷款损失利息					1
					99	LOSP	Bad Debts Written Off-Principal											Y	D	LOSP	LNLP01	贷款损失本金					1
					99	LOSS1	Loss on Loan(Normal)													Y	D	LOSS	LNLS01	贷款减值损失					1
					99	LOSS2	Loss on Loan(Overdue)													Y	D	LOSS	LNLS02	贷款减值损失					1
				},
				PRCP-"本金"-'principal':{
					99	PRCP1	Principle(Current)	当前本金?											Y	D	PRCP	LNPR01	Principle					1
					99	PRCP2	Principle(Especially Mentioned)	特别提到								Y	D	PRCP	LNPR01	Principle					1
					99	PRCP3	Principle(Substandard)	不标准的										Y	D	PRCP	LNPR01	Principle					1
					99	PRCP4	Principle(Doubtful)	可疑												Y	D	PRCP	LNPR01	Principle					1
					99	PRCP5	Principle(LOSS)	丢失													Y	D	PRCP	LNPR01	Principle					1
				},
				:{
					99	PROA1	Auto Provision on Loan(Normal)											Y	C	PROA	LNPV01	一般减值准备金					1
					99	PROA2	Auto Provision on Loan(Overdue)											Y	C	PROA	LNPV02	特殊减值准备金					1
					99	PROM1	Manual Provision on Loan(Normal)										Y	C	PROM	LNPV01	一般减值准备金					1
					99	PROM2	Manual Provision on Loan(Overdue)										Y	C	PROM	LNPV02	特殊减值准备金					1
					99	WOFI	Written-Off Interest													N	D	WOFI	LNWI01	核销利息					1
					99	WOFP	Written-Off Principle													N	D	WOFP	LNWP01	核销本金					1
				}
			}
		},
		lna_balance:{
			insert-1:{
				LnBalance.updateBalanceSingle(String, LnLoanGLType, boolean)-1:{
					updateLoanBalanceInner(LnBalanceGLType, boolean);-1:{
						updateLoanBalance(LnBalanceGLType)-3:{
							LnAccounting.loanAccounting(String, LnBalanceGLType)-1:{
								loanAccounting(LnBalanceGLType)-13:{
									LnAccountingWriteOff.writeOffGl(String, LnBalanceGLType)
								}
							},
							LnAccounting.balanceUpdateAndRegister(LnBalanceGLType)
							LnAccountingAccrual.accrual(LnBalanceGLType, String)-2:{
								LnAccrual.singleLoanInterestCalculation(String, String)
								LnAccrual.ExtendInterestCalculation(String, String, lna_repayment_schedule)
							}
						}
					}
				}
			},
			columns:{
				
			}
		},
		lna_accrual:{
			value:{
				
			},
			columns:{
				advance_interest_method:{	'LnSysEnumType.E_ADVINTMETHOD'	"预收利息法"
					<restrictionType id="E_ADVINTMETHOD" longname="advance collect interest method" base="string" maxLength="10">
						<enumeration id="NO" value="NO" longname="no advance collection"/>	'无预收息'
						<enumeration id="PRINCIPAL" value="PRINCIPAL" longname="pricipal deducting interest"/>	'本金扣除利息'
						<enumeration id="TOTAL" value="TOTAL" longname="total amount deducting interest"/> '总金额扣息'
					</restrictionType>
				}
			}
		},
		template:{
			value:{
				
			},
			columns:{
				col_name:{	'EnumFile.EnumId'
				
				}
			}
		}
	}
}
obiee:{
	RPT_AC_BAL_LCY_FCY-'各科目余额表':{
		2.1-'LCY'  AS CCY,'1-End of Day' AS REPORT_TYPE-'业务类型'	:{
			,t1.gl_code_type                    AS CATEGORY              -- 科目类别
			${iol_schema}.gls_fap_accounting_subject t1 left join ${icl_schema}.gl_bal_sum t2 on t1.gl_code = t2.subj_id
			
			t2.term_begin_debit_bal		AS OPEN_DEBIT_BAL  '期初借方余额',
			t2.term_begin_crdt_bal		AS OPEN_CREDIT_BAL	'期初贷方余额',
			t2.th_term_debit_evt_amt	AS DEBIT_MOV		'本期借方发生额',
			t2.th_term_crdt_evt_amt		AS CREDIT_MOV		'本期贷方发生额',
			t2.term_end_debit_bal		AS DEBIT_BAL		'期末借方余额',
			t2.term_end_crdt_bal		AS CREDIT_BAL		'期末贷方余额',
			"gl_bal_sum":{
					 ,sum(term_begin_debit_bal)  AS term_begin_debit_bal  -- 期初借方余额
					 ,sum(term_begin_crdt_bal)   AS term_begin_crdt_bal   -- 期初贷方余额
					 ,sum(th_term_debit_evt_amt) AS th_term_debit_evt_amt -- 本期借方发生额
					 ,sum(th_term_crdt_evt_amt)  AS th_term_crdt_evt_amt  -- 本期贷方发生额
					 ,sum(term_end_debit_bal)    AS term_end_debit_bal    -- 期末借方余额
					 ,sum(term_end_crdt_bal)     AS term_end_crdt_bal     -- 期末贷方余额
			   from ${icl_schema}.gl_bal_sum                              -- 总账表处理后模型
			   where  org_id = '000' and curr_cd = 'TZS'  and report_type = '1'
			   -- 只取总行记录
			   -- 只取坦先令的记录
			   -- 只取业务类型数据
		   }
		},
		2.2-'FCY' AS CCY,'1-End of Day' AS REPORT_TYPE-'业务类型'	:{
            t4.term_begin_debit_bal	AS OPEN_DEBIT_BAL       '期初借方余额  '
            t4.term_begin_crdt_bal	AS OPEN_CREDIT_BAL      '期初贷方余额  '
            t4.th_term_debit_evt_amt	AS DEBIT_MOV        '本期借方发生额'
            t4.th_term_crdt_evt_amt	AS CREDIT_MOV           '本期贷方发生额'
            t4.term_end_debit_bal	AS DEBIT_BAL            '期末借方余额  '
            t4.term_end_crdt_bal	AS CREDIT_BAL           '期末贷方余额  '
			"gl_bal_sum" t2,"gls_glb_exchange_rate" t3:{
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.term_begin_debit_bal * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS term_begin_debit_bal  -- 期初借方余额
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.term_begin_crdt_bal * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS term_begin_crdt_bal   -- 期初贷方余额
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.th_term_debit_evt_amt * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS th_term_debit_evt_amt -- 本期借方发生额
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.th_term_crdt_evt_amt * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS th_term_crdt_evt_amt  -- 本期贷方发生额
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.term_end_debit_bal * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS term_end_debit_bal    -- 期末借方余额
                  ,sum(case when t3.exchange_rate_unit = 0 then 0
                            else t2.term_end_crdt_bal * t3.exchange_rate / t3.exchange_rate_unit
                             end)         AS term_end_crdt_bal     -- 期末贷方余额
					 from ${icl_schema}.gl_bal_sum t2                      -- 总账表处理后模型
				left join ${iol_schema}.gls_glb_exchange_rate t3           -- 折算汇率（外管每日中间价）表
					   on t2.curr_cd = t3.ccy_code
					  and t3.exchange_ccy_code = 'SCY'                     -- 取外币与本币兑换汇率记录
			}
            where t2.org_id = '000'                                -- 只取总行记录
              and t2.curr_cd not in ('TZS','SCY','SUS')            -- 过滤非国标币种代码和坦先令代码的记录
              and t2.report_type = '1'                             -- 只取业务类型数据
		}
		2.3-			 '2-End of Year' AS REPORT_TYPE-'年结类型':{
			
		},
		2.4-'插入外币年结数据'			 '2-End of Year' AS REPORT_TYPE-'年结类型':{
			
		}
	}
	gl_bal_sum-'iol':{
		'取当前余额'：
		create table ${icl_schema}.gl_bal_sum_temp04
       ,t1.prev_debit_bal                   as term_begin_debit_bal
       ,t1.current_debit_amt                as th_term_debit_evt_amt
	   from ${iol_schema}.GLS_GLB_GL_REPORT t1 
		${icl_schema}.gl_bal_sum_temp05-'合并数据'：{
			create table ${icl_schema}.gl_bal_sum_temp05
			,t4.term_begin_debit_bal
		   ,t4.th_term_debit_evt_amt
			from   ${icl_schema}.gl_bal_sum_temp04   t4
		},
		${icl_schema}.gl_bal_sum_temp06-''：{
			create table ${icl_schema}.gl_bal_sum_temp06
			,t5.term_begin_debit_bal
		   ,t5.th_term_debit_evt_amt
			from ${icl_schema}.gl_bal_sum_temp05   t5
		},
		${icl_schema}.gl_bal_sum_temp07-''：{
			create table ${icl_schema}.gl_bal_sum_temp07
			,t6.term_begin_debit_bal
		   ,t6.th_term_debit_evt_amt
			from ${icl_schema}.gl_bal_sum_temp06 t6 
		},
		${icl_schema}.gl_bal_sum-'分机构数据'：{
			insert into  ${icl_schema}.gl_bal_sum         
			,term_begin_debit_bal                               --期初借方余额         
			,th_term_debit_evt_amt                              --本期借方发生额 
			from ${icl_schema}.gl_bal_sum_temp07
		}
	},
	GLS_GLB_GL_REPORT-'iol':{
			 ${iol_schema}.GLS_GLB_GL_REPORT，
		from ${itl_schema}.gls_glb_gl_report
		from ${itl_schema}.gls_glb_gl_report_et
		create table ${itl_schema}.gls_glb_gl_report_et from gls_glb_gl_report_dr
		create or replace directory gls_glb_gl_report_dr as '/data/input/${batch_date}/gls/';
			gls_glb_gl_report_dr:'gls_glb_gl_report_i.${batch_date}.dat'
	},
	GLB_GL_REPORT-'gl':{
		
	},
	idl_rpt_loan_list-'欠款账户金额信息表':{
		3.1:{
			${iol_schema}.cbs_lna_loan t1,
		},
		3.2-'插入对公数据':{
			${idl_schema}.rpt_loan_list,
		},
		3.3-'插入对私存款账户透支数据':{
			${iol_schema}.cbs_dpa_sub_account t1
		},
		3.4-'插入对公存款账户透支数据':{
			${iol_schema}.cbs_dpa_sub_account t1  
			inner join ${iol_schema}.cbs_cfb_corpor_base t2 
				,(case when t10.accrual_inst is null
					   then 0
					   else t10.accrual_inst
						end) * (case when t1.ccy_code = 'TZS'
									 then 1
									 when t8.exchange_rate is null
									   or t8.exchange_rate_unit is null
									   or t8.exchange_rate_unit = 0
									 then 0
									 else t8.exchange_rate / t8.exchange_rate_unit
									  end)             as accru_intere              --应收利息
			left join ${iol_schema}.cbs_dpa_fiche_interest t10                      --账户计息定义表
				   on t1.sub_acct_no = t10.sub_acct_no
				  and t10.fiche_type = 'B'
				  and t10.accrual_inst > 0
		}
		
	}
}


bat-define:{
	0-icore-day:{
													FARENDMA	BUZHOUHA
		PLJIOYMA	PLJYZWMC				XITONGBS	PLJYZBSH	PLJIOYMA	PLJYZWMC				ZHIXBZHI	YLPLJYLB	JYYXXKTJ	CHLCISHU	SHBZHDBZ	SHIWTJJG	SHUJCFMS	SHUJCFZJ	PLZYZXMS	ZUIDZYBF	RIZHIJIB	ZUOYCFTJ	PLJYYXMS	NGFTIAOG	SFWENJPL	JIAOYILX
												'法人代码'	 '步骤号'
		'批量交易码'	'批量交易ZW描述'	'系统标识'	'批量交易ZBSH' '批量交易码'	'批量交易ZW描述'
		810:{
			ct01	机构关机检查					CBS	99	810	4	ct01	机构关机检查					0			0	1	1	9		0	0	3		0	1	0	
			st02	到期自俞放票浮宇~			CBS	99	810	5	st02	到期自俞放票浮宇~			1			0	1	1	9		0		3		0	0	0	
			ln01	J款欠款收取(日末)				CBS	99	810	10	ln01	J款欠款收取(日末)				1			0	1	1	1		1		3		0	0	0	
			cm01	欠M收取(日末)					CBS	99	810	20	cm01	欠M收取(日末)					1			0	1	1	1		1		3		0	0	0	
			cf05	更新人C件、KYCY			CBS	99	810	30	cf05	更新人C件、KYCY			1			0	1	1	1		1	0	3		0	0	0	
			cf06	更新公司C件、KYCY			CBS	99	810	40	cf06	更新公司C件、KYCY			1			0	1	1	1		1	0	3		0	0	0	
			cf07	更新同IC件、KYCY			CBS	99	810	50	cf07	更新同IC件、KYCY			1			0	1	1	1		1	0	3		0	0	0	
			st05	同城票据内部户与同业账号的清算	CBS	99	810	60	st05	同城票据内部户与同业账号的清算	1			0	1	1	1		0		3		0	0	0	
			ag16	DSF签约信息返回给财政局			CBS	99	810	61	ag16	DSF签约信息返回给财政局			1			0	1	1	1		0		3		0	0	0	
			dp13	额度调整对应超额占用调整		CBS	99	810	70	dp13	额度调整对应超额占用调整		1			0	1	500	1		1		3		0	0	0	
			dp11	定期到期m存					CBS	99	810	90	dp11	定期到期m存i					1			0	1	1	1		1		3		0	0	0	
			dp33	账户基本信息上传				CBS	99	810	100	dp33	账户基本信息上传				1			0	1	1	1		2	0	3		0	0	0	
			cf02	写客户基础信息					CBS	99	810	110	cf02	写客户基础信息					1			0	1	1	1		2		3		0	0	0	
			cf03	写客户证件信息					CBS	99	810	115	cf03	写客户证件信息					1			0	1	1	1		2		3		0	0	0	
			cf04	写客户雇主信息					CBS	99	810	120	cf04	写客户雇主信息					1			0	1	1	1		2		3		0	0	0	
			cf01	写客户黑名单信息				CBS	99	810	125	cf01	写客户黑名单信息				1			0	1	1	1		2		3		0	0	0	
			cf10	客户资料上传					CBS	99	810	730	cf10	客户资料上传					1			0	1	1	1		2		3		0	0	0	
			cf11	客户资料上传					CBS	99	810	740	cf11	客户资料上传					1			0	1	1	1		2		3		0	0	0	
			ag07	代理批量Rs信息			CBS	99	810	757	ag07	代理批量Rs信息			1			0	1	1	9		0		3		0	0	0	
			ag09	收M文件理				CBS	99	810	759	ag09	收M文件理				1			0	1	1	9		0		3		0	0	0	
			ag08	Fss生成蟊						CBS	99	810	760	ag08	Fss生成蟊						1			0	1	1	9		0		3		0	0	0	
			ag15	Fss福利金生成蟊				CBS	99	810	780	ag15	Fss福利金生成蟊				1			0	1	1	9		0		3		0	0	0	
		},
		820:{
			ap05	核心日切						CBS	99	820	10	ap05	核心日切						1			0	1	1	9		0		3		0	0	0	
		},
		830:{
			cl01	~度到期理					CBS	99	830	80	cl01	~度到期理					1			0	1	1	9		0		3		0	0	0	
			cl03	~度H可用N~更新			CBS	99	830	84	cl03	~度H可用N~更新			1			0	1	1	9		0		3		0	0	0	
			co01	押品u估比例更新				CBS	99	830	86	co01	押品u估比例更新				1			0	1	1	9		0		3		0	0	0	
			cl04	~度未分押品金~更新			CBS	99	830	88	cl04	~度未分押品金~更新			1			0	1	1	9		0		3		0	0	0	
			dp02	鼋Y到期解除					CBS	99	830	100	dp02	鼋Y到期解除					1			0	1	1	1		1		3		0	0	0	
			dp01	存款利息利率理				CBS	99	830	110	dp01	存款利息利率理				1			0	1	50	1		1		3		0	0	0	
			dp07	存款透支Y息					CBS	99	830	115	dp07	存款透支Y息					1			0	1	50	1		0		3		0	0	0	
			ln05	全~放款款方式D			CBS	99	830	120	ln05	全~放款款方式D			1			0	1	1	1		1		3		0	0	0	
			ln21	J款利率{整					CBS	99	830	123	ln21	J款利率{整					1			0	1	50	1		1		3		0	0	0	
			ln09	J款息						CBS	99	830	125	ln09	J款息						1			0	1	50	1		1		3		0	0	0	
			ln04	J款利息N					CBS	99	830	130	ln04	J款利息N					1			0	1	1	1		1		3		0	0	0	
			ln23	J款假日更新表			CBS	99	830	131	ln23	J款假日更新表			1		runcondition	0	1	50	1		1		3		0	0	0	
			ln16	J款款更				CBS	99	830	133	ln16	J款款更				1			0	1	1	1		1		3		0	0	0	
			ln12	借信息更新					CBS	99	830	135	ln12	借信息更新					1			0	1	50	1		1		3		0	0	0	
			ln13	J款M用收取					CBS	99	830	137	ln13	J款M用收取					1			0	1	50	1		1		3		0	0	0	
			ln08	J款形BD移					CBS	99	830	140	ln08	J款形BD移					1			0	1	1	1		1		3		0	0	0	
			ln14	J款p值浣鹩算				CBS	99	830	150	ln14	J款p值浣鹩算				1			0	1	50	1		0		3		0	0	0	
			ln06	J款展期						CBS	99	830	160	ln06	J款展期						1			0	1	1	1		1		3		0	0	0	
			cm04	{C焓ё咏				CBS	99	830	210	cm04	{C焓ё咏				1			0	1	1	1		1		3		0	0	0	
			cm02	M用N						CBS	99	830	220	cm02	M用N						1			0	1	1	1		4		3		0	0	0	
			dp12	定期到期理					CBS	99	830	320	dp12	定期到期理					1			0	1	1	1		1		3		0	0	0	
			dpr01	自永m存蟊					CBS	99	830	330	dpr01	自永m存蟊					1			0	1	1	1		0		3		0	0	0	
			dp44	月结单生成						CBS	99	830	340	dp44	月结单生成						1			0	1	1	1		0	0	3		0	0	0	
			ln11	J款Y息						CBS	99	830	410	ln11	J款Y息						1			0	1	1	1		1		3		0	0	0	
			ln22	J款自臃趴					CBS	99	830	420	ln22	J款自臃趴					1			0	1	1	1		1		3		0	0	0	
			ln24	J款受支付自又Ц			CBS	99	830	430	ln24	J款受支付自又Ц			1			0	1	1	1		1		3		0	0	0	
			ln01	J款欠款收取(日初)				CBS	99	830	450	ln01	J款欠款收取(日初)				1			0	1	1	1		1		3		0	0	0	
			ln02	批量N息w					CBS	99	830	460	ln02	批量N息w					1			0	1	1	9		0		3		0	0	0	
			ln03	批量|押J					CBS	99	830	470	ln03	批量|押J					1			0	1	1	1		1		3		0	0	0	
			ln07	客粜刨J信息更新				CBS	99	830	495	ln07	客粜刨J信息更新				1			0	1	50	1		0		3		0	0	0	
			ln17	自动还款邮件登记				CBS	99	830	497	ln17	自动还款邮件登记				1			0	1	1	1		0		3		0	0	0	
			ln18	贷款到期提醒短信发送			CBS	99	830	498	ln18	贷款到期提醒短信发送			1			0	1	1	9		0		3		0	0	0	
			cm01	欠M收取(日初)					CBS	99	830	500	cm01	欠M收取(日初)					1			0	1	1	1		1		3		0	0	0	
			dp21	正常艮D不					CBS	99	830	510	dp21	正常艮D不					1			0	1	1	1		1		3		0	0	0	
			dp10	零整m存						CBS	99	830	560	dp10	零整m存						1			0	1	1	1		1		3		0	0	0	
			dp32	定期自动存入					CBS	99	830	570	dp32	定期自动存入					1			0	1	1	1		1		3		0	0	0	
			dp04	存款提R				CBS	99	830	610	dp04	存款提R				1			0	1	1	9		0		3		0	0	0	
			dp14	透支						CBS	99	830	615	dp14	透支						1			0	1	1	9		0		3		0	0	0	
			ln10	J款利息提R				CBS	99	830	620	ln10	J款利息提R				1			0	1	1	9		0		3		0	0	0	
			ln15	J款p值浣鹩提登			CBS	99	830	630	ln15	J款p值浣鹩提登			1			0	1	1	9		0		3		0	0	0	
			taa7	生成炔抠~v史N~			CBS	99	830	720	taa7	生成炔抠~v史N~			1			0	1	1	1		1		3		0	0	0	
			taa9	炔抠~羯先震N~R			CBS	99	830	810	taa9	炔抠~羯先震N~R			1			0	1	1	1		1		3		0	0	0	
			cm03	空白{C上日N~R			CBS	99	830	820	cm03	空白{C上日N~R			1			0	1	1	1		1		3		0	0	0	
			cm05	F金台~上日N~R			CBS	99	830	830	cm05	F金台~上日N~R			1			0	1	1	1		1		3		0	0	0	
			dp05	存款台~上日N~R			CBS	99	830	840	dp05	存款台~上日N~R			1			0	1	1	9		0		3		0	0	0	
			ln29	J款台~上日N~R			CBS	99	830	850	ln29	J款台~上日N~R			1			0	1	1	9		0		3		0	0	0	
			co29	押品台~上日N~R			CBS	99	830	855	co29	押品台~上日N~R			1			0	1	1	9		0		3		0	0	0	
			fx01	生成外R交易文件				CBS	99	830	860	fx01	生成外R交易文件				1			0	1	1	1		0		3		0	0	0	
			tab5	分核z查					CBS	99	830	905	tab5	分核z查					1			0	1	1	9		0		3		0	0	0	
			taf02	核心提文件				CBS	99	830	910	taf02	核心提文件				1			0	1	1	9		0		3		0	0	0	
			taf03	核心台~上日N~文件			CBS	99	830	920	taf03	核心台~上日N~文件			1			0	1	1	9		0		3		0	0	0	
			taf04	核心R率文件					CBS	99	830	925	taf04	核心R率文件					1			0	1	1	9		0		3		0	0	0	
			tab7	核心~文件				CBS	99	830	930	tab7	核心~文件				1			0	1	1	9		0		3		0	0	0	
			taa3	p益性|炔抠~羟辶(年初)		CBS	99	830	935	taa3	p益性|炔抠~羟辶(年初)		1			0	1	1	1		1		3		0	0	0	
			dp27	a品失效z查					CBS	99	830	940	dp27	a品失效z查					1			0	1	1	9		0		3		0	0	0	
			ap99	Bm跑批理					CBS	99	830	1000 ap99	Bm跑批理					1			0	1	1	9		0		3		0	0	0	
		}
	},
	1-gl-year:{
													FARENDMA	BUZHOUHA
		PLJIOYMA	PLJYZWMC				XITONGBS	PLJYZBSH	PLJIOYMA	PLJYZWMC				ZHIXBZHI	YLPLJYLB	JYYXXKTJ	CHLCISHU	SHBZHDBZ	SHIWTJJG	SHUJCFMS	SHUJCFZJ	PLZYZXMS	ZUIDZYBF	RIZHIJIB	ZUOYCFTJ	PLJYYXMS	NGFTIAOG	SFWENJPL	JIAOYILX
												'法人代码'	 '步骤号'
		'批量交易码'	'批量交易ZW描述'	'系统标识'	'批量交易ZBSH' '批量交易码'	'批量交易ZW描述'
		940-~年K算:{
			glt00	财务系统发生额导入				GL	99	940	3	glt00	财务系统发生额导入				1			1	1	1	9		0	0	3		0	0	0	
			glt01	财务系统余额导入				GL	99	940	6	glt01	财务系统余额导入				1			1	1	1	9		0	0	3		0	0	0	
			glt02	提n入					GL	99	940	10	glt02	提n入					1			1	1	1	9		0		3		0	0	0	
			glt03	核心分户账余额数据文件导入		GL	99	940	12	glt03	核心分户账余额数据文件导入		1			1	1	1	9		0	0	3		0	0	0	
			glt06	对账文件导入及检查				GL	99	940	14	glt06	对账文件导入及检查				1			1	1	1	9		0	0	3		0	0	0	
			glt08	试算前检查						GL	99	940	16	glt08	试算前检查						1			1	1	1	9		0	0	3		0	0	0	
			glt15	存款差~提					GL	99	940	20	glt15	存款差~提					1			1	1	1	9		0		3		0	0	0	
			glt16	J款差~提					GL	99	940	30	glt16	J款差~提					1			1	1	1	9		0		3		0	0	0	
			glt17	J款p失洳铑~提			GL	99	940	40	glt17	J款p失洳铑~提			1			1	1	1	9		0		3		0	0	0	
			glt18	收付利息t字a提			GL	99	940	50	glt18	收付利息t字a提			1			1	1	1	9		0		3		0	0	0	
			glt20	总分核对						GL	99	940	55	glt20	总分核对						1			1	1	1	9		0	0	3		0	0	0	
			gl21	年末外币损益科目兑换			GL	99	940	56	gl21	年末外币损益科目兑换			1			1	1	1	9		4		3		0	0	0	
					系统上线日余额处理		                                 系统上线日余额处理
			gl22	年末外币损益科目兑换			GL	99	940	57	gl22	年末外币损益科目兑换			1			1	1	1	9		4		3		0	0	0	
			glt23	年末试算汇兑损益处理			GL	99	940	58	glt23	年末试算汇兑损益处理			1			1	1	1	9		0		3		0	0	0	
			glt30	生成~前y一清算				GL	99	940	60	glt30	生成~前y一清算				1			1	1	1	9		0		3		0	0	0	
			glt35	生成C~					GL	99	940	70	glt35	生成C~					1			1	1	1	9		0		3		0	0	0	
			glt40	生成折{C					GL	99	940	80	glt40	生成折{C					1			1	1	1	9		0		3		0	0	0	
			glt41	折潘挝迦胝`差a平			GL	99	940	90	glt41	折潘挝迦胝`差a平			1			1	1	1	9		0		3		0	0	0	
			glt45	生成折趴~					GL	99	940	100	glt45	生成折趴~					1			1	1	1	9		0		3		0	0	0	
			glt50	I湛~生成前理				GL	99	940	110	glt50	I湛~生成前理				1			1	1	1	9		0		3		0	0	0	
			glt51	生成I湛~-~C			GL	99	940	120	glt51	生成I湛~-~C			1			1	1	1	9		0		3		0	0	0	
			glt52	生成I湛~-蟊C			GL	99	940	130	glt52	生成I湛~-蟊C			1			1	1	1	9		0		3		0	0	0	
			glt55	生成三大蟊-~C		GL	99	940	140	glt55	生成三大蟊-~C		0			1	1	1	9		0		3		0	0	0	
			glt56	生成三大蟊-蟊C		GL	99	940	150	glt56	生成三大蟊-蟊C		0			1	1	1	9		0		3		0	0	0	
			gl85	~蟊砩成（Ya表）		GL	99	940	160	gl85	~蟊砩成（Ya表）		0			1	1	1	9		0		3		0	0	0	
			gl86	~蟊砩成					GL	99	940	170	gl86	~蟊砩成					0			1	1	1	9		0		3		0	0	0	
					（表缺硗IIr表）                                   （表缺硗IIr表）
			gl87	~蟊砩成（p益明表）		GL	99	940	180	gl87	~蟊砩成（p益明表）		0			1	1	1	9		0		3		0	0	0	
			gl88	表IIr表					GL	99	940	190	gl88	表IIr表					0			1	1	1	9		0		3		0	0	0	
			gl89	表外IIr表					GL	99	940	200	gl89	表外IIr表					0			1	1	1	9		0		3		0	0	0	
			gl90	折算^程表						GL	99	940	210	gl90	折算^程表						0			1	1	1	9		0		3		0	0	0	
		}
	},
	2-gl-day:{		
													FARENDMA	BUZHOUHA
		PLJIOYMA	PLJYZWMC				XITONGBS	PLJYZBSH	PLJIOYMA	PLJYZWMC				ZHIXBZHI	YLPLJYLB	JYYXXKTJ	CHLCISHU	SHBZHDBZ	SHIWTJJG	SHUJCFMS	SHUJCFZJ	PLZYZXMS	ZUIDZYBF	RIZHIJIB	ZUOYCFTJ	PLJYYXMS	NGFTIAOG	SFWENJPL	JIAOYILX
												'法人代码'	 '步骤号'
		'批量交易码'	'批量交易ZW描述'	'系统标识'	'批量交易ZBSH' '批量交易码'	'批量交易ZW描述'
		900-~日Kz查:{
			gl00	发生额文件导入及记账			GL	99	900	5	gl00	发生额文件导入及记账			0			1	1	1	9		0		3		0	0	0	
			gl01	余额汇总文件导入及对账			GL	99	900	6	gl01	余额汇总文件导入及对账			0			1	1	1	9		0		3		0	0	0	
			gl02	提n入					GL	99	900	10	gl02	提n入					1			1	1	1	9		0		3		0	0	0	
			gl03	分N~核α魉n入		GL	99	900	20	gl03	分N~核α魉n入		1			1	1	1	9		0		3		0	0	0	
			gl04	R率n入					GL	99	900	30	gl04	R率n入					0			1	1	1	9		0		3		0	0	0	
			gl06	~n入及z查				GL	99	900	40	gl06	~n入及z查				0			1	1	1	9		0		3		0	0	0	
			gl08	GL EOD before check				GL	99	900	50	gl08	GL EOD before check				1			1	1	1	9		0		3		0	0	0	
		},
		910-~日K日切前理:{
			gl10	P]~系y					GL	99	910	60	gl10	P]~系y					1			1	1	1	9		0		3		0	0	0	
			gl15	存款差~提					GL	99	910	70	gl15	存款差~提					1			1	1	1	9		0		3		0	0	0	
			gl16	J款差~提					GL	99	910	80	gl16	J款差~提					1			1	1	1	9		0		3		0	0	0	
			gl17	J款p失洳铑~提			GL	99	910	90	gl17	J款p失洳铑~提			1			1	1	1	9		0		3		0	0	0	
			gl18	收付利息t字a提			GL	99	910	100	gl18	收付利息t字a提			1			1	1	1	9		0		3		0	0	0	
			gl20	分N~核					GL	99	910	110	gl20	分N~核					0			1	1	1	9		0		3		0	1	0	
			gl23	汇兑损益						GL	99	910	115	gl23	汇兑损益						1			1	1	1	9		0	0	3		0	1	0	
			gl25	p益YD						GL	99	910	120	gl25	p益YD						1			1	1	1	9		0		3		0	0	0	
			gl26	利D						GL	99	910	130	gl26	利D						1			1	1	1	9		0		3		0	0	0	
			gl27	外系统本年利润转总账系统		GL	99	910	132	gl27	外系统本年利润转总账系统		1			1	1	1	9		0	0	3		0	0	0	
			gl28	本年利润转未分配利润			GL	99	910	135	gl28	本年利润转未分配利润			1			1	1	1	9		0	0	3		0	0	0	
			gl29	未分配利润外币折本				GL	99	910	138	gl29	未分配利润外币折本				0			1	1	1	9		0	0	3		0	0	0	
			gl30	生成~前y一清算				GL	99	910	140	gl30	生成~前y一清算				1			1	1	1	9		0		3		0	0	0	
			gl35	生成C~					GL	99	910	150	gl35	生成C~					1			1	1	1	9		0		3		0	0	0	
			gl40	生成折{C					GL	99	910	160	gl40	生成折{C					1			1	1	1	9		0		3		0	0	0	
			gl41	折潘挝迦胝`差a平			GL	99	910	170	gl41	折潘挝迦胝`差a平			1			1	1	1	9		0		3		0	0	0	
			gl45	生成折趴~					GL	99	910	180	gl45	生成折趴~					1			1	1	1	9		0		3		0	0	0	
			gl46	年KQ算折算p益科目YD上	GL	99	910	190	gl46	年KQ算折算p益科目YD上	1			1	1	1	9		0		3		0	0	0	
			gl50	I湛~生成前理				GL	99	910	200	gl50	I湛~生成前理				1			1	1	1	9		0		3		0	0	0	
			gl51	生成I湛~-~C			GL	99	910	210	gl51	生成I湛~-~C			1			1	1	1	9		0		3		0	0	0	
			gl52	生成I湛~-蟊C			GL	99	910	220	gl52	生成I湛~-蟊C			1			1	1	1	9		0		3		0	0	0	
			gl55	生成三大蟊-~C		GL	99	910	230	gl55	生成三大蟊-~C		0			1	1	1	9		0		3		0	0	0	
			gl56	生成三大蟊-蟊C		GL	99	910	300	gl56	生成三大蟊-蟊C		0			1	1	1	9		0		3		0	0	0	
		},
		920-~日K日切:{
			gl60	~Q日						GL	99	920	400	gl60	~Q日						1			1	1	1	9		0		3		0	0	0	
		},
		930-~日K日切後理:{
			gl61	Q日後z查						GL	99	930	410	gl61	Q日後z查						1			1	1	1	9		0		3		0	0	0	
			gl65	~^~						GL	99	930	420	gl65	~^~						1			1	1	1	9		0		3		0	0	0	
			gl70	~服⒂					GL	99	930	430	gl70	~服⒂					1			1	1	1	9		0		3		0	0	0	
			gl80	浣鹛理						GL	99	930	450	gl80	浣鹛理						0			1	1	1	9		0		3		0	0	0	
			gl85	~蟊砩成（Ya表）		GL	99	930	460	gl85	~蟊砩成（Ya表）		0			1	1	1	9		0		3		0	0	0	
			gl86	~蟊砩成（利表）			GL	99	930	470	gl86	~蟊砩成（利表）			0			1	1	1	9		0		3		0	0	0	
			gl87	~蟊砩成（p益明表）		GL	99	930	480	gl87	~蟊砩成（p益明表）		0			1	1	1	9		0		3		0	0	0	
			gl88	表IIr表					GL	99	930	490	gl88	表IIr表					0			1	1	1	9		0		3		0	0	0	
			gl89	表外IIr表					GL	99	930	495	gl89	表外IIr表					0			1	1	1	9		0		3		0	0	0	
			gl90	折算^程表						GL	99	930	500	gl90	折算^程表						0			1	1	1	9		0		3		0	0	0	
		}
	},
	3-gl-time:{		
													FARENDMA	BUZHOUHA
		PLJIOYMA	PLJYZWMC				XITONGBS	PLJYZBSH	PLJIOYMA	PLJYZWMC				ZHIXBZHI	YLPLJYLB	JYYXXKTJ	CHLCISHU	SHBZHDBZ	SHIWTJJG	SHUJCFMS	SHUJCFZJ	PLZYZXMS	ZUIDZYBF	RIZHIJIB	ZUOYCFTJ	PLJYYXMS	NGFTIAOG	SFWENJPL	JIAOYILX
												'法人代码'	 '步骤号'
		100-文件批量M:{	
			ap02	download file					GL	99	100	20	ap02	download file					1			1	1	1	9		0		3		0	0	0	
			ap03	upload file						GL	99	100	30	ap03	upload file						1			1	1	1	9		0		3		0	0	0	
			ap04	synchronize romote folder		GL	99	100	40	ap04	synchronize romote folder		1			1	1	1	9		0		3		0	0	0	
			fat1	'read accounting event'			GL	99	100	10	fat1	'read accounting event'			1			1	1	1	9		0		3		0	0	0	
		},
		110-定r批量M:{
			fat2	'accounting event posting'		GL	99	110	10	fat2	'accounting event posting'		1			1	1	1	9		0		3		0	0	0	
		}
			PILJYBSS
			FENZHONG	MIAO
			ap02	*	*/30	GL	99	onTimeFileDownload			100	ap02	{"input":{},"sys":{"prcscd":"ap02","error_id":null,"groupId":"100"},"comm_req":{"initiator_system":"999","sponsor_system":"999","busi_teller_id":"S####","session_id":null,"busi_org_id":"99","ip_address":null,"busi_branch_id":"200","channel_id":"999","over_time":null}}							?	*	*	*	*	*/30	0	0	1	SCHEDULING		read accounting event	onTimeFileDownloadOR01355520210601	bat
			ap03	*/6		0	GL	99	onTimeFileUpload			100	ap03	{"input":{},"sys":{"prcscd":"ap03","error_id":null,"groupId":"100"},"comm_req":{"initiator_system":"999","sponsor_system":"999","busi_teller_id":"S####","session_id":null,"busi_org_id":"99","ip_address":null,"busi_branch_id":"200","channel_id":"999","over_time":null}}							?	*	*	*	*/6		0	0	0	1	SCHEDULING		accounting event posting	onTimeFileUploadOR01353820210601	bat
			ap04	*	*/30	GL	99	onTimeSyscRemoteDirectory	100	ap04	{"input":{},"sys":{"prcscd":"ap04","error_id":null,"groupId":"100"},"comm_req":{"initiator_system":"999","sponsor_system":"999","busi_teller_id":"S####","session_id":null,"busi_org_id":"99","ip_address":null,"busi_branch_id":"200","channel_id":"999","over_time":null}}							?	*	*	*	*	*/30	0	0	1	SCHEDULING		accounting event posting	onTimeSyscRemoteDirectoryOR01355620210601	bat
			fat1	*/1		0	GL	99	onTimeReadAccoutingEvent	100	fat1	{"input":{},"sys":{"prcscd":"fat1","error_id":null,"groupId":"100"},"comm_req":{"caller_system":"999","initiator_system":"999","sponsor_system":"999","busi_teller_id":"S####","session_id":null,"busi_org_id":"99","ip_address":null,"busi_branch_id":"200","channel_id":"999","over_time":null}}		?	*	*	*	*/1		0	0	0	1	SCHEDULING		read accounting event	onTimeReadAccoutingEventOR01355720210601	bat
			fat2	*/1		0	GL	99	onTimeAccoutingEventPosting	110	fat2	{"input":{},"sys":{"prcscd":"fat2","error_id":null,"groupId":"110"},"comm_req":{"caller_system":"999","initiator_system":"999","sponsor_system":"999","busi_teller_id":"S####","session_id":null,"busi_org_id":"99","ip_address":null,"busi_branch_id":"200","channel_id":"999","over_time":null}}		?	*	*	*	*/1		0	0	0	1	SCHEDULING		accounting event posting	onTimeAccoutingEventPostingOR01355420210601	bat
	}

}

bat-code:{
	0-icore-day:{
		in:{
			taa9:{	"内部账入分户账余额流水"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								acctBalList = nsql-TaAccounting.selAccountBal:{
									select
										b.gl_ref_code,
										b.ccy_code,
										case when amt >= 0.00 THEN 'D' ELSE 'C' END as bal_type,
										case when amt >= 0.00 THEN b.amt else 0 - amt end as acct_bal  
									from 
										(select 
											a.gl_ref_code,
											a.ccy_code,
											sum(case when a.bal_type = 'D' THEN
													( case when #trxn_date# = a.bal_update_date THEN a.prev_date_bal else a.acct_bal end)
												ELSE
													0.00 - ( case when #trxn_date# = a.bal_update_date THEN a.prev_date_bal else a.acct_bal end)
												END) as amt
										from
											taa_account a
										where 
											a.org_id = #org_id# 
										and	a.acct_branch = #acct_branch#
										and a.internal_acct_type = 'A'
										group by a.gl_ref_code, a.ccy_code ) b
									order by b.gl_ref_code, b.ccy_code
								},
								nsql-TaAccounting.selAccountBal:{	
									select
									  b.gl_ref_code,
									  b.ccy_code,
									  case when amt >= 0.00 THEN 'D' ELSE 'C' END as bal_type,
									  case when amt >= 0.00 THEN b.amt else 0 - amt end as acct_bal  
									from 
									  (select 
										a.gl_ref_code,
										a.ccy_code,
										sum(case when a.bal_type = 'D' THEN
											( case when #trxn_date# = a.bal_update_date THEN a.prev_date_bal else a.acct_bal end)
										  ELSE
											0.00 - ( case when #trxn_date# = a.bal_update_date THEN a.prev_date_bal else a.acct_bal end)
										  END) as amt
									  from
										taa_suspense a
									  where 
										a.org_id = #org_id# 
									  and  a.acct_branch = #acct_branch#
									  group by a.gl_ref_code, a.ccy_code ) b
									order by b.gl_ref_code, b.ccy_code
								}
							},
						}
				}
			},
			mgta08:{ "将内部帐户信息写入分类科目"
				
			},
			cm03:{	"凭证核算余额"	//voucher accounting balance
				getBatchDataWalker:{
					nsql-CmVochEndDay.selVochAcctBrch:{
						select distinct acct_branch from cma_voch_acct where org_id=#org_id#
					}
				},
				getJobBatchDataWalker:{
					nsql-CmVochEndDay.selVochAcctBalByBrch:{
						select acct_branch,
							   voch_type,
							   sum(case
									 when bal_update_date = #trxn_date# then
									  prev_date_bal
									 else
									  stock_bal
								   end) prev_date_bal
						  from cma_voch_acct
						 where org_id = #org_id#
						   and acct_branch = #acct_branch#
						 group by voch_type, acct_branch
					}
				},
				process:{}
			},
			cm05:{	"凭证核算余额"	//voucher accounting balance
				getBatchDataWalker:{
					nsql-CmVochEndDay.selVochAcctBrch:{
						select distinct acct_branch from cma_voch_acct where org_id=#org_id#
					}
				},
				getJobBatchDataWalker:{
					nsql-CmCashEndDay.selCashAcctBalByBrch:{
						select acct_branch,
							   voch_type,
							   sum(case
									 when bal_update_date = #trxn_date# then
									  prev_date_bal
									 else
									  stock_bal
								   end) prev_date_bal
						  from cma_voch_acct
						 where org_id = #org_id#
						   and acct_branch = #acct_branch#
						 group by voch_type, acct_branch
					}
				},
				process:{}
			}
			
		},
		export:{
			taf03:{	"分户账余额流水文件生成"
				getBatchDataWalker:{},
				process:{
					TaFile.writeLedgerBalDataMain();:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"2.body":{
								nsql-TaFile.selLedgerBal:{
									select 
											* 
									from
											tas_ledger_bal a 	-- "分类科目余额"
									where
											a.trxn_date=#last_date# and a.org_id=#org_id# 
								}
							},
						}
					}
				}
			}
		},
		execute:{
			ap04:{	"批量同步远程目录文件"
				call:{
					ksys_dsrwdd		{"miaooooo:":"*/30"}
				},
				getBatchDataWalker:{
					nsql-ApFile.selSyscBatchIdList:{	"获取批量同步文件清单"
						select
								* 
						from
								app_batch 
						where
								file_proc_type = 'A' and file_recv_way = '2'	
								-- 	"E_FILEPROCTYPE.RECV_REQUEST"		"A-request acceptance"
								--	"E_FILERECVWAY.APPOINT_DIURECTORY"	"2-aggrement directory"
						select * from app_batch where file_proc_type = 'A' and file_recv_way = '2';
					}
				},
				process:{
					ApFile.syncRemoteFile2Local(dataItem.getBusi_batch_id());:{	"同步远程文件到本地"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
							},
							"3.":{
								ApBatch.fileBatchApply(apFileIn);
							}
						}
					}
				},
				exe-log:{
					201224:{
						ACCOUNTING2020122499000001.txt 	11:33:00
					}
				}
			},
			ap02:{	"文件接收"
				call:{
					ksys_dsrwdd		{"fenzhong:":"*/1"}
				},
				getBatchDataWalker:{
					nsql-ApFile.selGroupIdForRecv:{	//获取文件接收的散列值
						select
						distinct a.hash_value
						from
								apb_batch_receive a 
						where    	    	 
							  a.receive_ind = 'N' 
					}
				},
				getJobBatchDataWalker:{
					nsql-ApFile.selFileReceiveData:{
						select
								a.file_id ,a.file_name,a.file_server_path,a.file_local_path
						from
								apb_batch_receive a 
						where
							  a.hash_value = #hash_value#        
							  and a.receive_ind = 'N' 
					   order by  a.recevice_count asc
					}
				},
				process:{
					ApFile.syncRemoteFile2Local(dataItem.getBusi_batch_id());:{	"同步远程文件到本地"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
							},
							"3.":{
								ApBatch.fileBatchApply(apFileIn);
							}
						}
					}
				},
				exe-log:{
					201224:{
						ACCOUNTING2020122499000001.txt 	11:33:00
					}
				}
			}
		},
		parse:{
			fat1:{	"读取及处理会计事件流水文件"
				call:{
					ksys_dsrwdd		{"fenzhong:":"*/1"}
				},
				getBatchDataWalker:{
					nsql-FaFile.selFileHashInfo:{
						select
								distinct a.hash_value 
						from
								apb_batch_request a 
						join
								apb_batch_receive b 
						on      a.request_file_id = b.file_id
						where
							  a.org_id = '99'
						  and a.busi_batch_type = 'D' 					-- 	"E_BATCHTYPE.ACCOUNTINGEVENT_DOWN"	"D-accounting event stored"
						  and a.file_handling_status = 'A'				-- 	"E_FILEDEALSTATUS.UNCHECK"	"A-pending to check"
						  and b.receive_ind = 'Y' 
					}
				},
				getJobBatchDataWalker:{
					nsql-FaFile.selFileDownInfo:{
						
					}
				},
				process:{
					FaFile.doAccountingEventFile(dataItem);:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								FaSysService.getSysStatus();
									select * from fap_sys_define where sys_no='810';
							},
							"2.body":{
								fab_accounting_seq "会计序列"
								fab_original_voch "外部原始会计人员"
							},
						}
					}
				},
				exe-log:{
					parse file,fat1-201224:{
						11:32:00,706,11:34:01,864; -- 201201
						distinct a.hash_value-4:{
							 80-11:32:00,807-0,
							255-11:33:00,603-0,
							428-11:34:00,680-0,
							442-11:34:00,686-5*hash_value-13*file:{
								hash_value-20:{
									2: 26-11:34:00,832-1=hash_value,
									2:132-11:34:01,211-1=hash_value,rownum_ <= 3+20000 and rownum_ > 3,count=3
									2:179-11:34:01,283-2=hash_value,rownum <= 20000
									2:291-11:34:01,477-2=hash_value,rownum_ <= 3+20000 and rownum_ > 3,count=3
									2:446-11:34:01,592-3=hash_value,rownum_ <= 3+20000 and rownum_ > 3,count=3
									2:291-11:34:01,477-4=hash_value,rownum_ <= 2+20000 and rownum_ > 2,count=2
									2:291-11:34:01,477-5=hash_value,rownum_ <= 2+20000 and rownum_ > 2,count=2
								}
							}
						}	
						download file finished,update time:0201201 11:33:06 332,
						close fap_sys_define.system_service_status=0 11:33:27,455,	gl10
						switch 										 11:34:11,991	gl60
						open  fap_sys_define.system_service_status=1 11:35:09,675,	gl70
						fab_accounting_seq 20201201 11:38:01 805
					},
					201226:{
						11:37:00,801,11:39:00,559; -- 201201
						fab_accounting_seq 20201201 11:38:01 805
						
					}
				}
			},
			fat2:{	"会计事件流水汇总及入账"
				ref:{
					FaConst.BAT_ACCOUNTING_TRXN_CODE;
				},
				call:{
					ksys_dsrwdd		{"fenzhong:":"*/1"}
				},
				getBatchDataWalker:{
					nsql-FaAccounting.selHashValueFromAccounting:{
						select
								distinct a.hash_value 
						from
								fab_accounting_seq a 	-- "会计序列"
						where
								a.trxn_date='20201231' and a.org_id='99' 
								and a.trxn_seq_status='2'		-- "2-已解析"
					}
				},
				process:{
					FaBookAccountingSeq.bookAccountingSeq(dataItem.getHash_value(), batchNo);:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.update batch_no":{
								nsql-FaAccounting.updTotalBatchNo:{
									update
											fab_accounting_seq a -- "会计序列"
									set
											a.total_batch_no=#total_batch_no# ,a.trxn_seq_status='3' 
									where
											a.trxn_date=#trxn_date# and a.org_id=#org_id# 
											and a.hash_value = #hash_value#
											and a.trxn_seq_status=#trxn_seq_status# and rownum<= #total_count# 
								}
							},
							"2.get sys_no":{
								nsql-FaAccounting.selAccountingDataBySys:{
									select
										   distinct a.sys_no
									  from
											fab_accounting_seq a -- "会计序列"
									  where
											a.trxn_date = #trxn_date# and a.total_batch_no=#total_batch_no# and a.org_id=#org_id# 
								}
							},
							"3.get data":{
								nsql-FaAccounting.selAccountingData:{
									select
										   count(1) as total_count,a.acct_branch,a.trxn_ccy,a.gl_code, a.debit_credit ,a.sys_no ,nvl(sum(a.trxn_amt),0.00) as total_amt
									  from
											fab_accounting_seq a -- "会计序列"
									  where
											a.trxn_date = #trxn_date# and a.total_batch_no=#total_batch_no#  
											and a.org_id=#org_id# and a.sys_no=#sys_no#      
									  group by
											a.sys_no, a.acct_branch,a.trxn_ccy,a.gl_code, a.debit_credit
									  order by a.sys_no, a.acct_branch,a.trxn_ccy,a.gl_code, a.debit_credit
								}
							},
						}
					}
				}
			}
		}
	},
	1-gl-process:{
		init:{
			glt5:{	""
				getBatchDataWalker:{},
				process:{
					GlFile.doOrgSysOccurrFile();:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								nsql-GlFile.selFileLoanDown:{
									select
											a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path 
									from
											apb_batch_request a 
									join
											apb_batch_receive b 	
									on      a.request_file_id = b.file_id
									where
											a.org_id = #org_id# 
											and a.busi_batch_type = 'N' 	"N-original system occurrence-原始系统发生" 
											and a.file_handling_status = #file_handling_status#
											and b.receive_ind = #receive_ind# 
								}
							},
						}
					}
				}
			},
			glt01:{	"财务系统余额导入"
				getBatchDataWalker:{},
				process:{
					GlFile.doOrgSysBalFile();// 年终试算，财务系统余额导入
						"data flow":{
							from 	apb_batch_request,apb_batch_receive,	-- "文件批量请求薄"
									ksys_jyyxrz,fap_sys_define	--"批量交易运行日志","系统定义"
							insert 	fab_org_sys_bal	-- "原始系统资产负债登记表-original system balance registration sheet"
							update 	apb_batch_request
						},
						"key code":{
							"1. get file":{
								nsql-GlFile.selFileLoanDown:{// 从平台登记的表中取出已下载文件的信息
									select
											a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path -- "批量业务代码"
									from
											apb_batch_request a -- "文件批量请求薄"
									join
											apb_batch_receive b 
									on      a.request_file_id = b.file_id
									where
											a.org_id = 'org_id' 
											and a.busi_batch_type = 'O' 		-- "批量业务类型-batch business type"	"O-original system balance-原始系统平衡"
											and a.file_handling_status = 'A'	-- "文件处理状态" 	"A-UNCHECK-pending to check-等待检查"
											and b.receive_ind = 'Y'
								},
								if (sleepTime > waitTime) {	//
									nsql-GlBranch.selJyyxrzInfo:{
										select
												* 
										from
												ksys_jyyxrz c --"批量交易运行日志"
										where
										c.jiaoyirq=to_date(#trxn_date#=runEnvs.getBal_sheet_date(),'yyyyMMdd') and c.piljybss='glt01' -- "批量交易ID"
											and c.zuoyzxzt='success' 
									}
									selJyyxrzInfo != null return;
								}
							},
							"2. fap_sys_define check":{
								nsql-GlFile.selCountOfOcrrFile:{
									select
											count(*) 
									from
											fap_sys_define a  -- "系统定义"
									where
											a.org_id=#org_id# and  a.busi_seq_format=#busi_seq_format# and a.sys_no!='810' -- "业务流水组织形式" "4-并账" ,"系统编号" "GL_SYSTEM"
								}
							},
							"3. parse":{
								"3.1 get file",
								"3.2 head check":{
									ApBatch.setFormatErrorByImport(fileLoad.getBusi_batch_code());// 更新文件请求登记薄文件处理状态
										update apb_batch_request set file_handling_status = 'Y' where busi_batch_code = 'batchCode';-- "文件处理状态" "Y - check fail - format error"
								},
								nsql-FaAccounting.selGLBalance:{	//获取系统分户账对应总账系统的余额
									select
										case when b.bal_update_date>#trxn_date# then b.previous_bal_direction else b.bal_direction end as bal_direction,
										case when b.bal_update_date>#trxn_date# then b.previous_acct_bal else b.acct_bal end as acct_bal
									  from
											faa_account b 
									  where
										  b.org_id=#org_id# and
										  b.sys_no=#sys_no# and 
										  b.acct_branch=#acct_branch# and 
										  b.ccy_code=#ccy_code# and 
										  b.gl_code=#gl_code# and 
										  b.acct_type='1'
								},
								sysBalance.setLedger_check_result -- "分类帐检查结果-ledger check result",
								DaoUtil.insertBatch(fab_org_sys_bal.class, sysBalanceList);
							},
							"4. amount sum check"{
								nsql-GlFile.selFileHeadInfofromSysBal:{	// 获取文件汇总的文件头信息
									select
											count(1) as head_total_count, nvl(sum(a.acct_bal), 0.00) as head_total_amt 
									from
											fab_org_sys_bal a	-- "原始系统资产负债登记表-original system balance registration sheet"
									where
											a.org_id=#org_id# and
											a.trxn_date=#trxn_date#
								},
								method-ApBatch.returnStatusByImport:{
									batchReq = select * from apb_batch_request where busi_batch_code = 'batchCode';	 -- "文件批量请求薄"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.CHECKED);-- "文件处理状态" 	"B 	CHECKED 	checked		已检测"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.FAILCHECK_UNEQUAL);-- "文件处理状态" 	"Z 	FAILCHECK_UNEQUAL 	check fail - unmatch	检查失败-不匹配"
									Apb_batch_requestDao.updateOne_odb1(batchReq);
								}
							}
						}
				}
			},
			glt02:{	"提n入"
				getBatchDataWalker:{},
				process:{
					GlFile.doAccureFileAtYearTril();// 年终试算，处理计提文件	//导入计提数据文件，解析到数据库表中，日终步骤
						"data flow":{	
							from 	apb_batch_request,apb_batch_receive,	-- "文件批量请求薄"
									app_system_parameter,
									fap_accounting_event_parm		-- "会计核算参数表"
							insert 	fab_accrue,fab_original_voch	-- "fab_accrue-accrue registration sheet-计提登记表","外部原始会计人员-external original accounting vocher"
							update 	apb_batch_request
						},
						"key code":{
							"1. get files":{
								nsql-GlFile.selFileLoanDown:{// 从平台登记的表中取出已下载文件的信息
									select
											a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path -- "批量业务代码"
									from
											apb_batch_request a -- "文件批量请求薄"
									join
											apb_batch_receive b 
									on      a.request_file_id = b.file_id
									where
											a.org_id = 'org_id' 
											and a.busi_batch_type = 'F' 		-- "批量业务类型-batch business type"	"F-ACCRUE_DOWN-accrued data stored-应计数据存储"
											and a.file_handling_status = 'A'	-- "文件处理状态" 	"A-UNCHECK-pending to check-等待检查"
											and b.receive_ind = 'Y'
								},
							},
							"2. get par":{
								select parm_value from app_system_parameter where main_key='GL_CODE_ANALYSIS_ERROR' and sub_key='*'; -- 1
							}
							"3. parse":{
								"3.1 get file",
								"3.2 head check":{
									ApBatch.setFormatErrorByImport(fileLoad.getBusi_batch_code());// 更新文件请求登记薄文件处理状态
										update apb_batch_request set file_handling_status = 'Y' where busi_batch_code = 'batchCode';-- "文件处理状态" "Y - check fail - format error"
								},
								sys_no = 800;"CORE_SYSTEM"
								init accureData:fileBodys	-- "fab_accrue-accrue registration sheet-计提登记表"
									select * from fap_accounting_event_parm where sys_no = '800' and accounting_alias = '' and bal_attributes='' ;-- "会计核算参数表"// 查询会计核算参数表，获得相应科目 
								GlRegBook.regOriginalaVochFromAccrue(accureData, vochRecordNo, headInfo.getHead_total_count());// 登记记外系统凭证
									DaoUtil.insertBatch(fab_original_voch.class, vochList);
										fab_original_voch	-- "外部原始会计人员-external original accounting vocher"
								DaoUtil.insertBatch(fab_accrue.class, accureDataList);
							}
							"4. amount sum check"{
								nsql-GlFile.selFileHeadInfoFromAccure:{	// 获取文件汇总的文件头信息
									select
											count(1) as head_total_count, nvl(sum(a.budget_inst_amt), 0.00) as head_total_amt 
									from
											fab_accrue a	-- "fab_accrue-accrue registration sheet-计提登记表"
									where
											a.org_id = #org_id# and a.accrue_date=#trxn_date# 
								},
								method-ApBatch.returnStatusByImport:{
									batchReq = select * from apb_batch_request where busi_batch_code = 'batchCode';	 -- "文件批量请求薄"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.CHECKED);-- "文件处理状态" 	"B 	CHECKED 	checked		已检测"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.FAILCHECK_UNEQUAL);-- "文件处理状态" 	"Z 	FAILCHECK_UNEQUAL 	check fail - unmatch	检查失败-不匹配"
									Apb_batch_requestDao.updateOne_odb1(batchReq);
								}
							}
						}
				}
			}
			glt03:{	"核心分户账余额数据文件导入"
				getBatchDataWalker:{},
				process:{
					GlFile.doLedgerBalFile();// 年终试算，分户账余额文件导入	
						"data flow":{
							from 	apb_batch_request,apb_batch_receive,	-- "文件批量请求薄"
									ksys_jyyxrz,app_system_parameter,fap_accounting_event_parm,fap_accounting_subject	--"批量交易运行日志","","会计核算参数表","会计科目表"
							insert 	fab_ledger_check_seq	-- "fab_ledger_check_seq-工厂分类帐检查"
							update 	apb_batch_request
						},
						"key code":{
							"1. get file":{
								nsql-GlFile.selFileLoanDown:{// 从平台登记的表中取出已下载文件的信息
									select
											a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path -- "批量业务代码"
									from
											apb_batch_request a -- "文件批量请求薄"
									join
											apb_batch_receive b 
									on      a.request_file_id = b.file_id
									where
											a.org_id = 'org_id' 
											and a.busi_batch_type = 'H' 		-- "批量业务类型-batch business type"	"H-ledger balance stored-已存储分类帐余额"
											and a.file_handling_status = 'A'	-- "文件处理状态" 	"A-UNCHECK-pending to check-等待检查"
											and b.receive_ind = 'Y'
								},
								if (sleepTime > waitTime) {	//
									nsql-GlBranch.selJyyxrzInfo:{
										select
												* 
										from
												ksys_jyyxrz c --"批量交易运行日志"
										where
										c.jiaoyirq=to_date(#trxn_date#=runEnvs.getBal_sheet_date(),'yyyyMMdd') and c.piljybss='glt03' -- "批量交易ID"
											and c.zuoyzxzt='success' 
									}
									selJyyxrzInfo != null return;
								}
							},
							"2. get par":{
								select parm_value from app_system_parameter where main_key='GL_CODE_ANALYSIS_ERROR' and sub_key='*'; -- 1 
							}
							"3. parse":{
								"3.1 get file",
								"3.2 head check":{
									ApBatch.setFormatErrorByImport(fileLoad.getBusi_batch_code());// 更新文件请求登记薄文件处理状态
										update apb_batch_request set file_handling_status = 'Y' where busi_batch_code = 'batchCode';-- "文件处理状态" "Y - check fail - format error"
								},
								sys_no = 800;"CORE_SYSTEM"
								init lederData:fileBodys	-- "fab_ledger_check_seq-工厂分类帐检查"
									select * from fap_accounting_event_parm where sys_no = '800' and accounting_alias = '' and bal_attributes='' ;-- "会计核算参数表"// 查询会计核算参数表，获得相应科目 
									select * from fap_accounting_subject where gl_code='' ;-- "会计科目表"// 查询科目
								DaoUtil.insertBatch(fab_ledger_check_seq.class, ledgerDataList); // 文件明细信息批量插入表
							},
							"4. amount sum check"{
								nsql-GlFile.selFileHeadInfoFromLedger:{	// 获取文件汇总的文件头信息
									select
											count(1) as head_total_count, nvl(sum(a.acct_bal), 0.00) as head_total_amt 
									from
											fab_ledger_check_seq a	-- "fab_ledger_check_seq-工厂分类帐检查"
									where
											a.org_id = #org_id# and a.trxn_date=#trxn_date#
								},
								method-ApBatch.returnStatusByImport:{
									batchReq = select * from apb_batch_request where busi_batch_code = 'batchCode';	 -- "文件批量请求薄"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.CHECKED);-- "文件处理状态" 	"B 	CHECKED 	checked		已检测"
									batchReq.setFile_handling_status(E_FILEDEALSTATUS.FAILCHECK_UNEQUAL);-- "文件处理状态" 	"Z 	FAILCHECK_UNEQUAL 	check fail - unmatch	检查失败-不匹配"
									Apb_batch_requestDao.updateOne_odb1(batchReq);
								}
							}
						}
				}
			},
			glt06:{	"对账文件导入及检查"
				getBatchDataWalker:{},
				process:{
					GlFile.doCheckAccountingFile();// 对账文件导入及检查
						"data flow":{
							from 	apb_batch_request,apb_batch_receive,	-- "文件批量请求薄"
									ksys_jyyxrz	--"批量交易运行日志"
							update 	apb_batch_request
						},
						"key code":{
							"1. get file":{
								nsql-GlFile.selFileLoanDown:{// 从平台登记的表中取出已下载文件的信息
									select
											a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path -- "批量业务代码"
									from
											apb_batch_request a -- "文件批量请求薄"
									join
											apb_batch_receive b 
									on      a.request_file_id = b.file_id
									where
											a.org_id = 'org_id' 
											and a.busi_batch_type = 'J' 		-- "批量业务类型-batch business type-EnumType.E_BATCHTYPE"	"J-reconciliation file stored-已存储对帐文件"
											and a.file_handling_status = 'A'	-- "文件处理状态" 	"A-UNCHECK-pending to check-等待检查"
											and b.receive_ind = 'Y'
								},
								if (sleepTime > waitTime) {	//
									nsql-GlBranch.selJyyxrzInfo:{
										select
												* 
										from
												ksys_jyyxrz c --"批量交易运行日志"
										where
										c.jiaoyirq=to_date(#trxn_date#=runEnvs.getBal_sheet_date(),'yyyyMMdd') and c.piljybss='glt06' -- "批量交易ID"
											and c.zuoyzxzt='success' 
									}
									selJyyxrzInfo != null return;
								}
							},
							"2. get par"-null:{
							}
							"3. parse":{
								"3.1 get file",
								"3.2 head check":{},
								sys_no = 800;"CORE_SYSTEM"
								init lederData:fileBodys	-- "GlCheckRecord-核心对账文件复合类型":{"交易日期","文件类型","会计主体","记录笔数","总金额"}
								"3.5 计算落地数据":{
									nsql-GlFile.selCheckDataFromAccountingSeq:{// 会计事件的落地数据
										select
												nvl(sum(a.trxn_amt), 0.00) as total_amt, count(1) as record_number, a.trxn_date,
												'C' as file_type, a.accounting_subject 
										from
												fab_accounting_seq a 		-- "会计序列-accounting sequence"
										where
												a.org_id = #org_id# and a.trxn_date = #trxn_date# 
												and a.sys_no='800' 
										group by
												a.accounting_subject , a.trxn_date 
									},
									nsql-GlFile.selCheckDataFromAccure:{// 计提的落地数据
										select
												nvl(sum(a.budget_inst_amt),0.00) as total_amt, count(1) as record_number, a.accrue_date as trxn_date, 'E' as file_type,
												'6' AS accounting_subject 
										from
												fab_accrue a 		-- "fab_accrue-accrue registration sheet-计提登记表"
										where
												a.org_id=#org_id# and a.accrue_date=#trxn_date# 
												and a.sys_no=#sys_no# 
										group by
												a.accrue_date
									},
									nsql-GlFile.selCheckDataFromLeger:{// 分户账余额的落地数据
										
									}
								}
							},
							"4. end"{
								update apb_batch_request set file_handling_status = 'C' where busi_batch_code = 'batchCode';	 -- "文件批量请求薄", "C - success"
								fap_sys_define.setSystem_date(BizUtil.getTrxRunEnvs().getNext_date());//800 
							}
						}
				}
			},
		},
		check:{
			glt08:{	"试算前检查"
				getBatchDataWalker:{},
				process:{
					GlCheck.prcEodBeforeYear:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.date check":{
								select * from app_date where busi_org_id='';
							},
							"2.settType check":{
								settType = select parm_value from app_system_parameter where main_key='SETT_TYPE' and sub_key='*';
								!=1-SETT_SINGLE_POINT && !=2-SETT_MULTI_LEVEL
								if(settType==2){
									nsql-GlSettle.selCountBranchSettle:{
										select
												count(*) 
										from
												fap_branch_settlement -- "清算关系组织结构"
										where
												org_id=#org_id# 
									}
								}
							},
							"3. 系统原始凭证科目号为空 check":{
								waitTimeDown = select parm_value from app_system_parameter where main_key='EOD_SLEEP_TIME' and sub_key='WAIT_FILE_DOWN';
								nsql-GlRegBook.selCountOriginalVoch:{// 当日有 外系统原始凭证科目号为空的总笔数
									select
											count(trxn_date) 
									from
											fab_original_voch 		-- "外部原始会计人员-external original accounting vocher"
									where
											org_id=#org_id# and trxn_date =#trxn_date# and (gl_code is null or gl_code = '')
								},
							},
							"4. 会计序列 check":{
								waitTimeBook = select parm_value from app_system_parameter where main_key='EOD_SLEEP_TIME' and sub_key='CHECKING';
								nsql-GlRegBook.selAccountedSeq:{// 当日是否有已汇总的会计流水
									select
											count(*) 
									from
											fab_accounting_seq 	-- "会计序列-accounting sequence"
									where
											org_id=#org_id# and trxn_date=#trxn_date# and trxn_seq_status <> '3'
								},
							},	
							"5. 计提登记 check"-null:{
								nsql-GlRegBook.selCountAccrue:{// 当日贷款计提登记总数,ABC三种类型必须都存在,否则报错
									select
											count(accrue_type) 
									from
											fab_accrue 		-- "accrue registration sheet-计提登记表"
									where
											org_id=#org_id# and accrue_type=#accrue_type# and accrue_date=#accrue_date# and analysis_state<>'3'
								},
							},	
							"8. 分类科目 check"-null:{
								nsql-GlRegBook.selCountAccrue:{
									select
											count(*) 
									from
											fab_ledger_check_result 	-- "分类科目检查结果-ledger account check result"
									where
											org_id=#org_id# and trxn_date =#trxn_date# and ledger_check_result <> '1'
								},
								select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_ERROR' and sub_key='*';
							},
							"9. 分类科目 check"-null:{
								checkExchangeRate():{// 检查折算汇率是否已录入
									exchangeRateMode = select parm_value from app_system_parameter where main_key='EXCHANGE_RATE_MODE' and sub_key='*'; //2
									select * from app_drop where drop_list_type='EXCHANGE_CCY_CODE';
									ccyCode = select drop_list_value from app_drop_list  where drop_list_type = 'EXCHANGE_CCY_CODE';
									if(exchangeRateMode=1-EXCHANGE_RATE_MODE_MANUAL){
										nsql-GlExchange.selAllExchangeCcy:{
											SELECT
													count(*) 
											FROM
													glb_exchange_rate 	-- "折算汇率（外管每日中间价）"
											WHERE
													org_id = #org_id# AND exchange_ccy_code=#exchange_ccy_code# 
													and trxn_date <= #trxn_date#
										}
									}else{
										nsql-GlExchange.selExchangeCurrencyCode-null:{
											
										}
									}
								}
							}
						}
					}
				}
			},
		},
		do:{
			glt15:{	"存款差~提"
				getBatchDataWalker:{
					nsql-GlRegBook.selAccureBookGroup:{
						select
								a.accrue_type, a.sys_no, a.accrue_date, a.acct_branch, a.accrue_gl_code,	"accrue_gl_code-计提科目"
								a.offset_gl_code, a.ccy_code, sum(a.budget_inst_amt) as budget_inst_amt
						   
						from
								fab_accrue a 	-- "accrue registration sheet-计提登记表"
						where
								a.org_id = #org_id# and a.accrue_type = 'A' 	--	"计提种类-accrue type"	"A-DEPOSIT_INTEREST_PAYBLE-存款应付利息计提"
								and a.accrue_date=#accrue_date# and a.analysis_state='A' 	-- "分析状态-analysis state"	"2-AYNASIED-已解析"
						group by
								a.accrue_type, a.sys_no, a.accrue_date,
								a.acct_branch, a.accrue_gl_code, a.offset_gl_code, a.ccy_code 
					}
				},
				process:{
					GlRegBook.depositAccure(dataItem);:{"存款计提"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.1取出计提账号信息":{
								accureAcct = FaOpenAccount.getAcctBySubject	// 取出计提账号信息	//根据科目号取基本账户信息
									select parm_value from app_system_parameter where main_key='ACCT_SEQ' and sub_key='BASE_ACCOUNT';
									acctTable = FaOpenAccount.openBaseAccount(openIn);//开基本户
										E_ACCTTYPE.BASE_ACCOUNT	"1-基准账户"
										Faa_accountDao.selectOne_odb3 //判断是否已开户
											select * from faa_account where sys_no=#sys_no# and acct_branch=#acct_branch# and gl_code=#gl_code# and ccy_code=#ccy_code# and acct_seq=#acct_seq# and org_id=#org_id#
										if(){
											restartAcct(accountTable);
										}else{
											setSumitActt(openBaseacctIn);	->	acct_status "1-NORMAL-正常"
											accountTable = submitAcct(submitAcct);
												String acctNo = geneAcctNo(ccyInfo, subjectInfo, submitAcct);	//生成总账账号
													String accountNo = ApSeq.genSeq("GL_ACCOUNT_NO"); // 生成内部账号
												Faa_accountDao.insert(acctTable); // 插入数据库
													insert into faa_account	values();	-- "总账账户表-gl accounts"
												ApDataAudit.regLogOnInsertParameter(acctTable);	// 登记审计
										}
							},
							"1.2.计提账号记账复合类型":{
								FaAccounting.getAccountingCheckByAcct	"depositAccure"
							},
							"2.对方信息初始化":{
								"2.1取出对方账号信息",
								"2.2对方账户记账复合类型"
							},
							"3.套账记账":{
								FaAccounting.regTellerSeq(regTellerSeq);// 登记柜员流水
									Fab_teller_seqDao.insert(tellerSeq);
										insert into fab_teller_seq values();
								FaAccounting.bookMultiAccounting	//套账记账（含科目）
									FaAccounting.regTellerSeq(regTellerSeq);
									for(:accountingList){
										singleAccounting(accountingInfo, tellerSeq, totalCount);	// 单笔记账
									}
									FaAcctingVochDao.selAllAcctingVoch(tellerSeq, false);	//测试，查询总账凭证里数据是否正确。
									checkBalance(tellerSeq);//检查借贷平衡
										noBalanceCount = FaAccountingDao.selNoBalanceCount
										if (noBalanceCount.size() > 0)throw GlErr.GL.E0052();
							},
							"4.登记计提记账登记簿":{
								Fab_accrue_accountingDao.insert(accureAccountingTable);
									insert into fab_accrue_accounting values();	-- "计提会计登记表-accrue accounting registration sheet"
								GlRegBookDao.updAccureBook();
									nsql-GlRegBook.updAccureBook:{
										  UPDATE
												fab_accrue a 	-- "计提登记表-accrue registration sheet"
										  SET
												a.analysis_state = '3' 	-- "分析状态-analysis state"	"3-SUMMARY-已处理"
										  WHERE
												a.org_id = #org_id# AND a.sys_no = #sys_no# 
												AND a.accrue_date = #accrue_date# AND a.accrue_type = #accrue_type#  AND a.acct_branch = #acct_branch# 
												AND a.accrue_gl_code = #accrue_gl_code# AND a.analysis_state = '2' and a.ccy_code  = #ccy_code#
									}
							}
						}
					}
				}
			},
			glt16:{	"J款差~提"
				getBatchDataWalker:{
					nsql-GlRegBook.selAccureBookGroup:{
						select
								a.accrue_type, a.sys_no, a.accrue_date, a.acct_branch, a.accrue_gl_code,	"accrue_gl_code-计提科目"
								a.offset_gl_code, a.ccy_code, sum(a.budget_inst_amt) as budget_inst_amt
						   
						from
								fab_accrue a 	-- "accrue registration sheet-计提登记表"
						where
								a.org_id = #org_id# and a.accrue_type = 'B' 	--	"计提种类-accrue type"	"B-贷款应收利息计提"
								and a.accrue_date=#accrue_date# and a.analysis_state='A' 	-- "分析状态-analysis state"	"2-AYNASIED-已解析"
						group by
								a.accrue_type, a.sys_no, a.accrue_date,
						
					}
				},
				process:{
					GlRegBook.loanAccure(dataItem);:{"贷款计提"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.1取出计提账号信息":{
								accureAcct = FaOpenAccount.getAcctBySubject	// 取出计提账号信息	//根据科目号取基本账户信息
									select parm_value from app_system_parameter where main_key='ACCT_SEQ' and sub_key='BASE_ACCOUNT';
									acctTable = FaOpenAccount.openBaseAccount(openIn);//开基本户
										E_ACCTTYPE.BASE_ACCOUNT	"1-基准账户"
										Faa_accountDao.selectOne_odb3 //判断是否已开户
											select * from faa_account where sys_no=#sys_no# and acct_branch=#acct_branch# and gl_code=#gl_code# and ccy_code=#ccy_code# and acct_seq=#acct_seq# and org_id=#org_id#
										if(){
											restartAcct(accountTable);
										}else{
											setSumitActt(openBaseacctIn);	->	acct_status "1-NORMAL-正常"
											accountTable = submitAcct(submitAcct);
												String acctNo = geneAcctNo(ccyInfo, subjectInfo, submitAcct);	//生成总账账号
													String accountNo = ApSeq.genSeq("GL_ACCOUNT_NO"); // 生成内部账号
												Faa_accountDao.insert(acctTable); // 插入数据库
													insert into faa_account	values();	-- "总账账户表-gl accounts"
												ApDataAudit.regLogOnInsertParameter(acctTable);	// 登记审计
										}
							},
							"1.2.计提账号记账复合类型":{
								FaAccounting.getAccountingCheckByAcct	"loanAccure"
							},
							"2.对方信息初始化":{
								"2.1取出对方账号信息",
								"2.2对方账户记账复合类型"
							},
							"3.套账记账":{
								FaAccounting.regTellerSeq(regTellerSeq);// 登记柜员流水
									Fab_teller_seqDao.insert(tellerSeq);
										insert into fab_teller_seq values();
								FaAccounting.bookMultiAccounting	//套账记账（含科目）
									FaAccounting.regTellerSeq(regTellerSeq);
									for(:accountingList){
										singleAccounting(accountingInfo, tellerSeq, totalCount);	// 单笔记账
									}
									FaAcctingVochDao.selAllAcctingVoch(tellerSeq, false);	//测试，查询总账凭证里数据是否正确。
									checkBalance(tellerSeq);//检查借贷平衡
										noBalanceCount = FaAccountingDao.selNoBalanceCount
										if (noBalanceCount.size() > 0)throw GlErr.GL.E0052();
							},
							"4.登记计提记账登记簿":{
								Fab_accrue_accountingDao.insert(accureAccountingTable);
									insert into fab_accrue_accounting values();	-- "计提会计登记表-accrue accounting registration sheet"
								GlRegBookDao.updAccureBook();
									nsql-GlRegBook.updAccureBook
										  UPDATE
												fab_accrue a 	-- "计提登记表-accrue registration sheet"
										  SET
												a.analysis_state = '3' 	-- "分析状态-analysis state"	"3-SUMMARY-已处理"
										  WHERE
												a.org_id = #org_id# AND a.sys_no = #sys_no# 
												AND a.accrue_date = #accrue_date# AND a.accrue_type = #accrue_type#  AND a.acct_branch = #acct_branch# 
												AND a.accrue_gl_code = #accrue_gl_code# AND a.analysis_state = '2' and a.ccy_code  = #ccy_code#
							}
						}
					}
				}
			},
			glt17:{	"J款p失洳铑~提"
				getBatchDataWalker:{
					nsql-GlRegBook.selAccureBookGroup:{
						select
								a.accrue_type, a.sys_no, a.accrue_date, a.acct_branch, a.accrue_gl_code,	"accrue_gl_code-计提科目"
								a.offset_gl_code, a.ccy_code, sum(a.budget_inst_amt) as budget_inst_amt
						   
						from
								fab_accrue a 	-- "计提登记表-accrue registration sheet"
						where
								a.org_id = #org_id# and a.accrue_type = 'C' 	--	"计提种类-accrue type"	"C-贷款损失准备计提"
								and a.accrue_date=#accrue_date# and a.analysis_state='A' 	-- "分析状态-analysis state"	"2-AYNASIED-已解析"
						group by
								a.accrue_type, a.sys_no, a.accrue_date,
						
					}
				},
				process:{
					GlRegBook.loanLostProvision(dataItem);:{"贷款损失准备"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.1取出计提账号信息":{
								accureAcct = FaOpenAccount.getAcctBySubject	// 取出计提账号信息	//根据科目号取基本账户信息
									select parm_value from app_system_parameter where main_key='ACCT_SEQ' and sub_key='BASE_ACCOUNT';
									acctTable = FaOpenAccount.openBaseAccount(openIn);//开基本户
										E_ACCTTYPE.BASE_ACCOUNT	"1-基准账户"
										Faa_accountDao.selectOne_odb3 //判断是否已开户
											select * from faa_account where sys_no=#sys_no# and acct_branch=#acct_branch# and gl_code=#gl_code# and ccy_code=#ccy_code# and acct_seq=#acct_seq# and org_id=#org_id#
										if(){
											restartAcct(accountTable);
										}else{
											setSumitActt(openBaseacctIn);	->	acct_status "1-NORMAL-正常"
											accountTable = submitAcct(submitAcct);
												String acctNo = geneAcctNo(ccyInfo, subjectInfo, submitAcct);	//生成总账账号
													String accountNo = ApSeq.genSeq("GL_ACCOUNT_NO"); // 生成内部账号
												Faa_accountDao.insert(acctTable); // 插入数据库
													insert into faa_account	values();	-- "总账账户表-gl accounts"
												ApDataAudit.regLogOnInsertParameter(acctTable);	// 登记审计
										}
							},
							"1.2.计提账号记账复合类型":{
								FaAccounting.getAccountingCheckByAcct	"loanAccure"
							},
							"2.对方信息初始化":{
								"2.1取出对方账号信息",
								"2.2对方账户记账复合类型"
							},
							"3.套账记账":{
								FaAccounting.regTellerSeq(regTellerSeq);// 登记柜员流水
									Fab_teller_seqDao.insert(tellerSeq);
										insert into fab_teller_seq values();
								FaAccounting.bookMultiAccounting	//套账记账（含科目）
									FaAccounting.regTellerSeq(regTellerSeq);
									for(:accountingList){
										singleAccounting(accountingInfo, tellerSeq, totalCount);	// 单笔记账
									}
									FaAcctingVochDao.selAllAcctingVoch(tellerSeq, false);	//测试，查询总账凭证里数据是否正确。
									checkBalance(tellerSeq);//检查借贷平衡
										noBalanceCount = FaAccountingDao.selNoBalanceCount
										if (noBalanceCount.size() > 0)throw GlErr.GL.E0052();
							},
							"4.登记计提记账登记簿":{
								Fab_accrue_accountingDao.insert(accureAccountingTable);
									insert into fab_accrue_accounting values();	-- "计提会计登记表-accrue accounting registration sheet"
								GlRegBookDao.updAccureBook();
									nsql-GlRegBook.updAccureBook
										  UPDATE
												fab_accrue a 	-- "计提登记表-accrue registration sheet"
										  SET
												a.analysis_state = '3' 	-- "分析状态-analysis state"	"3-SUMMARY-已处理"
										  WHERE
												a.org_id = #org_id# AND a.sys_no = #sys_no# 
												AND a.accrue_date = #accrue_date# AND a.accrue_type = #accrue_type#  AND a.acct_branch = #acct_branch# 
												AND a.accrue_gl_code = #accrue_gl_code# AND a.analysis_state = '2' and a.ccy_code  = #ccy_code#
							}
						}
					}
				}
			}
			
		},
			glt18:{	"收付利息t字a提"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{ "查询机构所有信息列表"
						SELECT * from apb_branch	-- "机构信息"
						where org_id = '' and real_branch_ind = 'Y';	-- "实体机构标识"
					}
				},
				process:{
					GlRegBook.redInkAccure(dataItem.getBranch_id());:{	"红字补计提"
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								subjectList = nsql-GlRegBook.selAccureSubject:{	"从应计注册表获取总账代码-acquiring gl code from accrue regbook"
									select
											distinct a.accrue_gl_code ,a.accrue_offset_gl_code, a.sys_no
									  from
											fab_accrue_accounting a 	-- "计提会计登记表-accrue accounting registration sheet"
									  where
											a.accrue_branch=#accrue_branch# and a.accrue_date=#accrue_date# 
											and a.org_id=#org_id# and a.accrue_type in ('A','B')	-- "计提种类-应计项目类型-accrue type"	
											
											"A-DEPOSIT_INTEREST_PAYBLE-存款应付利息计提"	"B-贷款应收利息计提-LOAN_INTEREST_RECEIVABLE"
								},
								for(subjectInfo:subjectList):{	// 根据科目，开始红字计提
									acctList=nsql-FaAccount.selAcctByAccureSubject:{	"查询要重新链接的帐户-inquiring account that be redink"
										select
												* 
										from
												faa_account a 	-- "总账账户表-gl accounts"
										where
												a.gl_code='subjectInfo.getAccrue_gl_code()' and a.bal_update_date=#bal_update_date# 
												and a.org_id=#org_id# and a.sys_no='subjectInfo.getSys_no()' and a.acct_bal< 0
									},
									for(acctTable:acctList):{	// 循环所有的账户
										balDirect-"余额方向",
										accountingDirect-"计提方向",
										oppDirect-"对手方向"
										FaAccounting.getAccountingCheckByAcct	"记账复合类型"	"redInkAccure"
										FaAccounting.bookMultiAccounting	"记账"	"redInkAccure"
									}
								}
							}
						}
					}
				}
			},
			glt20:{	"总分核对"
				getBatchDataWalker:{},
				process:{
					"data flow":{	
						from 	
						insert 	
						update 	
					},
					"key code":{
						"1.":{
							ledgerCheckNoGlCode = select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_NO_GL_CODE' and sub_key='800';	-- "FaConst.CORE_SYSTEM"
							{
								,60010101,60010102,60010201,60010202,60010301,60010302,60010401,60010402,60010501,
								60010502,60010601,60010602,60010701,60010702,60012901,60012902,60013001,60013002,
								60014001,60014002,60014101,60014102,60014201,60014202,60015001,60015002,60015101,
								60015102,60015201,60015202,60015301,60015302,60016901,60016902,67010102,60012001,
								60012002,600501,600510,60051101,60051102,60051201,60051210,64010101,64010102,
								64010201,64010202,64011001,64011002,64011101,64011102,64011301,64011302,64053001,
								64053002,60101003,60101004,60101005,60101008,60101009,60101098,60101099,60103004,
								60104001,60104005,60107001,60107002,60107099,602030,602031,602099,60103005,603001,24010102,22400105,30500102,300099
							}
							nsql-FaAccounting.delLedgerCheckResult:{	"按日期删除分类帐检查结果-delete ledger check result by date"
								delete 
								from
										fab_ledger_check_result 	-- "分类科目检查结果-ledger account check result"
								where
										org_id = #org_id#
										and trxn_date = #trxn_date#
							},
							nsql-FaAccounting.updLedgerSeqStatus:{
								update
										fab_ledger_check_seq a 	-- "fab_ledger_check_seq-工厂分类帐检查"
								set
										a.analysis_state=#analysis_state# 	-- "2-已解析"
								where
										trxn_date=#trxn_date# and org_id=#org_id# and instr(#parm_value#||',', a.gl_code||',')<=0 
							},
							nsql-FaAccounting.insLedger:{	"插入外部系统的分类帐余额数据-inserting ledger balance data of external system"	//插入外系统分户账数据
								insert 
								into
										fab_ledger_check_result		-- "分类科目检查结果-ledger account check result"
										(
												org_id, sys_no, trxn_date, acct_branch, ccy_code, gl_code, ledger_bal_direction , ledger_acct_bal, gl_bal_direction, gl_acct_bal, ledger_check_result 
										) 
										select
												org_id, sys_no,	trxn_date,	acct_branch,ccy_code, gl_code, bal_type 		,sum(acct_bal) as acct_bal, bal_type, 0.00 as gl_acct_bal,0 as ledger_check_result
										from
												fab_ledger_check_seq a	-- "fab_ledger_check_seq-工厂分类帐检查"
										where
												trxn_date=#trxn_date# and org_id=#org_id# 
												and analysis_state='2' and a.accounting_subject<>'6'
												and instr(#parm_value#||',', a.gl_code||',')<=0 
										group by
												org_id,sys_no,trxn_date, acct_branch, ccy_code,
												gl_code,bal_type 
										union all
										select
												org_id, sys_no,trxn_date,acct_branch,ccy_code,
												gl_code, 'D' as bal_type ,sum(case when bal_type='D' then acct_bal else -acct_bal end) as acct_bal, 
												'D' as bal_type, 0.00 as gl_acct_bal,0 as ledger_check_result
										from
												fab_ledger_check_seq a	-- "fab_ledger_check_seq-工厂分类帐检查"
										where
												trxn_date=#trxn_date# and org_id=#org_id# 
												and analysis_state='2' and a.accounting_subject='6'
												and instr(#parm_value#||',', a.gl_code||',')<=0 
										group by
												org_id,sys_no,trxn_date, acct_branch, ccy_code,
												gl_code 
							},
							nsql-FaAccounting.updLedgerFromGL:{	"更新外部系统的分类帐余额数据-updating ledger balance data of external system"	//更新外系统分户账数据对应的总账余额
							},
							nsql-FaAccounting.updLedgeResult:{	"更新检查结果-updating the checking result"	//更新对账结果 
							},
							nsql-FaAccounting.updLedgerSeqStatus:{	"更新总分核对流水处理状态"	},
							resultList = nsql-FaAccounting.selLedgerFailure:{},
							for(cpl:resultList):{
								accountingSubjectList = nsql-FaAccounting.selSubjectFromLedger:{	"从会计科目检查中选择会计科目-selecting accounting subject from ledger check"	},
								nsql-FaAccounting.updLedgerSubject:{}
							},
							ledgerCheckError = select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_ERROR' and sub_key='*';
							if(null==ledgerCheckError||1=ledgerCheckError){
								select * from app_drop_list where dict_org_id = '' and drop_list_type='ACCOUNTING_SUBJECT';
								for(){
									select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_ERROR' and sub_key='#drop_list_type#';
								}
								nsql-FaAccounting.selLedgerFailureBySubject:{ "选择会计科目审核失败记录-selecting the record of checking failed by Accounting Subject"	
									select
											sys_no,trxn_date,acct_branch,ccy_code,ledger_bal_direction,
											ledger_acct_bal,gl_code,gl_bal_direction,gl_acct_bal,ledger_check_result 
									from
											Fab_ledger_check_result a 
									where
											a.trxn_date=#trxn_date# and a.org_id=#org_id# 
											and a.ledger_check_result='0' and exists(
													select
															b.parm_value
													from
															app_system_parameter b 
													where
															b.main_key='LEDGERC_CHECK_ERROR' 
															and b.parm_value='1' and instr(a.accounting_alias, b.sub_key||',')>0 
											) 
								}
							}
						}
					}
				}
			},
			gl21:{	"年末外币损益科目兑换系统上线日余额处理"
				getBatchDataWalker:{
					nsql-GlExchange.selGLvochCount:{
						select
								count(*) 
						from
								fab_teller_seq a 
						where
								a.trxn_code='gl21' and a.org_id=#org_id# and a.trxn_date=#trxn_date#
					},
					nsql-ApBasic.selCurrencyList:{	"查询货币参数列表"
						select * from app_currency where org_id='';
					}
				},
				process:{
					"data flow":{	
						from 	
						insert 	
						update 	
					},
					"key code":{
						"1.":{
							exchSuject = select parm_value from app_system_parameter where main_key='SETTLEMENT_SUBJECT' and sub_key='*';	"外币兑换科目"
							onlineDate = select parm_value from app_system_parameter where main_key='ONLINE_DATE' and sub_key='*';	"系统上线日期"
							GlYearEndTransProfit.exchangeSCY:{
								glb_exchange_rate exchangeRate = nsql-GlExchange.selExchRateOne:{	"查询汇率"	// 币种+日期查询汇率
								};
								// 外币损益类科目号的（借-贷）发生额轧差额
								selGlbranchBal = nsql-GlExchange.selGlbranchBal:{
									
								},
								for(glBal:selYearEndVochBal){
									FaAccounting.getAccountingCheckByAcct 	"Foreigncurrencyexchange"
								}
							}
						},
					}
				}
			},
			gl22:{	"年末外币损益科目兑换"
				getBatchDataWalker:{
					nsql-ApBasic.selCurrencyList:{	"查询货币参数列表"
						select * from app_currency where org_id='';
					}
				},
				process:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								GlYearEndTransProfit.exchangeSCY(exchSuject, trxnDate, lastDate,dataItem.getCcy_code(),false);
								nsql-GlExchange.updateAccountingVoch:{
									update
											fab_accounting_voch 	-- "会计凭证-accounting voucher"
									set
											valid_ind='Y' 	-- "有效标志"
									where
											trxn_date=#trxn_date# and trxn_ccy=#trxn_ccy#
								}
							},
						}
				}
			},
			glt23:{	"年末试算汇兑损益处理"
				getBatchDataWalker:{
					nsql-:{
						
					}
				},
				process:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								nsql-FaAccount.selExchangeSubject:{
									select
											* 
									from
											fap_accounting_subject 	-- "会计科目表"
									where
											org_id = #org_id# and end_gl_code_ind = 'Y' and gl_code like concat('3050' , '%')
								},
								for():{
									nsql-FaAccount.selConversionExchangePositionAmt:{
									},
									GlYearEndTransProfit.exchangeProfitAndLoss:{	"汇兑损益"	//将轧差的金额进行记账，一边记到原科目的发生，一边记到6030
										
									}
								}
							},
						}
				}
			},
			glt30:{	"生成~前y一清算"
				getBatchDataWalker:{},
				process:{
					GlSettle.prcSettlement();:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								lstPrepData = getSettlementData(trxnDate, settBatchNo, orgId);:{	/* 数据准备 */
									nsql-GlSettle.updGatherBatchNo:{
										UPDATE
												fab_teller_seq a 	-- "出纳员序列-teller sequence"
										SET
												a.sett_batch_no = #sett_batch_no# 	--	"settlement batch no"
										WHERE
												a.org_id= #org_id# AND a.trxn_date = #trxn_date# 
												AND a.sett_status = '2'		-- "清算状态-settlement status-BusinessType.E_SETTSTATE"	"2-NO_LIQUIDATION-未清算"
									},
									lstPrepData = nsql-GlSettle.selSettBatchNoList:{
										SELECT
												a.trxn_ccy as ccy_code, a.acct_branch, nvl(sum(case when a.debit_credit = 'D' then a.accounting_amt else - a.accounting_amt end ), 0) as accounting_amt 
										FROM
												fab_teller_seq b 	-- "出纳员序列-teller sequence"
										JOIN
												fab_accounting_voch a 		-- "会计凭证-accounting voucher"
														ON a.trxn_date = b.trxn_date AND a.trxn_seq = b.trxn_seq 
														AND a.org_id = b.org_id 
										WHERE
												b.org_id = #org_id# and b.trxn_date = #trxn_date# 
												and b.sett_batch_no = #sett_batch_no# AND a.on_bal_sheet_ind = 'Y' 	-- "资产负债表内指标-on balance sheet indicator"
												and b.sett_status='2' 		-- "清算状态-settlement status-BusinessType.E_SETTSTATE"	"2-NO_LIQUIDATION-未清算"
										GROUP BY
												a.trxn_ccy, a.acct_branch 
										ORDER BY
												a.trxn_ccy,
												a.acct_branch
									}
									if(settType=1){	//单点清算
										prcSinglePointSettle:{
											for(){
												prcSettlerBranch(settType, orgId, settBatchNo, cplData, settSubjectNo);{
													prcKeep:{	//记账
														FaAccounting.getAccountingCheckByAcct 	"branch settle"
													},
													regSettleBook(){
														insert into fab_settlement 	-- "结算登记表-settlement registration sheet"
													},
													nsql-GlSettle.updSettleBatchNo:{
														UPDATE
																fab_teller_seq a 	-- "出纳员序列-teller sequence"
														SET
																a.sett_batch_no = #sett_batch_no# 
														WHERE
																a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
																AND a.trxn_seq = #trxn_seq#
													}
												}
											}
										}
									}else{	
										prcMultiLevelSettle:{	//多级清算
											cplSettleData = genLevelData(lstData);:{	// 分解成层级清算数据
												for():{
													fap_branch_settlement	tabBranchSettlement	;	-- "清算关系组织结构"
												}
											},
											prcLevelSettle:{	"逐层清算"
												prcSettlerBranch(settType, orgId, settBatchNo, cplData);:{
													prcSettlerBranch(settType, orgId, settBatchNo, cplData, null);
												}
												addNewBranch():{
													cplOldBr.setAccounting_amt(cplOldBr.getAccounting_amt().add(amt));
												}
											}
											//零层机构不平衡 
										}	
									}
								}
							}
						}
					}
				}
			},
	*		glt35:{	"生成C~"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
	*			process:{
					"data flow":{	
						from 	
						insert 	
						update 	
					},
	*				"key code":{
						"1. "-GlBranch.prcBefore(orgId, trxnDate, dataItem.getBranch_id(), reportType);:{
							"1.1 总账清算检查"-checkSettleExistsByState(orgId, trxnDate);:{ //检查总账凭证是否已清算
								GlSettle.checkSettleExistsByState:{
									nsql-GlSettle.selSettleCountByState:{
										select
												count(*) 
										from
												fab_teller_seq 	 	-- "出纳员序列-teller sequence"
										where
												org_id = #org_id# and trxn_date = #trxn_date# 
												and sett_status = #sett_status# 	-- "2-NO_LIQUIDATION-未清算"
									}
									//日期[%s]存在有未清算的总账柜员流水
								},
								settFlatFlag = select parm_value from app_system_parameter where main_key='SETT_FLAT_FLAG' and sub_key='*';	//Y补平,N不补平
								// 是否补平标志为补平
								nsql-GlSettle.selSettleCountByStateNonExists:{
									select
											count(*) 
									from
											fab_teller_seq  	 	-- "出纳员序列-teller sequence"
									where
											org_id = #org_id# and trxn_date = #trxn_date# 
											and sett_status != #sett_status# and sett_status != '1'		
												Y:"4-已清算补平-LIGUIDATED_AND_FLATED"	// 是否存在清算状态不为'已清算补平'的数据
												N:"3-已清算待补平-LIGUIDATED_WAIT_FLAT"	// 是否存在清算状态不为'清算待补平'的数据
								}
								
							},
							"1.2 总账凭证平衡检查"-checkkVoucher(orgId, trxnDate, branchId);:{	//检查总账凭证是否平衡
								settFlatFlag = select parm_value from app_system_parameter where main_key='SETT_FLAT_FLAG' and sub_key='*';
								lstVochBalData = GlBranchDao.selVoucherNotBalList(orgId, trxnDate, settstatus, false);
								nsql-GlBranch.selVoucherNotBalList:{
									select
											b.trxn_ccy as ccy_code, 
											sum(case when b.debit_credit = 'D' then b.accounting_amt else 0.00 end ) as debit_amt, 
											sum(case when b.debit_credit = 'C' then b.accounting_amt else 0.00 end ) as credit_amt, 
											sum(case when b.debit_credit = 'D' then b.accounting_amt else 0 - b.accounting_amt end ) as accounting_amt 
									from
											fab_teller_seq a  	 	-- "出纳员序列-teller sequence"
									join
											fab_accounting_voch b  	-- "会计凭证-accounting voucher"
													on a.trxn_date = b.trxn_date and a.trxn_seq = b.trxn_seq 
													and a.org_id = b.org_id 
									where
											a.trxn_date = #trxn_date# and a.org_id = #org_id# 
											and a.sett_status = #sett_status# and b.on_bal_sheet_ind = 'Y' 
									group by
											b.trxn_ccy 
									having
											sum(case when b.debit_credit = 'D' then b.accounting_amt else 0 - b.accounting_amt end ) <> 0.00 
								}
							},
							"1.3 总账删除"-GlBranchDao.delBranchGl(orgId, trxnDate, branchId, reportType);:{	// 先删除（支持重复处理）
								nsql-GlBranch.delBranchGl:{
									delete 
									from
											gla_branch_gl 	--	"机构日总账"
									where
											trxn_date = #trxn_date# and org_id = #org_id# and branch_id = #branch_id#
											and report_type = '2'		-- "报表类型-BusinessType.E_REPORTTYPE"		"2-TRIAL_TYPE-试算表"
								}
							}
						},
	*					"2. "-GlBranch.genBranchGl(orgId, trxnDate, dataItem.getBranch_id(), reportType);:{
							GlBranchDao.insInitData(orgId, trxnDate, branchId, lastDate , report_type);:{	// 生成初始数据
								nsql-GlBranch.insInitData:{
									insert 
									into
									gla_branch_gl	--	"机构日总账"
									(
											org_id, report_type,trxn_date, branch_id, ccy_code, gl_code, on_bal_sheet_ind, prev_debit_bal, prev_credit_bal, 
											current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal, 
											data_create_user, data_create_time 
									) select
												a.org_id, '2', #trxn_date#, a.branch_id, a.ccy_code,	-- "报表类型-BusinessType.E_REPORTTYPE"		"2-TRIAL_TYPE-试算表"
												a.gl_code, a.on_bal_sheet_ind, a.current_debit_bal, a.current_credit_bal, 0.00,
												0.00, a.current_debit_bal, a.current_credit_bal, a.data_create_user, to_char(sysdate,
												'yyyyMMdd HH:mm:ss') 
										from
												gla_branch_gl a 	--	"机构日总账"
										where
												a.trxn_date = #last_date# and a.org_id = #org_id# and a.report_type = '1'	-- "报表类型-BusinessType.E_REPORTTYPE"		"1-BUSINETT_TYPE-业务报表"
												and a.branch_id = #branch_id# and a.current_debit_bal <> a.current_credit_bal
								},
								settFlatFlag = select parm_value from app_system_parameter where main_key='SETT_FLAT_FLAG' and sub_key='*';	//Y补平,N不补平
								lstTranData = GlBranchDao.selTranData(orgId, trxnDate, branchId, settState,  false);:{
									nsql-GlBranch.selTranData:{
										select
												b.trxn_ccy as ccy_code, b.gl_code, 
												sum(case when b.debit_credit = 'D' then b.accounting_amt else 0.00 end ) as debit_amt, 
												sum(case when b.debit_credit = 'C' then b.accounting_amt else 0.00 end ) as credit_amt 
										from
												fab_teller_seq a 		-- "出纳员序列-teller sequence"
										join
												fab_accounting_voch b   -- "会计凭证-accounting voucher"
														on a.trxn_date = b.trxn_date and a.trxn_seq = b.trxn_seq 
														and a.org_id = b.org_id 
										where
												a.trxn_date = #trxn_date# and a.org_id = #org_id# 
												and a.sett_status = #sett_status# and b.acct_branch = #branch_id# 
										group by
												b.trxn_ccy, b.gl_code
									}
								},
	*							for (GlTranData cplTran : lstTranData) {
									cplBal  = calSubjectBal(){	// 余额计算
										// 逻辑余额 = 上期借方 - 上期贷方 + 本期借方发生 - 本期贷方发生
									}
									insert/update gla_branch_gl;	--	"机构日总账"	
								},
								chkGlBal(orgId, report_type, trxnDate, branchId );:{	// 平衡检查
									nsql-GlBranch.selErrorBalData:{		"从指定日期获取不平衡数据-getting imbalance data from appointed date"	// 横向平衡检查，返回不平衡的总账信息 ,前三 条
										select  trxn_date, branch_id, ccy_code , gl_code,
										   prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal
										from gla_branch_gl a
									   where a.org_id = #org_id#
										 and a.report_type = '2'	-- "报表类型-BusinessType.E_REPORTTYPE"		"2-TRIAL_TYPE-试算表"
										 and a.trxn_date = #trxn_date#
										 and a.branch_id = #branch_id#
										 and a.prev_debit_bal - a.prev_credit_bal + a.current_debit_amt - a.current_credit_amt <> a.current_debit_bal - a.current_credit_bal
									}
								}
							}
						}
					}
				}
			},
		exchange:{	
			glt40:{	"生成折{C"		"折币"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
					GlExchange.prcExchange(orgId, trxnDate, reportType, dataItem.getBranch_id());:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1."-GlExchangeDao.insInitDataProcess(orgId, trxnDate, branchId, lastDate, report_type );:{	//从上日折合总账装载期初数据到折算过程表glb_exchange_process
								nsql-GlExchange.insInitDataProcess:{
									INSERT 
									INTO
											glb_exchange_process		-- "折算过程"
											(
													org_id, report_type, trxn_date, branch_id, report_branch_id, gl_code, 
													exchange_ccy_code, on_bal_sheet_ind, prev_debit_bal, prev_credit_bal,current_debit_amt,
													current_credit_amt, current_debit_bal,current_credit_bal, debit_adj_amt, credit_adj_amt, 
													debit_adj_err_amt,credit_adj_err_amt 
											) SELECT
													a.org_id, '2', #trxn_date#, a.branch_id, a.branch_id, a.gl_code,	-- "2-TRIAL_TYPE-试算表"
													a.exchange_ccy_code, b.on_bal_sheet_ind, a.current_debit_bal, a.current_credit_bal, 0.00,
													0.00, 0.00, 0.00, 0.00, 0.00,
													0.00, 0.00 
											FROM
													gla_exchange_gl a 		-- "折币总账"	
											JOIN
													fap_accounting_subject b 
															ON a.org_id = b.org_id AND a.gl_code = b.gl_code 
											WHERE
													a.org_id = #org_id# 
													AND a.trxn_date = #last_date# AND a.branch_id = #branch_id# 
													AND a.report_type = '1' AND b.valid_ind = 'Y'
								}
							},
							"2. "-prcExchangeBook(orgId, trxnDate, branchId, report_type);:{	// 按项目对折算过程表进行加工处理
								nsql-GlExchange.delDetailBuffer:{	// 先删除中间数据gla_exchange_ledger
									delete 
									from
											gla_exchange_ledger 	-- "折币明细账"
									where
											org_id = #org_id# and trxn_date = #trxn_date# 
											and branch_id = #branch_id# and report_type = '2'	-- "2-TRIAL_TYPE-试算表"
								},
								exchangeRateMode = select parm_value from app_system_parameter where main_key='EXCHANGE_RATE_MODE' and sub_key='*';	 -- default:"2-EXCHANGE_RATE_MODE_CORE"
								nsql-GlExchange.insDetailFromGL:{
									INSERT 
									INTO
											gla_exchange_ledger		-- "折币明细账"
											(
													org_id, report_type, trxn_date, branch_id, ccy_code, exchange_ccy_code, gl_code, on_bal_sheet_ind, exchange_rate, exchange_debit_amt, exchange_credit_amt, exchange_debit_bal, exchange_credit_bal
											) SELECT
													a.org_id, a.report_type, a.trxn_date, a.branch_id, a.ccy_code,
													b.exchange_ccy_code, a.gl_code, c.on_bal_sheet_ind, b.exchange_rate, 
													round(a.current_debit_amt * b.exchange_rate/b.exchange_rate_unit,2) as exchange_debit_amt, 
													round(a.current_credit_amt * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_credit_amt, 
													round(a.current_debit_bal * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_debit_bal,
													round(a.current_credit_bal * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_credit_bal 
											FROM
													gla_branch_gl a 	--	"机构日总账"
											JOIN
													glb_exchange_rate b 	-- "折算汇率（外管每日中间价）"
															ON b.org_id = a.org_id AND b.trxn_date = a.trxn_date 
															AND b.ccy_code = a.ccy_code 
											JOIN
													fap_accounting_subject c 
															ON c.gl_code = a.gl_code 
											WHERE
													a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
													AND a.branch_id = #branch_id# AND a.report_type = '2' 	-- "2-TRIAL_TYPE-试算表"
													AND c.valid_ind = 'Y'
								},
								nsql-GlExchange.insDetailFromGL2:{
									INSERT 
									INTO
											gla_exchange_ledger		-- "折币明细账"
											(
													org_id, report_type, trxn_date, branch_id, ccy_code, exchange_ccy_code, gl_code, on_bal_sheet_ind, exchange_rate, exchange_debit_amt, exchange_credit_amt, exchange_debit_bal, exchange_credit_bal 
											) SELECT
													a.org_id, a.report_type, a.trxn_date, a.branch_id, a.ccy_code,
													b.exchange_ccy_code, a.gl_code, c.on_bal_sheet_ind, b.exchange_rate, 
													round(a.current_debit_amt * b.exchange_rate/b.exchange_rate_unit,2) as exchange_debit_amt, 
													round(a.current_credit_amt * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_credit_amt, 
													round(a.current_debit_bal * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_debit_bal,
													round(a.current_credit_bal * b.exchange_rate/b.exchange_rate_unit, 2) as exchange_credit_bal 
											FROM
													gla_branch_gl a 	--	"机构日总账" 
											JOIN
													glb_exchange_rate b  	-- "折算汇率（外管每日中间价）"
															ON b.org_id = a.org_id 
															AND b.ccy_code = a.ccy_code 
											JOIN
													fap_accounting_subject c 
															ON c.gl_code = a.gl_code 
											WHERE
													a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
													AND a.branch_id = #branch_id# AND a.report_type = '2' 	-- "2-TRIAL_TYPE-试算表" 
													AND c.valid_ind = 'Y' 
													and b.trxn_date = (
															select
																	max(trxn_date) 
															from
																	glb_exchange_rate d 	-- "折算汇率（外管每日中间价）"
															where
																	d.ccy_code=b.ccy_code 
																	and d.exchange_ccy_code=b.exchange_ccy_code and d.org_Id = b.org_id 
																	and d.trxn_date<=#trxn_date#
													) 
								},
								lstExchangeGL = nsql-GlExchange.selExchangeData:{	// 将gla_exchange_ledger 做汇总，开始折算处理
									SELECT
											gl_code, exchange_ccy_code, on_bal_sheet_ind, sum(exchange_debit_amt) as exchange_debit_amt, sum(exchange_credit_amt) as exchange_credit_amt,
											sum(exchange_debit_bal) as exchange_debit_bal, sum(exchange_credit_bal) as exchange_credit_bal 
									FROM
											gla_exchange_ledger a 
									WHERE
											org_id = #org_id# AND trxn_date = #trxn_date# 
											AND branch_id = #branch_id# AND report_type = '2'	-- "2-TRIAL_TYPE-试算表" 
									GROUP BY
											gl_code, exchange_ccy_code, on_bal_sheet_ind 
								},
								for (GlExchangeGL cplInfo : lstExchangeGL) {
									prcExchangeProfitLoss(orgId, trxnDate, branchId, cplInfo, report_type);:{	/* 更新折合过程登记簿 */
										exchangeFlatSubject = select parm_value from app_system_parameter where main_key='EXCHANGE_FLAT_SUBJECT' and sub_key='*';	//折算补平科目参数
										setAmountToZero(tabExchangeProcess);:
										insert/update glb_exchange_process;		-- "折算过程"
									}
								}
							}
						}
					}
				}
			},
	*-cal	glt41:{	"折潘挝迦胝`差a平"
				getBatchDataWalker:{},
				process:{
					GlExchange.prcFillBal(orgId, trxnDate, reportType);:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								exchangeFlatErrorSubject = select parm_value from app_system_parameter where main_key='EXCHANGE_ERROR_FLAT_SUBJECT' and sub_key='*';	//获取折算差额科目
								exCcyList = ApDropList.getItems(FaConst.EX_CCY_CODE);
									select * from app_drop_list where dict_org_id = '' and drop_list_type='EXCHANGE_CCY_CODE';
								for{
									prcMultiFillBal(orgId, trxnDate, report_type, cplInfo.getDrop_list_value(), exchangeFlatErrorSubject);:{	//逐层补平
										for{
											prcFillBalBranch(orgId, trxnDate, cplInfo.getBranch_id(), report_type, exchangeCcyCode, exchangeFlatErrorSubject);:{
	*-cal										bigErrorAmt = nsql-GlExchange.selFillAmount:{	// 扎差金额（总借减去总贷）
													SELECT
															nvl(sum(a.current_debit_amt + a.debit_adj_amt - a.current_credit_amt - a.credit_adj_amt), 0.00) as debit_adj_err_amt 
													FROM
															glb_exchange_process a 		-- "折算过程"
													WHERE
															a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
															AND a.exchange_ccy_code = #exchange_ccy_code# AND a.branch_id = #branch_id# 
															AND a.report_type = #report_type# AND a.on_bal_sheet_ind = 'Y'
												}
												insert/update glb_exchange_process;		-- "折算过程"
											}
										}
									},
									GlExchangeDao.insExchangeVochByFill(orgId, trxnDate, report_type, cplInfo.getDrop_list_value() );:{	// 将平补数据转化成传票
										nsql-GlExchange.insExchangeVochByFill:{
											INSERT 
											INTO
													glb_exchange_voch	-- "折币种凭证"
													(
															org_id, report_type, trxn_date, reg_no, exchange_ccy_code, 
															branch_id, gl_code, debit_credit, accounting_amt, remark, on_bal_sheet_ind 
													) SELECT
															a.org_id, a.report_type, a.trxn_date, 17, a.exchange_ccy_code,
															a.branch_id, a.gl_code, 'D', a.debit_adj_err_amt, 'rounding rate exchange' ,
															a.on_bal_sheet_ind 
													from
															glb_exchange_process a 	-- "折算过程"
													WHERE
															a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
															AND a.exchange_ccy_code = #exchange_ccy_code# AND a.report_type = #report_type# 
															AND a.debit_adj_err_amt <> 0.00 
													UNION
													ALL SELECT
															a.org_id, a.report_type, a.trxn_date, 18, a.exchange_ccy_code,
															a.branch_id, a.gl_code, 'C', a.credit_adj_err_amt, 'rounding rate exchange',
															a.on_bal_sheet_ind 
													from
															glb_exchange_process a -- "折算过程"
													WHERE
															a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
															AND a.exchange_ccy_code = #exchange_ccy_code# AND a.report_type = #report_type# 
															AND a.credit_adj_err_amt <> 0.00
										}
									}
								},
								checkVoucher(orgId, trxnDate, report_type);:{	// 对折合传票做平衡性检查
									lstVochBalData = GlExchange.selVoucherNotBalList:{
	*-cal								SELECT
												a.exchange_ccy_code as ccy_code, 
												sum(case when a.debit_credit = 'D' then a.accounting_amt else 0.00 end ) as debit_amt, 
												sum(case when a.debit_credit = 'C' then a.accounting_amt else 0.00 end ) as credit_amt, 
												sum(case when a.debit_credit = 'D' then a.accounting_amt else 0 - a.accounting_amt end ) as accounting_amt 
										FROM
												glb_exchange_voch a 	-- "折币种凭证"
										WHERE
												a.org_id = #org_id# AND a.trxn_date = #trxn_date# 
												AND a.report_type = #report_type# And a.on_bal_sheet_ind = 'Y' 
										GROUP BY
												a.exchange_ccy_code 
										HAVING
												sum(case when a.debit_credit = 'D' then a.accounting_amt else 0 - a.accounting_amt end ) <> 0.00
									},
									throw GlErr.GL.E0075(trxnDate, ccyCode);  //
								}
							}
						}
					}
				}
			},
			glt45:{	"生成折趴~"
				getBatchDataWalker:{
					GlExchange.prcExchangeGlBefore(orgId, trxnDate, report_type);:{
						checkVoucher(orgId, trxnDate, report_type);	// 对折合传票做平衡性检查
						nsql-GlExchange.delExchangeGL:{
							delete 
							from
									gla_exchange_gl 	-- "折币总账"
							where
									trxn_date = #trxn_date# and org_id = #org_id# 
									and report_type = '2'		-- "2-TRIAL_TYPE-试算表"
						}
					},
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
					GlExchange.genExchangeGl(orgId, trxnDate, dataItem.getBranch_id(), reportType);:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								GlExchangeDao.insInitDataGl(orgId, trxnDate, branchId, lastDate, report_type);:{	// 生成初始数据
									nsql-GlExchange.insInitDataGl:{
										insert 
										into
										gla_exchange_gl	-- "折币总账"
												( org_id, report_type, trxn_date, branch_id, exchange_ccy_code, gl_code, 
													prev_debit_bal, prev_credit_bal, current_debit_amt, 
													current_credit_amt, current_debit_bal,current_credit_bal ) 
												select
														a.org_id, #report_type#, #trxn_date#, a.branch_id, a.exchange_ccy_code, a.gl_code, 		-- "2-TRIAL_TYPE-试算表" 
														a.current_debit_bal, a.current_credit_bal, 0.00, 
														0.00, a.current_debit_bal, a.current_credit_bal 
												from
														gla_exchange_gl a 	-- "折币总账"
												where
														a.trxn_date = #last_date# and a.org_id = #org_id# 
														and a.branch_id = #branch_id# and a.report_type = '1' 
														and a.current_debit_bal <> a.current_credit_bal 
									}
								},
								lstTranData = GlExchangeDao.selGlTranData(orgId, trxnDate, branchId, report_type, false);:{
									select
											a.exchange_ccy_code as ccy_code, a.gl_code, 
											sum(case when a.debit_credit = 'D' then a.accounting_amt else 0.00 end ) as debit_amt, 
											sum(case when a.debit_credit = 'C' then a.accounting_amt else 0.00 end ) as credit_amt 
									from
											glb_exchange_voch a 	-- "折币种凭证"
									where
											a.trxn_date = #trxn_date# and a.org_id = #org_id# 
											and a.branch_id = #branch_id# and a.report_type = #report_type# 	-- "2-TRIAL_TYPE-试算表" 
									group by
											a.exchange_ccy_code, a.gl_code 
								},
								GlBranch.calSubjectBal();{}
								chkExchangeGlBal(orgId, report_type, trxnDate, branchId );:{
									// 平衡检查
								}
							},
						}
					}
				}
			},
		},
		report:{
			glt50:{	"I湛~生成前理"
				getBatchDataWalker:{},
				process:{
					GlGeneralLedger.prcBusiGlBefore(orgId, trxnDate, report_type);;:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								GlGeneralLedgerDao.delReportGl(orgId, report_type, trxnDate);:{
									nsql-GlGeneralLedger.delReportGl:{
										delete 
										from
												glb_gl_report 	-- "总账报表-general ledger report"
										where
												org_id = #org_id# and report_type = '2'		-- "2-试算表" 
												and trxn_date = #trxn_date# 
									}
								}
							}
						}
					}
				}
			},
			glt51:{	"生成I湛~-~C"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
					GlGeneralLedger.genBusiGL(orgId, reportType, trxnDate, dataItem.getBranch_id());:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.总账日报"-genReport(orgId, trxnDate, branchId, E_GLDATEINTERVAL.DAILY, report_type);:{	// 生成总账日报数据
								loadBuisGlInit(orgId, trxnDate, branchId, dateInterval, report_type);:{	// 将上日总账初始化到总账表
									switch(1){	"1-DAILY-日总账"}
									nsql-GlGeneralLedger.insInitReportData:{
										insert into glb_gl_report(	-- "总账报表-general ledger report"
											  org_id, report_type, trxn_date, branch_id, gl_date_interval, ccy_code, 
											  gl_code, on_bal_sheet_ind, gl_code_level, gl_code_desc, simple_list_display_ind, end_gl_code_ind, 
											  prev_debit_bal, prev_credit_bal, current_debit_amt, current_credit_amt, current_debit_bal, current_credit_bal 
											   )
									   select a.org_id, #report_type#, #trxn_date#, a.branch_id, #gl_date_interval#, a.ccy_code,
											  a.gl_code, a.on_bal_sheet_ind, a.gl_code_level, b.gl_code_desc, b.simple_list_display_ind, b.end_gl_code_ind,
											  a.current_debit_bal, a.current_credit_bal, 0.00, 0.00, a.current_debit_bal, a.current_credit_bal
										 from glb_gl_report a	-- "总账报表-general ledger report"
											  JOIN fap_accounting_subject b
												ON a.gl_code = b.gl_code and a.org_id=b.org_id
										where a.trxn_date = #last_date#
										  AND a.org_id = #org_id#
										  AND a.gl_date_interval = '1'
										  AND a.branch_id = #branch_id#
										  AND a.report_type = '1'
										  AND a.current_debit_bal <> a.current_credit_bal
										  AND b.end_gl_code_ind = 'Y'
										  AND b.valid_ind = 'Y'
									}
								}
							},
							"2.总账日报特殊日期"-genInterval(orgId, trxnDate, branchId, report_type);：{	// 生成特殊日期总账
								genReport(orgId, trxnDate, branchId, E_GLDATEINTERVAL.MONTHLY, report_type);
							}
						}
					}
				}
			},
			glt52:{	"生成I湛~-蟊C"
				getBatchDataWalker:{},
				process:{
					GlGeneralLedger.genReportGL(orgId, reportType, trxnDate);：{	//逐级向上统计
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
								reportRelation = select parm_value from app_system_parameter where main_key='REPORT_RELATION' and sub_key='*';	// 报表关系代码参数
								tabRelations = nsql-GlBranch.selReportBrch:{
									select
											* 
									from
											app_branch_relation a 	-- "机构关系声明"
									where
											a.brch_relation_code like concat(concat('%',#brch_relation_code#),'%')
								},
								for(:tabRelations):{
									select parm_value from app_system_parameter where main_key='BANK_BASE_CCY' and sub_key='*';
									nsql-ApBranch.selBranchRoot:{
										select
												branch_id 
										from
												apb_branch_relation 	-- "机构关系数据"
										where
												org_id=#org_id# and brch_relation_code=#brch_relation_code# 
												and ccy_code=#ccy_code# and parent_brch_id is null
									},
									for(i--){
										brchList = nsql-ApBranch.selBranchListByLevel:{
											select
													b.parent_brch_id,a.child_brch_id 
											from
													apb_branch_junior a 	-- "机构下级数据一览"
											join
													apb_branch_relation b 	-- "机构关系数据"
															on a.org_id=b.org_id and a.child_brch_id=b.branch_id 
															and a.brch_relation_code=b.brch_relation_code and a.ccy_code=b.ccy_code 
											where
													a.org_id=#org_id# 
													and a.brch_relation_code=#brch_relation_code# and a.branch_id=#branch_id# 
													and a.ccy_code=#ccy_code# and a.brch_level=#brch_level# 
										},
										for (ApBranchSeniorJunior cplInfo : brchList) {
											nsql-GlGeneralLedger.insReportGlData:{
												insert 
												into
														glb_gl_report	-- "总账报表-general ledger report"
														( org_id, report_type, trxn_date, branch_id, gl_date_interval, ccy_code, gl_code, 
															on_bal_sheet_ind, gl_code_level, gl_code_desc, simple_list_display_ind, end_gl_code_ind, 
															prev_debit_bal, prev_credit_bal, current_debit_amt, 
															current_credit_amt, current_debit_bal, current_credit_bal ) 
														select
																#org_id# as org_id, #report_type# as report_type , #trxn_date# as trxn_date, #parent_brch_id# as branch_id, a.gl_date_interval, a.ccy_code, a.gl_code, 
																a.on_bal_sheet_ind, a.gl_code_level, a.gl_code_desc,a.simple_list_display_ind, a.end_gl_code_ind, 
																sum(a.prev_debit_bal) as prev_debit_bal, sum(a.prev_credit_bal) as prev_credit_bal, sum(a.current_debit_amt) as current_debit_amt,
																sum(a.current_credit_amt) as current_credit_amt, sum(a.current_debit_bal) as current_debit_bal, sum(a.current_credit_bal) as current_credit_bal 
														from
																glb_gl_report a 	-- "总账报表-general ledger report"
														join
																apb_branch_senior b 
																		on a.org_id = b.org_id and a.branch_id = b.branch_id 
														where
																a.org_id = #org_id# 
																and a.trxn_date = #trxn_date# and a.report_type = #report_type# 
																and b.parent_brch_id = #parent_brch_id# and b.brch_relation_code = #brch_relation_code# 
																and b.ccy_code = #ccy_code# 
														group by
																a.gl_date_interval,a.ccy_code,a.gl_code,
																a.on_bal_sheet_ind,a.gl_code_level,a.gl_code_desc,a.simple_list_display_ind,a.end_gl_code_ind
											}
										}
									}
								}
							}
						}
					}
				}
			},
			glt55:{	"生成三大蟊-~C"
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
					GlReports.genThreeReportsMain(orgId, E_REPORTTYPE.TRIAL_TYPE, reportNameList, trxnDate, dataItem.getBranch_id());:{ //生成三大报表，资产负债表，损益明细表，利润表
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1. init data":{	// 计算把各个报表数据，将计算结果插入 报表计算结果 表中
								for(){	"BusinessType.E_REPORTNAME"	{"1-资产负债表-THE_BALANCE_SHEET","2-损益明细表-INCOME_STATEMENT","3-利润表-PROFIT_SHEET"}
									genReport(reportName, orgId, reportType, trxnDate, branchId);:{
										nsql-GlReport.delReportCalResult:{	// 删除T日数据
											delete 
											from
													glb_report_calc_result a 	-- "总账报表计算结果-general ledger report calculation result"
											where
													a.report_name=#report_name# and a.report_type=#report_type# 
													and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
													and a.org_id = #org_id#
										},
										nsql-ApBasic.selCurrencyList:{
											select * from app_currency
										},
										select * from app_drop_list where dict_org_id = '' and drop_list_type='EXCHANGE_CCY_CODE';
										for (String ccyCode : ccyCodeList) {
											nsql-GlReport.selCountsFromReport:{
												select
														count(*) 
												from
														dual 
												where
														exists(
																select
																		1 
																from
																		glb_gl_report a		-- "总账报表-general ledger report" 
																where
																		a.org_id=#org_id# and a.report_type=#report_type# 
																		and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
																		and a.ccy_code=#ccy_code# 
																and a.gl_date_interval in ('1','2')	-- "总账日期间隔-general ledger date interval-BusinessType.E_GLDATEINTERVAL"
																	"1-日总账-DAILY"	"2-月总账-MONTHLY"
																and( current_debit_amt<>0.00 or
																current_credit_amt<>0.00 or
																current_debit_bal<>0.00 or
																current_credit_bal<>0.00
																)
														)
											},
											reportDefines = nsql-GlReport.selReprotDefine:{
												select
														* 
												from
														glp_report_define a 	-- "总账报表数据定义-general ledger report data define"
												where
														a.report_name=#report_name# and a.org_id=#org_id# 
														and a.item_data_type in (	"BusinessType.E_ITEMDATATYPE"
																'2','3'		"2-DATA_ELEMENT-数据项"	"3-CACULATE-计算项"
														) 
												order by
														a.report_item_calc_level ,a.report_item_column,a.report_item_line
											},
											for(){
												genReportDetail(reportDefine, yearEndInd, reportDetailCalIn);:{
													insert glb_report_calc_result ;
												}
											}
										}
									}
								}
							},
						}
					}
				}
			},
		}
		glt55	生成三大蟊-~C
		glt56	生成三大蟊-蟊C
		gl85	~蟊砩成（Ya表）
		gl86	~蟊砩成（表缺硗IIr表）
		gl87	~蟊砩成（p益明表）
		gl88	表IIr表
		gl89	表外IIr表
		gl90	折算^程表

	},
	2-gl-day:{
		check0:{
			gl02-'计提数据文件导入':{
				process:{
						method-GlFile.doAccureFile-'null':{
							method-ApSystemParm.getIntValue-'null':{	"EOD_SLEEP_TIME"	"WAIT_FILE_DOWN"
								method-ApSystemParm.getValue-'null':{	
									table-app_system_parameter-select-'系统杂项参数'
								}
							},
							method-ApOrg.getReferenceOrgId-'null':{		"TabApFile.apb_batch_receive.class"		
								method-BizUtil.getTrxRunEnvs-'null',
								method-BizUtil.isOrgRelated-'null',
								table-app_parameter_reference-select-'参数引用定义',
								table-app_parameter_reference-select-'参数引用定义',
								method-BizUtil.isParmTable-'null',
								method-ApOrg.getOrgInfo-'null':{
									table-app_organization-select-'法人信息'
								},
								method-ApOrg.getOrgInfo-'null':{
									table-app_organization-select-'法人信息'
								}
							},
							nsql-GlFile.selFileLoanDown-S-apb_batch_request-select,apb_batch_receive-select-'file download':{
								"E_BATCHTYPE.ACCRUE_DOWN"	"E_FILEDEALSTATUS.UNCHECK"	"E_YESORNO.YES"	
								select
										a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path 
								from
										apb_batch_request a 
								join
										apb_batch_receive b 
								on      a.request_file_id = b.file_id
								where
										a.org_id = '99'
										and a.busi_batch_type = 'F' 
										and a.file_handling_status = 'A'
										and b.receive_ind = 'Y' 
							},
							method-BizUtil.getTrxRunEnvs-'null',
							method-BizUtil.getTrxRunEnvs-'null',
							method-BizUtil.getTrxRunEnvs-'null',
							method-ApSystemParm.getValue-'null':{
								table-app_system_parameter-select-'系统杂项参数'
							},
							table-apb_batch_request-select-'文件批量请求薄',
							method-ApFile.getFileFullPath-'null':{
								method-ApFile.getFullPath-'null':{
									method-ApFile.exists-'null':{
										method-ApDropList.exists-'null':{
											method-ApDropList.getItem-'null':{
												table-app_drop-select-'字典声明表',
												method-ApOrg.getDefaultOrgId-'null',
												table-app_drop_list-select-'下拉字典参数',
												method-ApOrg.getReferenceOrgId-'null',
												table-app_drop_list-select-'下拉字典参数',
												method-ApOrg.getDefaultOrgId-'null',
												table-app_drop_list-select-'下拉字典参数'
											}
										},
										table-app_directory-select-'文件目录配置'
									},
									method-ApFile.genFileName-'null':{
										table-app_directory-select-'文件目录配置',
										method-BizUtil.getTrxRunEnvsValue-'null':{
											method-BizUtil.getTrxRunEnvs-'null',
											method-BizUtil.getTrxRunEnvs-'null',
											method-BizUtil.invoke-'null':{
												table-app_service-select-'内部服务控制定义',
												return method-BizUtil.callServiceDirect-'null',
												return method-BizUtil.callService-'null'
											}
										}
									}
								}
							},
							method-ApFile.getFileFullPath-'null':{
								method-ApFile.getFullPath-'null':{
									method-ApFile.exists-'null':{
										method-ApDropList.exists-'null':{
											method-ApDropList.getItem-'null':{
												table-app_drop-select-'字典声明表',
												method-ApOrg.getDefaultOrgId-'null',
												table-app_drop_list-select-'下拉字典参数',
												method-ApOrg.getReferenceOrgId-'null',
												table-app_drop_list-select-'下拉字典参数',
												method-ApOrg.getDefaultOrgId-'null',
												table-app_drop_list-select-'下拉字典参数'
											}
										},
										table-app_directory-select-'文件目录配置'
									},
									method-ApFile.genFileName-'null':{
										table-app_directory-select-'文件目录配置',
										method-BizUtil.getTrxRunEnvsValue-'null':{
											method-BizUtil.getTrxRunEnvs-'null',
											method-BizUtil.getTrxRunEnvs-'null',
											method-BizUtil.invoke-'null':{
												table-app_service-select-'内部服务控制定义',
												return method-BizUtil.callServiceDirect-'null',
												return method-BizUtil.callService-'null'
											}
										}
									}
								}
							},
							method-ApFile.getLocalHome-'null':{
								return method-BizUtil.convertParmString-'null',
								return method-ApSystemParm.getValue-'null':{
									table-app_system_parameter-select-'系统杂项参数'
								}
							},
							method-ApFile.readFile-'null',
							method-ApBatch.setFormatErrorByImport-'null':{
								table-apb_batch_request-select-'文件批量请求薄',
								table-apb_batch_request-update-'文件批量请求薄'
							},
							method-BizUtil.getTrxRunEnvs-'null',
							method-ApTrxn.getSerial-'null':{
								method-BizUtil.getTrxRunEnvs-'null',
								method-BizUtil.getTrxRunEnvs-'null'
							},
							table-fap_accounting_event_parm-select-'business accounting event parameter',
							method-GlRegBook.regOriginalaVochFromAccrue-'null':{
								method-BizUtil.getTrxRunEnvs-'null',
								table-fab_original_vochDao-batchInsert
							},
							table-fab_accrueDao-batchInsert,
							method-DBUtil.rollBack-'null',
							method-ApBatch.setInsertErrorByImport-'null':{
								table-apb_batch_request-select-'文件批量请求薄',
								table-apb_batch_request-update-'文件批量请求薄'
							},
							table-fab_accrueDao-batchInsert,
							method-DBUtil.rollBack-'null',
							method-ApBatch.setInsertErrorByImport-'null':{
								table-apb_batch_request-select-'文件批量请求薄',
								table-apb_batch_request-update-'文件批量请求薄'
							},
							method-ApOrg.getReferenceOrgId-'null':{
								method-BizUtil.getTrxRunEnvs-'null',
								method-BizUtil.isOrgRelated-'null',
								table-app_parameter_reference-select-'参数引用定义',
								table-app_parameter_reference-select-'参数引用定义',
								method-BizUtil.isParmTable-'null',
								method-ApOrg.getOrgInfo-'null':{
									table-app_organization-select-'法人信息'
								},
								method-ApOrg.getOrgInfo-'null':{
									table-app_organization-select-'法人信息'
								}
							},
							method-BizUtil.getTrxRunEnvs-'null',
							nsql-GlFile.selFileHeadInfoFromAccure-S-fab_accrue-select-'getting file head from accrued table',
							method-ApBatch.returnStatusByImport-'null':{
								table-apb_batch_request-select-'文件批量请求薄',
								table-apb_batch_request-select-'文件批量请求薄',
								table-apb_batch_request-update-'文件批量请求薄',
								table-apb_batch_request-update-'文件批量请求薄'
							}
						}
				},
			},
			gl08:{	"总账日终前检查" "GL EOD before check"
				getBatchDataWalker:{},
				process:{
					GlCheck.prcEodBefore(ApOrg.getReferenceOrgId(app_date.class), false);
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
							},
							"3.check":{
								nsql-GlRegBook.selCountLedgerCheckSeq:{	"获取汇总分类帐科目检查序列的数量" "getting the amount of summarized ledger account check sequence"
									select
											count(*) 
									from
											fab_ledger_check_seq 
									where
											org_id=#org_id# and trxn_date =#trxn_date# and analysis_state <> '2'
									
								},
								nsql-GlRegBook.selCountLedgerCheckResult:{	""
									select
											count(*) 
									from
											fab_ledger_check_result 
									where
											org_id=#org_id# and trxn_date =#trxn_date# and ledger_check_result <> '1'
								}
							}
						}
				}
			}
			gl20:{	"总分核对"
				getBatchDataWalker:{},
				process:{
					"data flow":{	
						from 	
						insert 	
						update 	
					},
					"key code":{
						"1.":{	'获得需要核算的gl_code'
							ledgerCheckNoGlCode = select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_NO_GL_CODE' and sub_key='800';	-- "FaConst.CORE_SYSTEM"
							{
								,60010101,60010102,60010201,60010202,60010301,60010302,60010401,60010402,60010501,
								60010502,60010601,60010602,60010701,60010702,60012901,60012902,60013001,60013002,
								60014001,60014002,60014101,60014102,60014201,60014202,60015001,60015002,60015101,
								60015102,60015201,60015202,60015301,60015302,60016901,60016902,67010102,60012001,
								60012002,600501,600510,60051101,60051102,60051201,60051210,64010101,64010102,
								64010201,64010202,64011001,64011002,64011101,64011102,64011301,64011302,64053001,
								64053002,60101003,60101004,60101005,60101008,60101009,60101098,60101099,60103004,
								60104001,60104005,60107001,60107002,60107099,602030,602031,602099,60103005,603001,24010102,22400105,30500102,300099
							}
							for(String strGlcode:ledgerCheckNoGlCode){		'把每一个gl_code对应的子科目信息查出来,重新拼接'
								ledgerCheckNoGlCode/parm_value
								nsql-FaAccounting.selLedgerNoCheckGlCode:{
									select
											* 
									from
											fap_accounting_subject 
									where
											org_id=#org_id# and gl_code like concat(#gl_code#,'%')
								}
							}
							'nsql-FaAccounting.delLedgerCheckResul':{	"按日期删除分类帐检查结果-delete ledger check result by date"
								delete 
								from
										fab_ledger_check_result 	-- "分类科目检查结果-ledger account check result"
								where
										org_id = #org_id#
										and trxn_date = #trxn_date#
							},
							'nsql-FaAccounting.updLedgerSeqStatus':{
								update
										fab_ledger_check_seq a 	-- "fab_ledger_check_seq-工厂分类帐检查"
								set
										a.analysis_state=#analysis_state# 	-- "2-已解析"
								where
										trxn_date=#trxn_date# and org_id=#org_id# and instr(#parm_value#||',', a.gl_code||',')<=0 
							},
							nsql-FaAccounting.insLedger:{	"插入外部系统的分类帐余额数据-inserting ledger balance data of external system"	//插入外系统分户账数据
								insert 
								into
										fab_ledger_check_result		-- "分类科目检查结果-ledger account check result"
										(
												org_id, sys_no, trxn_date, acct_branch, ccy_code, gl_code, ledger_bal_direction , ledger_acct_bal, gl_bal_direction, gl_acct_bal, ledger_check_result 
										) 
										select
												org_id, sys_no,	trxn_date,	acct_branch,ccy_code, gl_code, bal_type 		,sum(acct_bal) as acct_bal, bal_type, 0.00 as gl_acct_bal,0 as ledger_check_result
										from
												fab_ledger_check_seq a	-- "fab_ledger_check_seq-工厂分类帐检查"
										where
												trxn_date=#trxn_date# and org_id=#org_id# 
												and analysis_state='2' and a.accounting_subject<>'6'
												and instr(#parm_value#||',', a.gl_code||',')<=0 
										group by
												org_id,sys_no,trxn_date, acct_branch, ccy_code,
												gl_code,bal_type 
										union all
										select
												org_id, sys_no,trxn_date,acct_branch,ccy_code,
												gl_code, 'D' as bal_type ,sum(case when bal_type='D' then acct_bal else -acct_bal end) as acct_bal, 
												'D' as bal_type, 0.00 as gl_acct_bal,0 as ledger_check_result
										from
												fab_ledger_check_seq a	-- "fab_ledger_check_seq-工厂分类帐检查"
										where
												trxn_date=#trxn_date# and org_id=#org_id# 
												and analysis_state='2' and a.accounting_subject='6'
												and instr(#parm_value#||',', a.gl_code||',')<=0 
										group by
												org_id,sys_no,trxn_date, acct_branch, ccy_code,
												gl_code 
							},
							nsql-FaAccounting.updLedgerFromGL:{	"更新外部系统的分类帐余额数据-updating ledger balance data of external system"	//更新外系统分户账数据对应的总账余额
									update
											Fab_ledger_check_result a 
									set
											a.gl_bal_direction=(select
														case when b.bal_update_date>#trxn_date# then b.previous_bal_direction else b.bal_direction end
												from
														faa_account b 
												where
														a.org_id=b.org_id and a.sys_no=b.sys_no 
														and a.acct_branch=b.acct_branch and a.ccy_code=b.ccy_code 
														and a.gl_code=b.gl_code and b.acct_type='1' ), 
											a.gl_acct_bal=(select 
														case when b.bal_update_date>#trxn_date# then b.previous_acct_bal else b.acct_bal end
												from
														faa_account b 
												where
														a.org_id=b.org_id 
														and a.sys_no=b.sys_no and a.acct_branch=b.acct_branch 
														and a.ccy_code=b.ccy_code and a.gl_code=b.gl_code 
														and b.acct_type='1' ) 
									where
											a.org_id=#org_id# and a.trxn_date=#trxn_date# and exists(
													select
															1 
													from
															faa_account b 
													where
															a.org_id=b.org_id 
															and a.sys_no=b.sys_no and a.acct_branch=b.acct_branch 
															and a.ccy_code=b.ccy_code and a.gl_code=b.gl_code 
															and b.acct_type='1' 
											) 
							},
							nsql-FaAccounting.updLedgeResult:{	"更新检查结果-updating the checking result"	//更新对账结果 
							    	update
											Fab_ledger_check_result a 
									set
											a.ledger_check_result='1'
									where
											a.trxn_date=#trxn_date# and a.org_id=#org_id# 
											and (
												(
													a.ledger_bal_direction=a.gl_bal_direction and a.ledger_acct_bal=a.gl_acct_bal 
													or 
													a.ledger_acct_bal=a.gl_acct_bal and a.ledger_acct_bal=0.00
												)or (
													(case when a.ledger_bal_direction='D' then a.ledger_acct_bal else -a.ledger_acct_bal end) 
													= 
													(case when a.gl_bal_direction='D' then a.gl_acct_bal else -a.gl_acct_bal end)  
												)
											)
							},
							nsql-FaAccounting.updLedgerSeqStatus:{	"更新总分核对流水处理状态"	},
							resultList = nsql-FaAccounting.selLedgerFailureBySubject:{	'selecting the record of checking failed by Accounting Subject'
								select
										sys_no,trxn_date,acct_branch,ccy_code,ledger_bal_direction,
										ledger_acct_bal,gl_code,gl_bal_direction,gl_acct_bal,ledger_check_result 
								from
										Fab_ledger_check_result a 
								where
										a.trxn_date='20210620' and a.org_id='99' 
										and a.ledger_check_result='0' and exists(
												select
														b.parm_value
												from
														app_system_parameter b 
												where
														b.main_key='LEDGERC_CHECK_ERROR' 
														and b.parm_value='1' and instr(a.accounting_alias, b.sub_key||',')>0 
										) 
							},
							for(cpl:resultList):{
								accountingSubjectList = nsql-FaAccounting.selSubjectFromLedger:{	"从会计科目检查中选择会计科目-selecting accounting subject from ledger check"	},
								nsql-FaAccounting.updLedgerSubject:{}
							},
							ledgerCheckError = select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_ERROR' and sub_key='*';
							if(null==ledgerCheckError||1=ledgerCheckError){
								select * from app_drop_list where dict_org_id = '' and drop_list_type='ACCOUNTING_SUBJECT';
								for(){
									select parm_value from app_system_parameter where main_key='LEDGERC_CHECK_ERROR' and sub_key='#drop_list_type#';
								}
								nsql-FaAccounting.selLedgerFailureBySubject:{ "选择会计科目审核失败记录-selecting the record of checking failed by Accounting Subject"	
									select
											sys_no,trxn_date,acct_branch,ccy_code,ledger_bal_direction,
											ledger_acct_bal,gl_code,gl_bal_direction,gl_acct_bal,ledger_check_result 
									from
											Fab_ledger_check_result a 
									where
											a.trxn_date=#trxn_date# and a.org_id=#org_id# 
											and a.ledger_check_result='0' and exists(
													select
															b.parm_value
													from
															app_system_parameter b 
													where
															b.main_key='LEDGERC_CHECK_ERROR' 
															and b.parm_value='1' and instr(a.accounting_alias, b.sub_key||',')>0 
											) 
								}
							}
						}
					}
				}
			},
		},
		check1:{
			glt61:{	"Q日後z查"
				getBatchDataWalker:{},
				process:{
					"key code":{
						day check;
					}
				}
			}
		}
	}
	3-gl-time:{
		ap04-'批量同步远程目录文件':{
			getLocalHome():{
				select * from APP_SYSTEM_PARAMETER where MAIN_KEY='LOCAL_FILE_ROOT_DIR';
					'${HOME}/temp/${ltts.app.name}/'
			},
			getBatchDataWalker:{
					method-BizUtil.getTrxRunEnvs-'null',
					nsql-ApFile.selSyscBatchIdList-S-app_batch-select-'获取批量同步文件清单':{
						"E_FILEPROCTYPE.RECV_REQUEST"	"E_FILERECVWAY.APPOINT_DIURECTORY"
						select * from app_batch where file_proc_type = 'A' and file_recv_way = '2';
					}
			},
			process:{
					method-BizUtil.getTrxRunEnvs-'null',
					method-ApFile.syncRemoteFile2Local-'null':{
						table-app_batch-select-'文件批量业务定义',
						method-ApFile.getFullPath-'null':{},
						method-ApFile.getFullPath-'null':{},
						method-ApFile.getLocalHome-'null':{
							return method-BizUtil.convertParmString-'null',
							return method-ApSystemParm.getValue-'null':{
								table-app_system_parameter-select-'系统杂项参数'
							}
						},
						method-ApFile.exists-'null':{},
						method-ApFile.exists-'null':{},
						method-ApFile.createClient-'null':{
							table-app_root_directory-select-'file root directory define'
						},
						method-ApFile.createClient-'null':{
							table-app_root_directory-select-'file root directory define'
						},
						method-ApFile.createClient-'null':{
							table-app_root_directory-select-'file root directory define'
						},
						method-ApFile.getFileFullPath-'null':{},
						method-ApFile.exists-'null':{},
						table-apb_batch_receive-select-'文件接收薄',
						method-ApSeq.genSeq-'null':{},
						method-ApBatch.fileBatchApply-'null':{
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.fieldNotNull-'null',
							method-BizUtil.isDateString-'null':{
								method-BizUtil.toDate-'null'
							},
							method-BizUtil.getTrxRunEnvs-'null',
							table-app_batch-select-'文件批量业务定义',
							table-apb_batch_request-select-'文件批量请求薄',
							table-app_batch_channel-select-'文件批量业务渠道许可定义',
							method-ApFileRecv.register-'null':{
								method-ApSeq.genSeq-'null':{},
								method-ApFile.getFullPath-'null':{},
								method-ApFile.getFullPath-'null':{},
								method-BizUtil.getGroupHashValue-'null':{},
								table-apb_batch_receive-insert-'文件接收薄'
							},
							method-BizUtil.getGroupHashValue-'null':{},
							table-apb_batch_request-insert-'文件批量请求薄'
						}
					},
					method-DBUtil.rollBack-'null',
					method-DBUtil.beginTransation-'null'
			},
		},
	}
	template:{
			,
			glt5:{	""
				getBatchDataWalker:{
					nsql-ApBranch.selBranchList:{
						
					}
				},
				process:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
							},
						}
				}
			},
			glt5:{	""
				getBatchDataWalker:{},
				getJobBatchDataWalker:{},
				process:{
						"data flow":{	
							from 	
							insert 	
							update 	
						},
						"key code":{
							"1.":{
							},
						}
				}
			}
	},

}




